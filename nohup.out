[[36m2023-08-22 21:40:38,303[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Enforcing tags! <cfg.extras.enforce_tags=True>[0m
[[36m2023-08-22 21:40:38,307[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Printing config tree with Rich! <cfg.extras.print_config=True>[0m
[[36m2023-08-22 21:40:38,307[0m][[34msrc.utils.rich_utils[0m][[33mWARNING[0m] - Field 'callbacks' not found in config. Skipping 'callbacks' config printing...[0m
[[36m2023-08-22 21:40:38,307[0m][[34msrc.utils.rich_utils[0m][[33mWARNING[0m] - Field 'logger' not found in config. Skipping 'logger' config printing...[0m
CONFIG
├── data
│   └── _target_: src.data.pinn_datamodule.PINNDataModule
│
├── model
│   └── _target_: src.models.pinn_module.PINNModule
│       _partial_: true
│       loss_fn: mse
│       optimizer:
│         _target_: torch.optim.Adam
│         _partial_: true
│         lr: 0.001
│         weight_decay: 0.0
│         capturable: true
│
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer
│       default_root_dir: /home/reza/pinns-pytorch/examples/aneurysm3D/outputs/2
│       min_epochs: 1
│       max_epochs: 140
│       accelerator: gpu
│       devices:
│       - 0
│       check_val_every_n_epoch: 1
│       deterministic: false
│
├── paths
│   └── root_dir: /home/reza/pinns-pytorch
│       data_dir: /home/reza/pinns-pytorch/data/
│       rk_dir: /home/reza/pinns-pytorch/data/irk_weights
│       log_dir: /home/reza/pinns-pytorch/logs/
│       output_dir: /home/reza/pinns-pytorch/examples/aneurysm3D/outputs/21-40-3
│       work_dir: /home/reza/pinns-pytorch
│
├── extras
│   └── ignore_warnings: false
│       enforce_tags: true
│       print_config: true
│
├── task_name
│   └── aneurysm3D
├── tags
│   └── ['dev']
├── train
│   └── True
├── test
│   └── True
├── compile
│   └── False
├── ckpt_path
│   └── None
├── seed
│   └── None
├── net
│   └── _target_: src.models.net.neural_net.NetHFM
│       _partial_: true
│       layers:
│       - 4
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 5
│       output_names:
│       - c
│       - u
│       - v
│       - w
│       - p
│
├── batch_size
│   └── 70000
├── mesh
│   └── _target_: src.data.mesh.mesh.PointCloud
│       root_dir: /home/reza/pinns-pytorch/data/
│       read_data_fn: ???
│
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'src.data.sampler.mesh_sampler.MeshSample
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'src.data.sampler.mesh_sampler.MeshSample
├── test_dataset
│   └── [{'mesh_sampler': {'_target_': 'src.data.sampler.mesh_sampler.MeshSample
└── optimized_metric
    └── error:
        - c
        - u
        - v
        - w

[[36m2023-08-22 21:40:38,339[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating mesh <src.data.mesh.mesh.PointCloud>[0m
[[36m2023-08-22 21:40:38,341[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Data is available.[0m
[[36m2023-08-22 21:40:45,252[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating training dataset number 1: <src.data.sampler.mesh_sampler.MeshSampler>[0m
[[36m2023-08-22 21:40:46,367[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating validation dataset number 1: <src.data.sampler.mesh_sampler.MeshSampler>[0m
[[36m2023-08-22 21:40:48,703[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating validation dataset number 1: <src.data.sampler.mesh_sampler.MeshSampler>[0m
[[36m2023-08-22 21:40:48,716[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating datamodule <src.data.pinn_datamodule.PINNDataModule>[0m
[[36m2023-08-22 21:40:48,803[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating neural net <src.models.net.neural_net.NetHFM>[0m
[[36m2023-08-22 21:40:49,151[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating model <src.models.pinn_module.PINNModule>[0m
[[36m2023-08-22 21:40:49,156[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating callbacks...[0m
[[36m2023-08-22 21:40:49,157[0m][[34msrc.utils.instantiators[0m][[33mWARNING[0m] - No callback configs found! Skipping..[0m
[[36m2023-08-22 21:40:49,157[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating loggers...[0m
[[36m2023-08-22 21:40:49,157[0m][[34msrc.utils.instantiators[0m][[33mWARNING[0m] - No logger configs found! Skipping...[0m
[[36m2023-08-22 21:40:49,157[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating trainer <lightning.pytorch.trainer.Trainer>[0m
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[[36m2023-08-22 21:40:49,233[0m][[34m__main__[0m][[32mINFO[0m] - Starting training![0m
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]

  | Name          | Type       | Params
---------------------------------------------
0 | net           | NetHFM     | 569 K
1 | train_loss    | MeanMetric | 0
2 | val_loss      | MeanMetric | 0
3 | val_error     | MeanMetric | 0
4 | test_loss     | MeanMetric | 0
5 | test_error    | MeanMetric | 0
6 | val_loss_best | MinMetric  | 0
---------------------------------------------
569 K     Trainable params
0         Non-trainable params
569 K     Total params
2.279     Total estimated model params size (MB)
Sanity Checking: 0it [00:00, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:  50%|█████     | 1/2 [00:00<00:00, 12.01it/s]Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:00<00:00, 18.79it/s]                                                                           Training: 0it [00:00, ?it/s]Training:   0%|          | 0/424 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/424 [00:00<?, ?it/s] Epoch 0:   0%|          | 1/424 [00:05<40:27,  5.74s/it]Epoch 0:   0%|          | 1/424 [00:05<40:27,  5.74s/it]Epoch 0:   0%|          | 2/424 [00:07<25:30,  3.63s/it]Epoch 0:   0%|          | 2/424 [00:07<25:30,  3.63s/it]Epoch 0:   1%|          | 3/424 [00:08<20:30,  2.92s/it]Epoch 0:   1%|          | 3/424 [00:08<20:30,  2.92s/it]Epoch 0:   1%|          | 4/424 [00:10<18:00,  2.57s/it]Epoch 0:   1%|          | 4/424 [00:10<18:00,  2.57s/it]Epoch 0:   1%|          | 5/424 [00:11<16:29,  2.36s/it]Epoch 0:   1%|          | 5/424 [00:11<16:29,  2.36s/it]Epoch 0:   1%|▏         | 6/424 [00:13<15:27,  2.22s/it]Epoch 0:   1%|▏         | 6/424 [00:13<15:27,  2.22s/it]Epoch 0:   2%|▏         | 7/424 [00:14<14:43,  2.12s/it]Epoch 0:   2%|▏         | 7/424 [00:14<14:43,  2.12s/it]Epoch 0:   2%|▏         | 8/424 [00:16<14:10,  2.04s/it]Epoch 0:   2%|▏         | 8/424 [00:16<14:10,  2.04s/it]Epoch 0:   2%|▏         | 9/424 [00:17<13:44,  1.99s/it]Epoch 0:   2%|▏         | 9/424 [00:17<13:44,  1.99s/it]Epoch 0:   2%|▏         | 10/424 [00:19<13:22,  1.94s/it]Epoch 0:   2%|▏         | 10/424 [00:19<13:22,  1.94s/it]Epoch 0:   3%|▎         | 11/424 [00:20<13:05,  1.90s/it]Epoch 0:   3%|▎         | 11/424 [00:20<13:05,  1.90s/it]Epoch 0:   3%|▎         | 12/424 [00:22<12:50,  1.87s/it]Epoch 0:   3%|▎         | 12/424 [00:22<12:50,  1.87s/it]Epoch 0:   3%|▎         | 13/424 [00:23<12:37,  1.84s/it]Epoch 0:   3%|▎         | 13/424 [00:23<12:37,  1.84s/it]Epoch 0:   3%|▎         | 14/424 [00:25<12:26,  1.82s/it]Epoch 0:   3%|▎         | 14/424 [00:25<12:26,  1.82s/it]Epoch 0:   4%|▎         | 15/424 [00:27<12:16,  1.80s/it]Epoch 0:   4%|▎         | 15/424 [00:27<12:16,  1.80s/it]Epoch 0:   4%|▍         | 16/424 [00:28<12:07,  1.78s/it]Epoch 0:   4%|▍         | 16/424 [00:28<12:07,  1.78s/it]Epoch 0:   4%|▍         | 17/424 [00:30<11:59,  1.77s/it]Epoch 0:   4%|▍         | 17/424 [00:30<11:59,  1.77s/it]Epoch 0:   4%|▍         | 18/424 [00:31<11:52,  1.75s/it]Epoch 0:   4%|▍         | 18/424 [00:31<11:52,  1.75s/it]Epoch 0:   4%|▍         | 19/424 [00:33<11:45,  1.74s/it]Epoch 0:   4%|▍         | 19/424 [00:33<11:45,  1.74s/it]Epoch 0:   5%|▍         | 20/424 [00:34<11:39,  1.73s/it]Epoch 0:   5%|▍         | 20/424 [00:34<11:39,  1.73s/it]Epoch 0:   5%|▍         | 21/424 [00:36<11:34,  1.72s/it]Epoch 0:   5%|▍         | 21/424 [00:36<11:34,  1.72s/it]Epoch 0:   5%|▌         | 22/424 [00:37<11:29,  1.71s/it]Epoch 0:   5%|▌         | 22/424 [00:37<11:29,  1.71s/it]Epoch 0:   5%|▌         | 23/424 [00:39<11:24,  1.71s/it]Epoch 0:   5%|▌         | 23/424 [00:39<11:24,  1.71s/it]Epoch 0:   6%|▌         | 24/424 [00:40<11:19,  1.70s/it]Epoch 0:   6%|▌         | 24/424 [00:40<11:19,  1.70s/it]Epoch 0:   6%|▌         | 25/424 [00:42<11:15,  1.69s/it]Epoch 0:   6%|▌         | 25/424 [00:42<11:15,  1.69s/it]Epoch 0:   6%|▌         | 26/424 [00:43<11:11,  1.69s/it]Epoch 0:   6%|▌         | 26/424 [00:43<11:11,  1.69s/it]Epoch 0:   6%|▋         | 27/424 [00:45<11:07,  1.68s/it]Epoch 0:   6%|▋         | 27/424 [00:45<11:07,  1.68s/it]Epoch 0:   7%|▋         | 28/424 [00:46<11:04,  1.68s/it]Epoch 0:   7%|▋         | 28/424 [00:46<11:04,  1.68s/it][[36m2023-08-22 21:42:16,846[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Enforcing tags! <cfg.extras.enforce_tags=True>[0m
[[36m2023-08-22 21:42:16,850[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Printing config tree with Rich! <cfg.extras.print_config=True>[0m
CONFIG
├── data
│   └── _target_: src.data.pinn_datamodule.PINNDataModule
│
├── model
│   └── _target_: src.models.pinn_module.PINNModule
│       _partial_: true
│       loss_fn: mse
│       optimizer:
│         _target_: torch.optim.Adam
│         _partial_: true
│         lr: 0.001
│         weight_decay: 0.0
│         capturable: true
│
├── callbacks
│   └── model_checkpoint:
│         _target_: lightning.pytorch.callbacks.ModelCheckpoint
│         dirpath: /home/reza/pinns-pytorch/examples/aneurysm3D/outputs/21-42-16
│         filename: epoch_{epoch:03d}
│         monitor: val/loss
│         verbose: false
│         save_last: true
│         save_top_k: 1
│         mode: min
│         auto_insert_metric_name: false
│         save_weights_only: false
│         every_n_train_steps: null
│         train_time_interval: null
│         every_n_epochs: null
│         save_on_train_epoch_end: null
│       early_stopping:
│         _target_: lightning.pytorch.callbacks.EarlyStopping
│         monitor: val/loss
│         min_delta: 0.0
│         patience: 100
│         verbose: false
│         mode: min
│         strict: true
│         check_finite: true
│         stopping_threshold: null
│         divergence_threshold: null
│         check_on_train_epoch_end: null
│       model_summary:
│         _target_: lightning.pytorch.callbacks.RichModelSummary
│         max_depth: -1
│       rich_progress_bar:
│         _target_: lightning.pytorch.callbacks.RichProgressBar
│
├── logger
│   └── csv:
│         _target_: lightning.pytorch.loggers.csv_logs.CSVLogger
│         save_dir: /home/reza/pinns-pytorch/examples/aneurysm3D/outputs/21-42-1
│         name: csv/
│         prefix: ''
│
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer
│       default_root_dir: /home/reza/pinns-pytorch/examples/aneurysm3D/outputs/2
│       min_epochs: 1
│       max_epochs: 140
│       accelerator: gpu
│       devices:
│       - 0
│       check_val_every_n_epoch: 1
│       deterministic: false
│
├── paths
│   └── root_dir: /home/reza/pinns-pytorch
│       data_dir: /home/reza/pinns-pytorch/data/
│       rk_dir: /home/reza/pinns-pytorch/data/irk_weights
│       log_dir: /home/reza/pinns-pytorch/logs/
│       output_dir: /home/reza/pinns-pytorch/examples/aneurysm3D/outputs/21-42-1
│       work_dir: /home/reza/pinns-pytorch
│
├── extras
│   └── ignore_warnings: false
│       enforce_tags: true
│       print_config: true
│
├── task_name
│   └── aneurysm3D
├── tags
│   └── ['dev']
├── train
│   └── True
├── test
│   └── True
├── compile
│   └── False
├── ckpt_path
│   └── None
├── seed
│   └── None
├── net
│   └── _target_: src.models.net.neural_net.NetHFM
│       _partial_: true
│       layers:
│       - 4
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 5
│       output_names:
│       - c
│       - u
│       - v
│       - w
│       - p
│
├── batch_size
│   └── 70000
├── mesh
│   └── _target_: src.data.mesh.mesh.PointCloud
│       root_dir: /home/reza/pinns-pytorch/data/
│       read_data_fn: ???
│
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'src.data.sampler.mesh_sampler.MeshSample
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'src.data.sampler.mesh_sampler.MeshSample
├── test_dataset
│   └── [{'mesh_sampler': {'_target_': 'src.data.sampler.mesh_sampler.MeshSample
└── optimized_metric
    └── error:
        - c
        - u
        - v
        - w

[[36m2023-08-22 21:42:16,891[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating mesh <src.data.mesh.mesh.PointCloud>[0m
[[36m2023-08-22 21:42:16,893[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Data is available.[0m
[[36m2023-08-22 21:42:23,803[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating training dataset number 1: <src.data.sampler.mesh_sampler.MeshSampler>[0m
[[36m2023-08-22 21:42:24,914[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating validation dataset number 1: <src.data.sampler.mesh_sampler.MeshSampler>[0m
[[36m2023-08-22 21:42:27,239[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating validation dataset number 1: <src.data.sampler.mesh_sampler.MeshSampler>[0m
[[36m2023-08-22 21:42:27,252[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating datamodule <src.data.pinn_datamodule.PINNDataModule>[0m
[[36m2023-08-22 21:42:27,340[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating neural net <src.models.net.neural_net.NetHFM>[0m
[[36m2023-08-22 21:42:27,687[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating model <src.models.pinn_module.PINNModule>[0m
[[36m2023-08-22 21:42:27,691[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating callbacks...[0m
[[36m2023-08-22 21:42:27,691[0m][[34msrc.utils.instantiators[0m][[32mINFO[0m] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>[0m
[[36m2023-08-22 21:42:27,694[0m][[34msrc.utils.instantiators[0m][[32mINFO[0m] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>[0m
[[36m2023-08-22 21:42:27,695[0m][[34msrc.utils.instantiators[0m][[32mINFO[0m] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>[0m
[[36m2023-08-22 21:42:27,695[0m][[34msrc.utils.instantiators[0m][[32mINFO[0m] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>[0m
[[36m2023-08-22 21:42:27,696[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating loggers...[0m
[[36m2023-08-22 21:42:27,696[0m][[34msrc.utils.instantiators[0m][[32mINFO[0m] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>[0m
[[36m2023-08-22 21:42:27,698[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating trainer <lightning.pytorch.trainer.Trainer>[0m
Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[[36m2023-08-22 21:42:27,771[0m][[34m__main__[0m][[32mINFO[0m] - Logging hyperparameters![0m
[[36m2023-08-22 21:42:27,772[0m][[34m__main__[0m][[32mINFO[0m] - Starting training![0m
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
┏━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃    ┃ Name          ┃ Type          ┃ Params ┃
┡━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━┩
│ 0  │ net           │ NetHFM        │  569 K │
│ 1  │ net.sigmoid   │ Sigmoid       │      0 │
│ 2  │ net.weights   │ ParameterList │  564 K │
│ 3  │ net.biases    │ ParameterList │  2.5 K │
│ 4  │ net.gammas    │ ParameterList │  2.5 K │
│ 5  │ train_loss    │ MeanMetric    │      0 │
│ 6  │ val_loss      │ MeanMetric    │      0 │
│ 7  │ val_error     │ MeanMetric    │      0 │
│ 8  │ test_loss     │ MeanMetric    │      0 │
│ 9  │ test_error    │ MeanMetric    │      0 │
│ 10 │ val_loss_best │ MinMetric     │      0 │
└────┴───────────────┴───────────────┴────────┘
Trainable params: 569 K
Non-trainable params: 0
Total params: 569 K
Total estimated model params size (MB): 2
[[36m2023-08-22 21:52:16,176[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Enforcing tags! <cfg.extras.enforce_tags=True>[0m
[[36m2023-08-22 21:52:16,179[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Printing config tree with Rich! <cfg.extras.print_config=True>[0m
CONFIG
├── data
│   └── _target_: src.data.pinn_datamodule.PINNDataModule
│
├── model
│   └── _target_: src.models.pinn_module.PINNModule
│       _partial_: true
│       loss_fn: mse
│       optimizer:
│         _target_: torch.optim.Adam
│         _partial_: true
│         lr: 0.001
│         weight_decay: 0.0
│         capturable: true
│
├── callbacks
│   └── model_checkpoint:
│         _target_: lightning.pytorch.callbacks.ModelCheckpoint
│         dirpath: /home/reza/pinns-pytorch/examples/aneurysm3D/outputs/21-52-16
│         filename: epoch_{epoch:03d}
│         monitor: val/loss
│         verbose: false
│         save_last: true
│         save_top_k: 1
│         mode: min
│         auto_insert_metric_name: false
│         save_weights_only: false
│         every_n_train_steps: null
│         train_time_interval: null
│         every_n_epochs: null
│         save_on_train_epoch_end: null
│       early_stopping:
│         _target_: lightning.pytorch.callbacks.EarlyStopping
│         monitor: val/loss
│         min_delta: 0.0
│         patience: 100
│         verbose: false
│         mode: min
│         strict: true
│         check_finite: true
│         stopping_threshold: null
│         divergence_threshold: null
│         check_on_train_epoch_end: null
│       model_summary:
│         _target_: lightning.pytorch.callbacks.RichModelSummary
│         max_depth: -1
│       rich_progress_bar:
│         _target_: lightning.pytorch.callbacks.RichProgressBar
│
├── logger
│   └── csv:
│         _target_: lightning.pytorch.loggers.csv_logs.CSVLogger
│         save_dir: /home/reza/pinns-pytorch/examples/aneurysm3D/outputs/21-52-1
│         name: csv/
│         prefix: ''
│
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer
│       default_root_dir: /home/reza/pinns-pytorch/examples/aneurysm3D/outputs/2
│       min_epochs: 1
│       max_epochs: 140
│       accelerator: gpu
│       devices:
│       - 0
│       check_val_every_n_epoch: 1
│       deterministic: false
│
├── paths
│   └── root_dir: /home/reza/pinns-pytorch
│       data_dir: /home/reza/pinns-pytorch/data/
│       rk_dir: /home/reza/pinns-pytorch/data/irk_weights
│       log_dir: /home/reza/pinns-pytorch/logs/
│       output_dir: /home/reza/pinns-pytorch/examples/aneurysm3D/outputs/21-52-1
│       work_dir: /home/reza/pinns-pytorch
│
├── extras
│   └── ignore_warnings: false
│       enforce_tags: true
│       print_config: true
│
├── task_name
│   └── aneurysm3D
├── tags
│   └── ['dev']
├── train
│   └── True
├── test
│   └── True
├── compile
│   └── False
├── ckpt_path
│   └── None
├── seed
│   └── None
├── net
│   └── _target_: src.models.net.neural_net.NetHFM
│       _partial_: true
│       layers:
│       - 4
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 5
│       output_names:
│       - c
│       - u
│       - v
│       - w
│       - p
│
├── batch_size
│   └── 70000
├── mesh
│   └── _target_: src.data.mesh.mesh.PointCloud
│       root_dir: /home/reza/pinns-pytorch/data/
│       read_data_fn: ???
│
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'src.data.sampler.mesh_sampler.MeshSample
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'src.data.sampler.mesh_sampler.MeshSample
├── test_dataset
│   └── [{'mesh_sampler': {'_target_': 'src.data.sampler.mesh_sampler.MeshSample
└── optimized_metric
    └── error:
        - c
        - u
        - v
        - w

[[36m2023-08-22 21:52:16,221[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating mesh <src.data.mesh.mesh.PointCloud>[0m
[[36m2023-08-22 21:52:16,223[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Data is available.[0m
[[36m2023-08-22 21:52:23,126[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating training dataset number 1: <src.data.sampler.mesh_sampler.MeshSampler>[0m
[[36m2023-08-22 21:52:24,228[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating validation dataset number 1: <src.data.sampler.mesh_sampler.MeshSampler>[0m
[[36m2023-08-22 21:52:26,536[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating validation dataset number 1: <src.data.sampler.mesh_sampler.MeshSampler>[0m
[[36m2023-08-22 21:52:26,550[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating datamodule <src.data.pinn_datamodule.PINNDataModule>[0m
[[36m2023-08-22 21:52:26,637[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating neural net <src.models.net.neural_net.NetHFM>[0m
[[36m2023-08-22 21:52:26,984[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating model <src.models.pinn_module.PINNModule>[0m
[[36m2023-08-22 21:52:26,990[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating callbacks...[0m
[[36m2023-08-22 21:52:26,990[0m][[34msrc.utils.instantiators[0m][[32mINFO[0m] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>[0m
[[36m2023-08-22 21:52:26,993[0m][[34msrc.utils.instantiators[0m][[32mINFO[0m] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>[0m
[[36m2023-08-22 21:52:26,994[0m][[34msrc.utils.instantiators[0m][[32mINFO[0m] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>[0m
[[36m2023-08-22 21:52:26,994[0m][[34msrc.utils.instantiators[0m][[32mINFO[0m] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>[0m
[[36m2023-08-22 21:52:26,995[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating loggers...[0m
[[36m2023-08-22 21:52:26,995[0m][[34msrc.utils.instantiators[0m][[32mINFO[0m] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>[0m
[[36m2023-08-22 21:52:26,996[0m][[34m__main__[0m][[32mINFO[0m] - Instantiating trainer <lightning.pytorch.trainer.Trainer>[0m
Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[[36m2023-08-22 21:52:27,075[0m][[34m__main__[0m][[32mINFO[0m] - Logging hyperparameters![0m
[[36m2023-08-22 21:52:27,077[0m][[34m__main__[0m][[32mINFO[0m] - Starting training![0m
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
┏━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃    ┃ Name          ┃ Type          ┃ Params ┃
┡━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━┩
│ 0  │ net           │ NetHFM        │  569 K │
│ 1  │ net.sigmoid   │ Sigmoid       │      0 │
│ 2  │ net.weights   │ ParameterList │  564 K │
│ 3  │ net.biases    │ ParameterList │  2.5 K │
│ 4  │ net.gammas    │ ParameterList │  2.5 K │
│ 5  │ train_loss    │ MeanMetric    │      0 │
│ 6  │ val_loss      │ MeanMetric    │      0 │
│ 7  │ val_error     │ MeanMetric    │      0 │
│ 8  │ test_loss     │ MeanMetric    │      0 │
│ 9  │ test_error    │ MeanMetric    │      0 │
│ 10 │ val_loss_best │ MinMetric     │      0 │
└────┴───────────────┴───────────────┴────────┘
Trainable params: 569 K
Non-trainable params: 0
Total params: 569 K
Total estimated model params size (MB): 2
`Trainer.fit` stopped: `max_epochs=140` reached.
Epoch 139/139 ━━━━━━━━━━━━━━━ 424/424 0:11:03 •       0.64it/s v_num: 0
                                      0:00:00                  val/loss: 712.933
                                                               val/error_c:
                                                               0.053
                                                               val/error_u:
                                                               0.563
                                                               val/error_v: 0.53
                                                               val/error_w: 0.56
                                                               val/error_p:
                                                               0.999
                                                               val/loss_best:
                                                               712.931
                                                               train/loss: 0.0
[[36m2023-08-23 23:58:10,281[0m][[34m__main__[0m][[32mINFO[0m] - Starting testing![0m
[[36m2023-08-23 23:58:10,281[0m][[34m__main__[0m][[33mWARNING[0m] - Best ckpt not found! Using current weights for testing...[0m
Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│       test/error_c        │    0.05375567451119423    │
│       test/error_p        │    0.9993963241577148     │
│       test/error_u        │    0.5306307077407837     │
│       test/error_v        │    0.5444300770759583     │
│       test/error_w        │    0.5530816316604614     │
│         test/loss         │      768.33447265625      │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2/2 0:00:00 • 0:00:00 87.94it/s
[[36m2023-08-23 23:58:10,368[0m][[34m__main__[0m][[32mINFO[0m] - Best ckpt path: None[0m
[[36m2023-08-23 23:58:10,369[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Output dir: /home/reza/pinns-pytorch/examples/aneurysm3D/outputs/21-52-16[0m
[[36m2023-08-23 23:58:10,369[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Retrieved metric value! <val/error_c=0.052602510899305344>[0m
[[36m2023-08-23 23:58:10,369[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Retrieved metric value! <val/error_u=0.5627376437187195>[0m
[[36m2023-08-23 23:58:10,369[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Retrieved metric value! <val/error_v=0.5300697088241577>[0m
[[36m2023-08-23 23:58:10,369[0m][[34msrc.utils.utils[0m][[32mINFO[0m] - Retrieved metric value! <val/error_w=0.5598423480987549>[0m
[2023-08-25 04:27:46,827][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-08-25 04:27:46,830][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule
│
├── model
│   └── _target_: pinnstorch.models.PINNModule
│       _partial_: true
│       loss_fn: mse
│       automatic_optimization: false
│       optimizer:
│         _target_: torch.optim.Adam
│         _partial_: true
│         lr: 0.001
│         weight_decay: 0.0
│         capturable: true
│
├── callbacks
│   └── model_checkpoint:
│         _target_: lightning.pytorch.callbacks.ModelCheckpoint
│         dirpath: /home/reza/tmp/pinns-torch/examples/aneurysm3D/outputs/04-27-
│         filename: epoch_{epoch:03d}_{val/loss}
│         monitor: val/loss
│         verbose: null
│         save_last: true
│         save_top_k: 1
│         mode: min
│         auto_insert_metric_name: false
│         save_weights_only: false
│         every_n_train_steps: null
│         train_time_interval: null
│         every_n_epochs: null
│         save_on_train_epoch_end: null
│       model_summary:
│         _target_: lightning.pytorch.callbacks.RichModelSummary
│         max_depth: -1
│       rich_progress_bar:
│         _target_: lightning.pytorch.callbacks.RichProgressBar
│
├── logger
│   └── csv:
│         _target_: lightning.pytorch.loggers.csv_logs.CSVLogger
│         save_dir: /home/reza/tmp/pinns-torch/examples/aneurysm3D/outputs/04-27
│         name: csv/
│         prefix: ''
│
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/aneurysm3D/outputs
│       min_epochs: 1
│       max_epochs: 200
│       accelerator: gpu
│       devices:
│       - 0
│       check_val_every_n_epoch: 1
│       inference_mode: false
│       log_every_n_steps: 1
│       deterministic: false
│
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch
│       data_dir: /home/reza/tmp/pinns-torch/data/
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights
│       log_dir: /home/reza/tmp/pinns-torch/logs/
│       output_dir: /home/reza/tmp/pinns-torch/examples/aneurysm3D/outputs/04-27
│       work_dir: /home/reza/tmp/pinns-torch
│
├── extras
│   └── ignore_warnings: false
│       enforce_tags: true
│       print_config: true
│
├── task_name
│   └── aneurysm3D
├── tags
│   └── ['dev']
├── train
│   └── True
├── test
│   └── True
├── compile
│   └── True
├── ckpt_path
│   └── None
├── seed
│   └── None
├── net
│   └── _target_: pinnstorch.models.NetHFM
│       _partial_: true
│       layers:
│       - 4
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 250
│       - 5
│       output_names:
│       - c
│       - u
│       - v
│       - w
│       - p
│
├── batch_size
│   └── 70000
├── mesh
│   └── _target_: pinnstorch.data.PointCloud
│       root_dir: /home/reza/tmp/pinns-torch/data/
│       read_data_fn: ???
│
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── test_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
└── optimized_metric
    └── error:
        - c
        - u
        - v
        - w

[2023-08-25 04:27:46,871][pinnstorch.train][INFO] - Model will be compiled. Setting optimizer capturable attribute to True.
[2023-08-25 04:27:46,871][pinnstorch.train][INFO] - Model will be compiled. Disabling automatic optimization.
[2023-08-25 04:27:46,872][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.PointCloud>
[2023-08-25 04:27:46,876][pinnstorch.utils.utils][INFO] - Data is available.
[2023-08-25 04:27:53,932][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-08-25 04:27:55,054][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.MeshSampler>
[2023-08-25 04:27:55,955][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-08-25 04:27:58,294][pinnstorch.train][INFO] - Instantiating test dataset number 1: <pinnstorch.data.MeshSampler>
[2023-08-25 04:27:58,303][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-08-25 04:27:58,399][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.NetHFM>
[2023-08-25 04:28:00,065][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-08-25 04:28:00,068][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-08-25 04:28:00,068][pinnstorch.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2023-08-25 04:28:00,070][pinnstorch.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2023-08-25 04:28:00,071][pinnstorch.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2023-08-25 04:28:00,071][pinnstorch.train][INFO] - Instantiating loggers...
[2023-08-25 04:28:00,071][pinnstorch.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2023-08-25 04:28:00,073][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-08-25 04:28:00,151][pinnstorch.train][INFO] - Logging hyperparameters!
[2023-08-25 04:28:00,153][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
┏━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃    ┃ Name          ┃ Type          ┃ Params ┃
┡━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━┩
│ 0  │ net           │ NetHFM        │  569 K │
│ 1  │ net.weights   │ ParameterList │  564 K │
│ 2  │ net.biases    │ ParameterList │  2.5 K │
│ 3  │ net.gammas    │ ParameterList │  2.5 K │
│ 4  │ net.sigmoid   │ Sigmoid       │      0 │
│ 5  │ train_loss    │ MeanMetric    │      0 │
│ 6  │ val_loss      │ MeanMetric    │      0 │
│ 7  │ val_error     │ MeanMetric    │      0 │
│ 8  │ test_loss     │ MeanMetric    │      0 │
│ 9  │ test_error    │ MeanMetric    │      0 │
│ 10 │ val_loss_best │ MinMetric     │      0 │
└────┴───────────────┴───────────────┴────────┘
Trainable params: 569 K
Non-trainable params: 0
Total params: 569 K
Total estimated model params size (MB): 2
`Trainer.fit` stopped: `max_epochs=200` reached.
Epoch 199/199 ━━━━━━━━━━━━━━━ 424/424 0:11:13 •       0.63it/s v_num: 0         
                                      0:00:00                  val/loss: 713.956
                                                               val/error_c:     
                                                               0.052            
                                                               val/error_u:     
                                                               0.645            
                                                               val/error_v:     
                                                               0.593            
                                                               val/error_w:     
                                                               0.617            
                                                               val/error_p: 1.0 
                                                               val/loss_best:   
                                                               713.895          
                                                               train/loss: 0.0  
[2023-08-26 18:27:13,495][pinnstorch.train][INFO] - Starting testing!
Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃        Test metric        ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│       test/error_c        │    0.0548088476061821     │
│       test/error_p        │    1.0001434087753296     │
│       test/error_u        │    0.6229104995727539     │
│       test/error_v        │    0.6098403930664062     │
│       test/error_w        │    0.6138156652450562     │
│         test/loss         │     769.515869140625      │
└───────────────────────────┴───────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2/2 0:00:00 • 0:00:00 85.91it/s 
[2023-08-26 18:27:13,633][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/aneurysm3D/outputs/04-27-46
[2023-08-26 18:27:13,633][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_c=0.05170849710702896>
[2023-08-26 18:27:13,633][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.6451303362846375>
[2023-08-26 18:27:13,633][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_v=0.5932996273040771>
[2023-08-26 18:27:13,633][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_w=0.6168579459190369>
[2023-09-06 04:47:31,538][HYDRA] Launching 4 jobs locally
[2023-09-06 04:47:31,538][HYDRA] 	#0 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=False
[2023-09-06 04:47:31,684][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-06 04:47:31,688][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: 0.0                                                               
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outp
│       min_epochs: 1                                                           
│       max_epochs: 250000                                                      
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 250001                                         
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/mu
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── navier_stokes                                                           
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 3                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 2                                                                     
│       output_names:                                                           
│       - psi                                                                   
│       - p                                                                     
│                                                                               
├── n_train
│   └── 5000                                                                    
├── mesh
│   └── _target_: pinnstorch.data.PointCloud                                    
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── pred_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       - v                                                                     
│       - p                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_navier_stokes                           
        _partial_: true                                                         
                                                                                
[2023-09-06 04:47:31,731][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-06 04:47:31,731][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-06 04:47:31,731][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-06 04:47:31,733][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.PointCloud>
[2023-09-06 04:47:31,734][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-06 04:47:31,805][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 04:47:31,908][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 04:47:31,940][pinnstorch.train][INFO] - Instantiating prediction dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 04:47:31,942][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-06 04:47:31,973][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-06 04:47:31,978][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-06 04:47:32,014][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-06 04:47:32,014][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-06 04:47:32,014][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-06 04:47:32,015][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-06 04:47:32,015][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-06 04:47:32,073][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:378: UserWarning: You have overridden `transfer_batch_to_device` in `LightningModule` but have passed in a `LightningDataModule`. It will use the implementation from `LightningModule` instance.
  warning_cache.warn(
=======
[2023-09-06 04:47:32,604][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-06 04:47:32,604][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.09387969970703125
[2023-09-06 04:47:33,131][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.5951170921325684, - MEAN = 0.05410155383023349
[2023-09-06 04:47:37,117][pinnstorch.models.pinn_module][INFO] - step 81: 0.06340646743774414
[2023-09-06 04:47:56,565][HYDRA] Launching 4 jobs locally
[2023-09-06 04:47:56,565][HYDRA] 	#0 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=False
[2023-09-06 04:47:56,713][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-06 04:47:56,717][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/schrodinger/output
│       min_epochs: 1                                                           
│       max_epochs: 60000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 60001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/schrodinger/outputs/mult
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── schrodinger                                                             
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 100                                                                   
│       - 100                                                                   
│       - 100                                                                   
│       - 100                                                                   
│       - 2                                                                     
│       output_names:                                                           
│       - u                                                                     
│       - v                                                                     
│                                                                               
├── N0
│   └── 50                                                                      
├── N_b
│   └── 50                                                                      
├── N_f
│   └── 20000                                                                   
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 1.57079633                                                            
│       t_points: 201                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -5                                                                    
│       - 4.9609375                                                             
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│       ub:                                                                     
│       - 5.0                                                                   
│       - 1.57079633                                                            
│       lb:                                                                     
│       - -5.0                                                                  
│       - 0.0                                                                   
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       - v                                                                     
│       - h                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_schrodinger                             
        _partial_: true                                                         
                                                                                
[2023-09-06 04:47:56,759][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-06 04:47:56,759][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-06 04:47:56,759][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-06 04:47:56,760][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-06 04:47:56,761][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-06 04:47:56,762][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-06 04:47:56,765][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-06 04:47:56,770][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 04:47:56,778][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.InitialCondition>
[2023-09-06 04:47:56,780][pinnstorch.train][INFO] - Instantiating training dataset number 3: <pinnstorch.data.PeriodicBoundaryCondition>
[2023-09-06 04:47:56,781][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 04:47:56,783][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-06 04:47:56,816][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-06 04:47:56,825][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-06 04:47:56,857][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-06 04:47:56,858][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-06 04:47:56,858][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-06 04:47:56,858][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-06 04:47:56,858][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-06 04:47:56,910][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:378: UserWarning: You have overridden `transfer_batch_to_device` in `LightningModule` but have passed in a `LightningDataModule`. It will use the implementation from `LightningModule` instance.
  warning_cache.warn(
=======
[2023-09-06 04:47:57,418][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-06 04:47:57,419][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.10550761222839355
[2023-09-06 04:47:57,697][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.32637810707092285, - MEAN = 0.029670737006447533
[2023-09-06 04:47:59,701][pinnstorch.models.pinn_module][INFO] - step 81: 0.021056652069091797
`Trainer.fit` stopped: `max_epochs=60000` reached.
[2023-09-06 05:16:12,504][pinnstorch.train][INFO] - Elapsed time: 1695.593942642212
[2023-09-06 05:16:12,507][pinnstorch.train][INFO] - MEAN time: 0.025513648986816406  -   0.02641761302947998 -  0.024771571159362793
====================
[2023-09-06 05:16:12,508][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_h        │   0.024307938292622566    │
│        val/error_u        │    0.06434101611375809    │
│        val/error_v        │    0.10209029167890549    │
│         val/loss          │   0.005686156917363405    │
│       val/loss_best       │   0.005686156917363405    │
└───────────────────────────┴───────────────────────────┘
[2023-09-06 05:16:12,532][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[2023-09-06 05:16:12,823][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/schrodinger/outputs/multi_run/04-47-56/0/fig
[2023-09-06 05:16:13,839][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/schrodinger/outputs/multi_run/04-47-56/0
[2023-09-06 05:16:13,840][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.06434101611375809>
[2023-09-06 05:16:13,840][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_v=0.10209029167890549>
[2023-09-06 05:16:13,840][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_h=0.024307938292622566>
[2023-09-06 05:16:13,841][HYDRA] 	#1 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=True
[2023-09-06 05:16:13,998][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-06 05:16:14,000][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/schrodinger/output
│       min_epochs: 1                                                           
│       max_epochs: 60000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 60001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/schrodinger/outputs/mult
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── schrodinger                                                             
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 100                                                                   
│       - 100                                                                   
│       - 100                                                                   
│       - 100                                                                   
│       - 2                                                                     
│       output_names:                                                           
│       - u                                                                     
│       - v                                                                     
│                                                                               
├── N0
│   └── 50                                                                      
├── N_b
│   └── 50                                                                      
├── N_f
│   └── 20000                                                                   
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 1.57079633                                                            
│       t_points: 201                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -5                                                                    
│       - 4.9609375                                                             
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│       ub:                                                                     
│       - 5.0                                                                   
│       - 1.57079633                                                            
│       lb:                                                                     
│       - -5.0                                                                  
│       - 0.0                                                                   
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       - v                                                                     
│       - h                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_schrodinger                             
        _partial_: true                                                         
                                                                                
[2023-09-06 05:16:14,040][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-06 05:16:14,040][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-06 05:16:14,040][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-06 05:16:14,040][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-06 05:16:14,041][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-06 05:16:14,042][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-06 05:16:14,045][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-06 05:16:14,050][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 05:16:14,057][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.InitialCondition>
[2023-09-06 05:16:14,058][pinnstorch.train][INFO] - Instantiating training dataset number 3: <pinnstorch.data.PeriodicBoundaryCondition>
[2023-09-06 05:16:14,060][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 05:16:14,062][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-06 05:16:14,065][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-06 05:16:14,067][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-06 05:16:14,070][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-06 05:16:14,070][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-06 05:16:14,070][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-06 05:16:14,070][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-06 05:16:14,070][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-06 05:16:14,079][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Capture Time 0.405287504196167
=======
[2023-09-06 05:16:14,503][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-06 05:16:14,504][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.408888578414917
[2023-09-06 05:16:14,673][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.5715312957763672, - MEAN = 0.05195739052512429
`Trainer.fit` stopped: `max_epochs=60000` reached.
[2023-09-06 05:33:33,903][pinnstorch.train][INFO] - Elapsed time: 1039.823881149292
[2023-09-06 05:33:33,906][pinnstorch.train][INFO] - MEAN time: 0.016646862030029297  -   0.016696810722351074 -  0.01681685447692871
====================
[2023-09-06 05:33:33,906][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_h        │   0.022404955700039864    │
│        val/error_u        │     0.062868632376194     │
│        val/error_v        │    0.11047865450382233    │
│         val/loss          │   0.006061733700335026    │
│       val/loss_best       │   0.006061733700335026    │
└───────────────────────────┴───────────────────────────┘
[2023-09-06 05:33:33,928][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[2023-09-06 05:33:34,052][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/schrodinger/outputs/multi_run/04-47-56/1/fig
[2023-09-06 05:33:34,971][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/schrodinger/outputs/multi_run/04-47-56/1
[2023-09-06 05:33:34,971][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.062868632376194>
[2023-09-06 05:33:34,971][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_v=0.11047865450382233>
[2023-09-06 05:33:34,971][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_h=0.022404955700039864>
[2023-09-06 05:33:34,972][HYDRA] 	#2 : trainer.devices=[0] callbacks=null logger=null model.amp=True model.cudagraph_compile=False
[2023-09-06 05:33:35,136][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-06 05:33:35,137][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/schrodinger/output
│       min_epochs: 1                                                           
│       max_epochs: 60000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 60001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/schrodinger/outputs/mult
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── schrodinger                                                             
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 100                                                                   
│       - 100                                                                   
│       - 100                                                                   
│       - 100                                                                   
│       - 2                                                                     
│       output_names:                                                           
│       - u                                                                     
│       - v                                                                     
│                                                                               
├── N0
│   └── 50                                                                      
├── N_b
│   └── 50                                                                      
├── N_f
│   └── 20000                                                                   
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 1.57079633                                                            
│       t_points: 201                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -5                                                                    
│       - 4.9609375                                                             
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│       ub:                                                                     
│       - 5.0                                                                   
│       - 1.57079633                                                            
│       lb:                                                                     
│       - -5.0                                                                  
│       - 0.0                                                                   
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       - v                                                                     
│       - h                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_schrodinger                             
        _partial_: true                                                         
                                                                                
[2023-09-06 05:33:35,181][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-06 05:33:35,181][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-06 05:33:35,181][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-06 05:33:35,181][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-06 05:33:35,182][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-06 05:33:35,183][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-06 05:33:35,186][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-06 05:33:35,191][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 05:33:35,198][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.InitialCondition>
[2023-09-06 05:33:35,199][pinnstorch.train][INFO] - Instantiating training dataset number 3: <pinnstorch.data.PeriodicBoundaryCondition>
[2023-09-06 05:33:35,201][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 05:33:35,203][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-06 05:33:35,207][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-06 05:33:35,210][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-06 05:33:35,213][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-06 05:33:35,213][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-06 05:33:35,213][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-06 05:33:35,213][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-06 05:33:35,213][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-06 05:33:35,223][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
=======
[2023-09-06 05:33:35,304][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-06 05:33:35,304][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-06 05:33:35,304][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.042222023010253906
[2023-09-06 05:33:35,472][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.1990969181060791, - MEAN = 0.018099719827825374
[2023-09-06 05:33:37,587][pinnstorch.models.pinn_module][INFO] - step 81: 0.030948400497436523
`Trainer.fit` stopped: `max_epochs=60000` reached.
[2023-09-06 06:03:25,565][pinnstorch.train][INFO] - Elapsed time: 1790.3413968086243
[2023-09-06 06:03:25,569][pinnstorch.train][INFO] - MEAN time: 0.0225527286529541  -   0.028734803199768066 -  0.028871893882751465
====================
[2023-09-06 06:03:25,569][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_h        │   0.022001154720783234    │
│        val/error_u        │    0.06061981990933418    │
│        val/error_v        │    0.09665217995643616    │
│         val/loss          │   0.0050423163920640945   │
│       val/loss_best       │   0.0050423163920640945   │
└───────────────────────────┴───────────────────────────┘
[2023-09-06 06:03:25,589][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[2023-09-06 06:03:25,691][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/schrodinger/outputs/multi_run/04-47-56/2/fig
[2023-09-06 06:03:26,584][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/schrodinger/outputs/multi_run/04-47-56/2
[2023-09-06 06:03:26,585][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.06061981990933418>
[2023-09-06 06:03:26,585][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_v=0.09665217995643616>
[2023-09-06 06:03:26,585][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_h=0.022001154720783234>
[2023-09-06 06:03:26,586][HYDRA] 	#3 : trainer.devices=[0] callbacks=null logger=null model.amp=True model.cudagraph_compile=True
[2023-09-06 06:03:26,744][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-06 06:03:26,746][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/schrodinger/output
│       min_epochs: 1                                                           
│       max_epochs: 60000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 60001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/schrodinger/outputs/mult
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── schrodinger                                                             
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 100                                                                   
│       - 100                                                                   
│       - 100                                                                   
│       - 100                                                                   
│       - 2                                                                     
│       output_names:                                                           
│       - u                                                                     
│       - v                                                                     
│                                                                               
├── N0
│   └── 50                                                                      
├── N_b
│   └── 50                                                                      
├── N_f
│   └── 20000                                                                   
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 1.57079633                                                            
│       t_points: 201                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -5                                                                    
│       - 4.9609375                                                             
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│       ub:                                                                     
│       - 5.0                                                                   
│       - 1.57079633                                                            
│       lb:                                                                     
│       - -5.0                                                                  
│       - 0.0                                                                   
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       - v                                                                     
│       - h                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_schrodinger                             
        _partial_: true                                                         
                                                                                
[2023-09-06 06:03:26,786][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-06 06:03:26,786][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-06 06:03:26,786][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-06 06:03:26,786][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-06 06:03:26,787][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-06 06:03:26,788][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-06 06:03:26,791][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-06 06:03:26,796][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 06:03:26,803][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.InitialCondition>
[2023-09-06 06:03:26,805][pinnstorch.train][INFO] - Instantiating training dataset number 3: <pinnstorch.data.PeriodicBoundaryCondition>
[2023-09-06 06:03:26,806][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 06:03:26,809][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-06 06:03:26,811][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-06 06:03:26,814][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-06 06:03:26,816][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-06 06:03:26,816][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-06 06:03:26,816][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-06 06:03:26,816][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-06 06:03:26,816][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-06 06:03:26,825][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Capture Time 0.47472262382507324
=======
[2023-09-06 06:03:27,316][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-06 06:03:27,317][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-06 06:03:27,317][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.4774308204650879
[2023-09-06 06:03:27,424][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.5780990123748779, - MEAN = 0.05255445567044345
[2023-09-06 06:03:28,027][pinnstorch.models.pinn_module][INFO] - step 81: 0.009538412094116211
`Trainer.fit` stopped: `max_epochs=60000` reached.
[2023-09-06 06:13:40,071][pinnstorch.train][INFO] - Elapsed time: 613.246170759201
[2023-09-06 06:13:40,074][pinnstorch.train][INFO] - MEAN time: 0.00970602035522461  -   0.009710907936096191 -  0.00970458984375
====================
[2023-09-06 06:13:40,075][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_h        │    0.12408894300460815    │
│        val/error_u        │    0.5007586479187012     │
│        val/error_v        │    0.7348191142082214     │
│         val/loss          │    0.3004576861858368     │
│       val/loss_best       │    0.3004576861858368     │
└───────────────────────────┴───────────────────────────┘
[2023-09-06 06:13:40,096][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[2023-09-06 06:13:40,198][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/schrodinger/outputs/multi_run/04-47-56/3/fig
[2023-09-06 06:13:41,092][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/schrodinger/outputs/multi_run/04-47-56/3
[2023-09-06 06:13:41,093][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.5007586479187012>
[2023-09-06 06:13:41,093][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_v=0.7348191142082214>
[2023-09-06 06:13:41,093][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_h=0.12408894300460815>
`Trainer.fit` stopped: `max_epochs=250000` reached.
[2023-09-06 08:40:43,533][pinnstorch.train][INFO] - Elapsed time: 13991.459825277328
[2023-09-06 08:40:43,545][pinnstorch.train][INFO] - MEAN time: 0.04341840744018555  -   0.04943990707397461 -  0.04922044277191162
====================
[2023-09-06 08:40:43,545][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_p        │     5.639854431152344     │
│        val/error_u        │    0.2048647552728653     │
│        val/error_v        │    0.9985900521278381     │
│         val/loss          │        659864.4375        │
│       val/loss_best       │        659864.4375        │
└───────────────────────────┴───────────────────────────┘
[2023-09-06 08:40:43,657][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
[2023-09-06 08:40:43,851][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/multi_run/04-47-31/0/fig
[2023-09-06 08:40:44,598][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/multi_run/04-47-31/0
[2023-09-06 08:40:44,598][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.2048647552728653>
[2023-09-06 08:40:44,598][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_v=0.9985900521278381>
[2023-09-06 08:40:44,598][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_p=5.639854431152344>
[2023-09-06 08:40:44,598][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=-11.84416389465332>
[2023-09-06 08:40:44,598][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=-0.31534960865974426>
[2023-09-06 08:40:44,599][HYDRA] 	#1 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=True
[2023-09-06 08:40:44,745][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-06 08:40:44,747][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: 0.0                                                               
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outp
│       min_epochs: 1                                                           
│       max_epochs: 250000                                                      
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 250001                                         
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/mu
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── navier_stokes                                                           
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 3                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 2                                                                     
│       output_names:                                                           
│       - psi                                                                   
│       - p                                                                     
│                                                                               
├── n_train
│   └── 5000                                                                    
├── mesh
│   └── _target_: pinnstorch.data.PointCloud                                    
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── pred_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       - v                                                                     
│       - p                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_navier_stokes                           
        _partial_: true                                                         
                                                                                
[2023-09-06 08:40:44,780][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-06 08:40:44,780][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-06 08:40:44,780][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-06 08:40:44,780][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.PointCloud>
[2023-09-06 08:40:44,782][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-06 08:40:44,848][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 08:40:44,949][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 08:40:44,986][pinnstorch.train][INFO] - Instantiating prediction dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 08:40:44,988][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-06 08:40:44,992][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-06 08:40:44,995][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-06 08:40:44,998][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-06 08:40:44,998][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-06 08:40:44,999][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-06 08:40:44,999][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-06 08:40:44,999][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-06 08:40:45,007][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
Capture Time 0.8262829780578613
=======
[2023-09-06 08:40:45,889][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-06 08:40:45,889][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.829401969909668
[2023-09-06 08:40:46,066][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.9940216541290283, - MEAN = 0.09036560492082076
`Trainer.fit` stopped: `max_epochs=250000` reached.
[2023-09-06 09:51:39,943][pinnstorch.train][INFO] - Elapsed time: 4254.93537735939
[2023-09-06 09:51:39,952][pinnstorch.train][INFO] - MEAN time: 0.016223669052124023  -   0.016062021255493164 -  0.016059160232543945
====================
[2023-09-06 09:51:39,953][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_p        │     8.407977104187012     │
│        val/error_u        │    0.16113243997097015    │
│        val/error_v        │    0.5269724726676941     │
│         val/loss          │         1265619.5         │
│       val/loss_best       │         1265619.5         │
└───────────────────────────┴───────────────────────────┘
[2023-09-06 09:51:40,060][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
[2023-09-06 09:51:40,239][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/multi_run/04-47-31/1/fig
[2023-09-06 09:51:40,663][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/multi_run/04-47-31/1
[2023-09-06 09:51:40,663][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.16113243997097015>
[2023-09-06 09:51:40,663][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_v=0.5269724726676941>
[2023-09-06 09:51:40,664][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_p=8.407977104187012>
[2023-09-06 09:51:40,664][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=1.158806562423706>
[2023-09-06 09:51:40,664][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=0.04557832330465317>
[2023-09-06 09:51:40,664][HYDRA] 	#2 : trainer.devices=[0] callbacks=null logger=null model.amp=True model.cudagraph_compile=False
[2023-09-06 09:51:40,796][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-06 09:51:40,797][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: 0.0                                                               
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outp
│       min_epochs: 1                                                           
│       max_epochs: 250000                                                      
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 250001                                         
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/mu
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── navier_stokes                                                           
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 3                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 2                                                                     
│       output_names:                                                           
│       - psi                                                                   
│       - p                                                                     
│                                                                               
├── n_train
│   └── 5000                                                                    
├── mesh
│   └── _target_: pinnstorch.data.PointCloud                                    
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── pred_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       - v                                                                     
│       - p                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_navier_stokes                           
        _partial_: true                                                         
                                                                                
[2023-09-06 09:51:40,828][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-06 09:51:40,828][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-06 09:51:40,828][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-06 09:51:40,828][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.PointCloud>
[2023-09-06 09:51:40,830][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-06 09:51:40,886][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 09:51:40,982][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 09:51:41,017][pinnstorch.train][INFO] - Instantiating prediction dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 09:51:41,018][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-06 09:51:41,022][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-06 09:51:41,025][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-06 09:51:41,028][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-06 09:51:41,028][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-06 09:51:41,029][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-06 09:51:41,029][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-06 09:51:41,029][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-06 09:51:41,038][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
=======
[2023-09-06 09:51:41,146][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-06 09:51:41,146][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-06 09:51:41,146][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.0545353889465332
[2023-09-06 09:51:41,609][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.48998212814331055, - MEAN = 0.04454382983121005
[2023-09-06 09:51:45,036][pinnstorch.models.pinn_module][INFO] - step 81: 0.04330158233642578
`Trainer.fit` stopped: `max_epochs=250000` reached.
[2023-09-06 13:16:25,609][pinnstorch.train][INFO] - Elapsed time: 12284.570385694504
[2023-09-06 13:16:25,619][pinnstorch.train][INFO] - MEAN time: 0.046401262283325195  -   0.04581296443939209 -  0.045784950256347656
====================
[2023-09-06 13:16:25,620][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_p        │     5.456930160522461     │
│        val/error_u        │    0.2137516438961029     │
│        val/error_v        │    0.9906537532806396     │
│         val/loss          │        626600.8125        │
│       val/loss_best       │        626600.8125        │
└───────────────────────────┴───────────────────────────┘
[2023-09-06 13:16:25,716][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
[2023-09-06 13:16:25,890][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/multi_run/04-47-31/2/fig
[2023-09-06 13:16:26,320][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/multi_run/04-47-31/2
[2023-09-06 13:16:26,320][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.2137516438961029>
[2023-09-06 13:16:26,320][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_v=0.9906537532806396>
[2023-09-06 13:16:26,320][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_p=5.456930160522461>
[2023-09-06 13:16:26,320][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=-17.998973846435547>
[2023-09-06 13:16:26,320][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=-0.31121203303337097>
[2023-09-06 13:16:26,321][HYDRA] 	#3 : trainer.devices=[0] callbacks=null logger=null model.amp=True model.cudagraph_compile=True
[2023-09-06 13:16:26,452][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-06 13:16:26,453][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: 0.0                                                               
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outp
│       min_epochs: 1                                                           
│       max_epochs: 250000                                                      
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 250001                                         
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/mu
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── navier_stokes                                                           
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 3                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 2                                                                     
│       output_names:                                                           
│       - psi                                                                   
│       - p                                                                     
│                                                                               
├── n_train
│   └── 5000                                                                    
├── mesh
│   └── _target_: pinnstorch.data.PointCloud                                    
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── pred_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       - v                                                                     
│       - p                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_navier_stokes                           
        _partial_: true                                                         
                                                                                
[2023-09-06 13:16:26,484][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-06 13:16:26,484][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-06 13:16:26,484][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-06 13:16:26,484][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.PointCloud>
[2023-09-06 13:16:26,486][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-06 13:16:26,548][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 13:16:26,642][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 13:16:26,676][pinnstorch.train][INFO] - Instantiating prediction dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 13:16:26,678][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-06 13:16:26,682][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-06 13:16:26,685][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-06 13:16:26,688][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-06 13:16:26,688][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-06 13:16:26,688][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-06 13:16:26,688][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-06 13:16:26,688][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-06 13:16:26,697][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
Capture Time 0.870248556137085
=======
[2023-09-06 13:16:27,618][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-06 13:16:27,618][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-06 13:16:27,618][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.8732569217681885
[2023-09-06 13:16:27,768][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 1.0113334655761719, - MEAN = 0.09193940596147017
[2023-09-06 13:16:28,593][pinnstorch.models.pinn_module][INFO] - step 81: 0.012792348861694336
`Trainer.fit` stopped: `max_epochs=250000` reached.
[2023-09-06 14:14:08,953][pinnstorch.train][INFO] - Elapsed time: 3462.2561569213867
[2023-09-06 14:14:08,964][pinnstorch.train][INFO] - MEAN time: 0.012917280197143555  -   0.012917399406433105 -  0.012917518615722656
====================
[2023-09-06 14:14:08,964][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_p        │    3.3743844032287598     │
│        val/error_u        │    0.25532659888267517    │
│        val/error_v        │    1.0056179761886597     │
│         val/loss          │        326558.5625        │
│       val/loss_best       │        326558.5625        │
└───────────────────────────┴───────────────────────────┘
[2023-09-06 14:14:09,066][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
[2023-09-06 14:14:09,276][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/multi_run/04-47-31/3/fig
[2023-09-06 14:14:09,700][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/multi_run/04-47-31/3
[2023-09-06 14:14:09,700][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.25532659888267517>
[2023-09-06 14:14:09,700][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_v=1.0056179761886597>
[2023-09-06 14:14:09,700][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_p=3.3743844032287598>
[2023-09-06 14:14:09,700][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=-14.990596771240234>
[2023-09-06 14:14:09,700][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=-8.408279973082244e-05>
[2023-09-06 17:42:53,224][HYDRA] Launching 4 jobs locally
[2023-09-06 17:42:53,224][HYDRA] 	#0 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=False
[2023-09-06 17:42:53,366][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-06 17:42:53,370][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       runge_kutta:                                                            
│         _target_: pinnstorch.models.RungeKutta                                
│         root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                 
│         q: 50                                                                 
│         t1: 40                                                                
│         t2: 160                                                               
│         time_domain:                                                          
│           _target_: pinnstorch.data.TimeDomain                                
│           t_interval:                                                         
│           - 0                                                                 
│           - 1                                                                 
│           t_points: 201                                                       
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_
│       min_epochs: 1                                                           
│       max_epochs: 50000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 50001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/17
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── kdv                                                                     
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 1                                                                     
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       output_names:                                                           
│       - u                                                                     
│       discrete: true                                                          
│                                                                               
├── idx_t0
│   └── 40                                                                      
├── idx_t1
│   └── 160                                                                     
├── N0
│   └── 199                                                                     
├── N1
│   └── 201                                                                     
├── q
│   └── 50                                                                      
├── discrete
│   └── True                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 1                                                                     
│       t_points: 201                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 512                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── runge_kutta
│   └── _target_: pinnstorch.models.RungeKutta                                  
│       root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                   
│       q: 50                                                                   
│       t1: 40                                                                  
│       t2: 160                                                                 
│       time_domain:                                                            
│         _target_: pinnstorch.data.TimeDomain                                  
│         t_interval:                                                           
│         - 0                                                                   
│         - 1                                                                   
│         t_points: 201                                                         
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_kdv                                     
        _partial_: true                                                         
                                                                                
[2023-09-06 17:42:53,426][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-06 17:42:53,426][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-06 17:42:53,426][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-06 17:42:53,428][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-06 17:42:53,429][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-06 17:42:53,430][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-06 17:42:53,432][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-06 17:42:53,443][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 17:42:53,445][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 17:42:53,447][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 17:42:53,448][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-06 17:42:53,469][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-06 17:42:53,474][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-06 17:42:53,510][pinnstorch.utils.utils][INFO] - Weights are available.
[2023-09-06 17:42:53,518][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-06 17:42:53,518][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-06 17:42:53,519][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-06 17:42:53,519][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-06 17:42:53,519][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-06 17:42:53,574][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:378: UserWarning: You have overridden `transfer_batch_to_device` in `LightningModule` but have passed in a `LightningDataModule`. It will use the implementation from `LightningModule` instance.
  warning_cache.warn(
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/utilities/data.py:76: UserWarning: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 512. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
  warning_cache.warn(
=======
[2023-09-06 17:42:54,005][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-06 17:42:54,005][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.1298837661743164
[2023-09-06 17:42:54,341][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.43058323860168457, - MEAN = 0.03914393078197132
[2023-09-06 17:42:57,315][pinnstorch.models.pinn_module][INFO] - step 81: 0.0413050651550293
[2023-09-06 17:43:14,753][HYDRA] Launching 4 jobs locally
[2023-09-06 17:43:14,753][HYDRA] 	#0 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=False
[2023-09-06 17:43:14,891][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-06 17:43:14,895][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: 0.0                                                               
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outp
│       min_epochs: 1                                                           
│       max_epochs: 250000                                                      
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 250001                                         
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/mu
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── navier_stokes                                                           
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 3                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 2                                                                     
│       output_names:                                                           
│       - psi                                                                   
│       - p                                                                     
│                                                                               
├── n_train
│   └── 5000                                                                    
├── mesh
│   └── _target_: pinnstorch.data.PointCloud                                    
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── pred_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       - v                                                                     
│       - p                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_navier_stokes                           
        _partial_: true                                                         
                                                                                
[2023-09-06 17:43:14,933][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-06 17:43:14,933][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-06 17:43:14,933][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-06 17:43:14,934][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.PointCloud>
[2023-09-06 17:43:14,936][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-06 17:43:15,006][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 17:43:15,108][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 17:43:15,141][pinnstorch.train][INFO] - Instantiating prediction dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 17:43:15,142][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-06 17:43:15,167][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-06 17:43:15,173][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-06 17:43:15,205][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-06 17:43:15,205][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-06 17:43:15,205][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-06 17:43:15,205][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-06 17:43:15,205][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-06 17:43:15,252][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:378: UserWarning: You have overridden `transfer_batch_to_device` in `LightningModule` but have passed in a `LightningDataModule`. It will use the implementation from `LightningModule` instance.
  warning_cache.warn(
=======
[2023-09-06 17:43:15,772][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-06 17:43:15,772][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.10285353660583496
[2023-09-06 17:43:16,313][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.6095478534698486, - MEAN = 0.05541344122453169
[2023-09-06 17:43:20,298][pinnstorch.models.pinn_module][INFO] - step 81: 0.07875180244445801
[2023-09-06 17:43:45,799][HYDRA] Launching 4 jobs locally
[2023-09-06 17:43:45,799][HYDRA] 	#0 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=False
[2023-09-06 17:43:45,941][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-06 17:43:45,945][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       runge_kutta:                                                            
│         _target_: pinnstorch.models.RungeKutta                                
│         root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                 
│         q: 100                                                                
│         t1: 20                                                                
│         t2: 180                                                               
│         time_domain:                                                          
│           _target_: pinnstorch.data.TimeDomain                                
│           t_interval:                                                         
│           - 0                                                                 
│           - 1                                                                 
│           t_points: 201                                                       
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/ac/outputs/multi_r
│       min_epochs: 1                                                           
│       max_epochs: 1000000                                                     
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 1000001                                        
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/ac/outputs/multi_run/17-
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── ac                                                                      
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 1                                                                     
│       - 200                                                                   
│       - 200                                                                   
│       - 200                                                                   
│       - 200                                                                   
│       - 101                                                                   
│       output_names:                                                           
│       - u                                                                     
│       discrete: true                                                          
│                                                                               
├── idx_t0
│   └── 20                                                                      
├── idx_t1
│   └── 180                                                                     
├── N
│   └── 200                                                                     
├── q
│   └── 100                                                                     
├── discrete
│   └── True                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 1                                                                     
│       t_points: 201                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 0.99609375                                                            
│       shape:                                                                  
│       - 512                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│       ub:                                                                     
│       - 1.0                                                                   
│       - 1.0                                                                   
│       lb:                                                                     
│       - -1.0                                                                  
│       - 0.0                                                                   
│                                                                               
├── runge_kutta
│   └── _target_: pinnstorch.models.RungeKutta                                  
│       root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                   
│       q: 100                                                                  
│       t1: 20                                                                  
│       t2: 180                                                                 
│       time_domain:                                                            
│         _target_: pinnstorch.data.TimeDomain                                  
│         t_interval:                                                           
│         - 0                                                                   
│         - 1                                                                   
│         t_points: 201                                                         
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_ac                                      
        _partial_: true                                                         
                                                                                
[2023-09-06 17:43:45,996][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-06 17:43:45,996][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-06 17:43:45,997][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-06 17:43:45,998][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-06 17:43:45,999][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-06 17:43:46,000][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-06 17:43:46,002][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-06 17:43:46,007][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 17:43:46,009][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.PeriodicBoundaryCondition>
[2023-09-06 17:43:46,010][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 17:43:46,011][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-06 17:43:46,032][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-06 17:43:46,039][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-06 17:43:46,072][pinnstorch.utils.utils][INFO] - Weights are available.
[2023-09-06 17:43:46,085][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-06 17:43:46,086][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-06 17:43:46,086][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-06 17:43:46,086][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-06 17:43:46,086][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-06 17:43:46,130][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:378: UserWarning: You have overridden `transfer_batch_to_device` in `LightningModule` but have passed in a `LightningDataModule`. It will use the implementation from `LightningModule` instance.
  warning_cache.warn(
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/utilities/data.py:76: UserWarning: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 512. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
  warning_cache.warn(
=======
[2023-09-06 17:43:46,532][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-06 17:43:46,532][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.1065831184387207
[2023-09-06 17:43:46,697][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.2576417922973633, - MEAN = 0.023421981117942116
[2023-09-06 17:43:48,055][pinnstorch.models.pinn_module][INFO] - step 81: 0.018218517303466797
`Trainer.fit` stopped: `max_epochs=50000` reached.
[2023-09-06 18:11:14,358][pinnstorch.train][INFO] - Elapsed time: 1700.7838342189789
[2023-09-06 18:11:14,364][pinnstorch.train][INFO] - MEAN time: 0.027772903442382812  -   0.03258490562438965 -  0.0319216251373291
====================
[2023-09-06 18:11:14,364][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[2023-09-06 18:11:14,414][matplotlib.legend][WARNING] - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
[2023-09-06 18:11:14,436][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/17-42-52/0/fig
[2023-09-06 18:11:15,321][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/17-42-52/0
[2023-09-06 18:11:15,322][HYDRA] 	#1 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=True
[2023-09-06 18:11:15,466][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-06 18:11:15,467][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       runge_kutta:                                                            
│         _target_: pinnstorch.models.RungeKutta                                
│         root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                 
│         q: 50                                                                 
│         t1: 40                                                                
│         t2: 160                                                               
│         time_domain:                                                          
│           _target_: pinnstorch.data.TimeDomain                                
│           t_interval:                                                         
│           - 0                                                                 
│           - 1                                                                 
│           t_points: 201                                                       
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_
│       min_epochs: 1                                                           
│       max_epochs: 50000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 50001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/17
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── kdv                                                                     
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 1                                                                     
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       output_names:                                                           
│       - u                                                                     
│       discrete: true                                                          
│                                                                               
├── idx_t0
│   └── 40                                                                      
├── idx_t1
│   └── 160                                                                     
├── N0
│   └── 199                                                                     
├── N1
│   └── 201                                                                     
├── q
│   └── 50                                                                      
├── discrete
│   └── True                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 1                                                                     
│       t_points: 201                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 512                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── runge_kutta
│   └── _target_: pinnstorch.models.RungeKutta                                  
│       root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                   
│       q: 50                                                                   
│       t1: 40                                                                  
│       t2: 160                                                                 
│       time_domain:                                                            
│         _target_: pinnstorch.data.TimeDomain                                  
│         t_interval:                                                           
│         - 0                                                                   
│         - 1                                                                   
│         t_points: 201                                                         
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_kdv                                     
        _partial_: true                                                         
                                                                                
[2023-09-06 18:11:15,512][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-06 18:11:15,513][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-06 18:11:15,513][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-06 18:11:15,513][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-06 18:11:15,514][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-06 18:11:15,515][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-06 18:11:15,517][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-06 18:11:15,526][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 18:11:15,527][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 18:11:15,529][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 18:11:15,530][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-06 18:11:15,532][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-06 18:11:15,534][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-06 18:11:15,538][pinnstorch.utils.utils][INFO] - Weights are available.
[2023-09-06 18:11:15,541][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-06 18:11:15,541][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-06 18:11:15,541][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-06 18:11:15,541][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-06 18:11:15,542][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-06 18:11:15,549][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Capture Time 0.46654248237609863
=======
[2023-09-06 18:11:16,025][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-06 18:11:16,025][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.46883463859558105
[2023-09-06 18:11:16,079][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.5094459056854248, - MEAN = 0.046313264153220436
`Trainer.fit` stopped: `max_epochs=50000` reached.
[2023-09-06 18:14:52,098][pinnstorch.train][INFO] - Elapsed time: 216.54915285110474
[2023-09-06 18:14:52,100][pinnstorch.train][INFO] - MEAN time: 0.003325939178466797  -   0.0033245086669921875 -  0.0033240318298339844
====================
[2023-09-06 18:14:52,101][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[2023-09-06 18:14:52,141][matplotlib.legend][WARNING] - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
[2023-09-06 18:14:52,163][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/17-42-52/1/fig
[2023-09-06 18:14:52,778][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/17-42-52/1
[2023-09-06 18:14:52,779][HYDRA] 	#2 : trainer.devices=[0] callbacks=null logger=null model.amp=True model.cudagraph_compile=False
[2023-09-06 18:14:52,922][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-06 18:14:52,923][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       runge_kutta:                                                            
│         _target_: pinnstorch.models.RungeKutta                                
│         root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                 
│         q: 50                                                                 
│         t1: 40                                                                
│         t2: 160                                                               
│         time_domain:                                                          
│           _target_: pinnstorch.data.TimeDomain                                
│           t_interval:                                                         
│           - 0                                                                 
│           - 1                                                                 
│           t_points: 201                                                       
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_
│       min_epochs: 1                                                           
│       max_epochs: 50000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 50001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/17
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── kdv                                                                     
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 1                                                                     
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       output_names:                                                           
│       - u                                                                     
│       discrete: true                                                          
│                                                                               
├── idx_t0
│   └── 40                                                                      
├── idx_t1
│   └── 160                                                                     
├── N0
│   └── 199                                                                     
├── N1
│   └── 201                                                                     
├── q
│   └── 50                                                                      
├── discrete
│   └── True                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 1                                                                     
│       t_points: 201                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 512                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── runge_kutta
│   └── _target_: pinnstorch.models.RungeKutta                                  
│       root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                   
│       q: 50                                                                   
│       t1: 40                                                                  
│       t2: 160                                                                 
│       time_domain:                                                            
│         _target_: pinnstorch.data.TimeDomain                                  
│         t_interval:                                                           
│         - 0                                                                   
│         - 1                                                                   
│         t_points: 201                                                         
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_kdv                                     
        _partial_: true                                                         
                                                                                
[2023-09-06 18:14:52,968][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-06 18:14:52,968][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-06 18:14:52,968][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-06 18:14:52,969][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-06 18:14:52,970][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-06 18:14:52,971][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-06 18:14:52,972][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-06 18:14:52,982][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 18:14:52,983][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 18:14:52,985][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 18:14:52,986][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-06 18:14:52,988][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-06 18:14:52,990][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-06 18:14:52,995][pinnstorch.utils.utils][INFO] - Weights are available.
[2023-09-06 18:14:52,997][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-06 18:14:52,997][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-06 18:14:52,998][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-06 18:14:52,998][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-06 18:14:52,998][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-06 18:14:53,005][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
=======
[2023-09-06 18:14:53,089][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-06 18:14:53,090][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-06 18:14:53,090][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.05230832099914551
[2023-09-06 18:14:53,406][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.33941030502319336, - MEAN = 0.03085548227483576
[2023-09-06 18:14:56,021][pinnstorch.models.pinn_module][INFO] - step 81: 0.03417491912841797
`Trainer.fit` stopped: `max_epochs=50000` reached.
[2023-09-06 18:45:23,584][pinnstorch.train][INFO] - Elapsed time: 1830.578999042511
[2023-09-06 18:45:23,590][pinnstorch.train][INFO] - MEAN time: 0.037220001220703125  -   0.03417634963989258 -  0.034789443016052246
====================
[2023-09-06 18:45:23,591][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[2023-09-06 18:45:23,638][matplotlib.legend][WARNING] - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
[2023-09-06 18:45:23,661][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/17-42-52/2/fig
[2023-09-06 18:45:24,275][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/17-42-52/2
[2023-09-06 18:45:24,277][HYDRA] 	#3 : trainer.devices=[0] callbacks=null logger=null model.amp=True model.cudagraph_compile=True
[2023-09-06 18:45:24,420][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-06 18:45:24,421][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       runge_kutta:                                                            
│         _target_: pinnstorch.models.RungeKutta                                
│         root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                 
│         q: 50                                                                 
│         t1: 40                                                                
│         t2: 160                                                               
│         time_domain:                                                          
│           _target_: pinnstorch.data.TimeDomain                                
│           t_interval:                                                         
│           - 0                                                                 
│           - 1                                                                 
│           t_points: 201                                                       
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_
│       min_epochs: 1                                                           
│       max_epochs: 50000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 50001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/17
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── kdv                                                                     
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 1                                                                     
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       output_names:                                                           
│       - u                                                                     
│       discrete: true                                                          
│                                                                               
├── idx_t0
│   └── 40                                                                      
├── idx_t1
│   └── 160                                                                     
├── N0
│   └── 199                                                                     
├── N1
│   └── 201                                                                     
├── q
│   └── 50                                                                      
├── discrete
│   └── True                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 1                                                                     
│       t_points: 201                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 512                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── runge_kutta
│   └── _target_: pinnstorch.models.RungeKutta                                  
│       root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                   
│       q: 50                                                                   
│       t1: 40                                                                  
│       t2: 160                                                                 
│       time_domain:                                                            
│         _target_: pinnstorch.data.TimeDomain                                  
│         t_interval:                                                           
│         - 0                                                                   
│         - 1                                                                   
│         t_points: 201                                                         
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_kdv                                     
        _partial_: true                                                         
                                                                                
[2023-09-06 18:45:24,466][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-06 18:45:24,466][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-06 18:45:24,466][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-06 18:45:24,467][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-06 18:45:24,467][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-06 18:45:24,468][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-06 18:45:24,470][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-06 18:45:24,479][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 18:45:24,481][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 18:45:24,483][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 18:45:24,484][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-06 18:45:24,486][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-06 18:45:24,488][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-06 18:45:24,493][pinnstorch.utils.utils][INFO] - Weights are available.
[2023-09-06 18:45:24,495][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-06 18:45:24,496][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-06 18:45:24,496][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-06 18:45:24,496][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-06 18:45:24,496][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-06 18:45:24,503][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Capture Time 0.4959096908569336
=======
[2023-09-06 18:45:25,011][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-06 18:45:25,011][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-06 18:45:25,011][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.500063419342041
[2023-09-06 18:45:25,069][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.5412938594818115, - MEAN = 0.04920853268016468
[2023-09-06 18:45:25,350][pinnstorch.models.pinn_module][INFO] - step 81: 0.0032875537872314453
`Trainer.fit` stopped: `max_epochs=50000` reached.
[2023-09-06 18:49:01,237][pinnstorch.train][INFO] - Elapsed time: 216.73449277877808
[2023-09-06 18:49:01,240][pinnstorch.train][INFO] - MEAN time: 0.0033338069915771484  -   0.003329157829284668 -  0.0033283233642578125
====================
[2023-09-06 18:49:01,240][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[2023-09-06 18:49:01,280][matplotlib.legend][WARNING] - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
[2023-09-06 18:49:01,302][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/17-42-52/3/fig
[2023-09-06 18:49:01,916][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/17-42-52/3
Error executing job with overrides: ['trainer.devices=[0]', 'callbacks=null', 'logger=null', 'model.amp=False', 'model.cudagraph_compile=False']
Traceback (most recent call last):
  File "/home/reza/tmp/pinns-torch/examples/kdv/train.py", line 55, in main
    metric_value = pinnstorch.utils.get_metric_value(
  File "/home/reza/tmp/pinns-torch/pinnstorch/utils/utils.py", line 126, in get_metric_value
    raise Exception(
Exception: Metric value not found! <metric_name=val/error_u>
Make sure metric name logged in LightningModule is correct!
Make sure `optimized_metric` name in `hparams_search` config is correct!

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
[2023-09-06 19:12:44,122][HYDRA] Launching 4 jobs locally
[2023-09-06 19:12:44,122][HYDRA] 	#0 : trainer.devices=[0] model.jit_compile=False model.amp=False model.cudagraph_compile=False logger=null callbacks=null
[2023-09-06 19:12:44,265][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-06 19:12:44,268][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       runge_kutta:                                                            
│         _target_: pinnstorch.models.RungeKutta                                
│         root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                 
│         q: 50                                                                 
│         t1: 40                                                                
│         t2: 160                                                               
│         time_domain:                                                          
│           _target_: pinnstorch.data.TimeDomain                                
│           t_interval:                                                         
│           - 0                                                                 
│           - 1                                                                 
│           t_points: 201                                                       
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_
│       min_epochs: 1                                                           
│       max_epochs: 50000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 50001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/19
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── kdv                                                                     
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 1                                                                     
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       output_names:                                                           
│       - u                                                                     
│       discrete: true                                                          
│                                                                               
├── idx_t0
│   └── 40                                                                      
├── idx_t1
│   └── 160                                                                     
├── N0
│   └── 199                                                                     
├── N1
│   └── 201                                                                     
├── q
│   └── 50                                                                      
├── discrete
│   └── True                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 1                                                                     
│       t_points: 201                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 512                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── runge_kutta
│   └── _target_: pinnstorch.models.RungeKutta                                  
│       root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                   
│       q: 50                                                                   
│       t1: 40                                                                  
│       t2: 160                                                                 
│       time_domain:                                                            
│         _target_: pinnstorch.data.TimeDomain                                  
│         t_interval:                                                           
│         - 0                                                                   
│         - 1                                                                   
│         t_points: 201                                                         
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_kdv                                     
        _partial_: true                                                         
                                                                                
[2023-09-06 19:12:44,320][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-06 19:12:44,320][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-06 19:12:44,320][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-06 19:12:44,321][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-06 19:12:44,322][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-06 19:12:44,323][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-06 19:12:44,325][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-06 19:12:44,334][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 19:12:44,336][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 19:12:44,338][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 19:12:44,339][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-06 19:12:44,360][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-06 19:12:44,365][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-06 19:12:44,398][pinnstorch.utils.utils][INFO] - Weights are available.
[2023-09-06 19:12:44,403][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-06 19:12:44,403][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-06 19:12:44,403][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-06 19:12:44,404][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-06 19:12:44,404][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-06 19:12:44,446][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:378: UserWarning: You have overridden `transfer_batch_to_device` in `LightningModule` but have passed in a `LightningDataModule`. It will use the implementation from `LightningModule` instance.
  warning_cache.warn(
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/utilities/data.py:76: UserWarning: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 512. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
  warning_cache.warn(
=======
[2023-09-06 19:12:44,880][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-06 19:12:44,880][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.1248323917388916
[2023-09-06 19:12:45,170][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.38545799255371094, - MEAN = 0.035041635686700996
[2023-09-06 19:12:47,467][pinnstorch.models.pinn_module][INFO] - step 81: 0.03231978416442871
[2023-09-06 19:13:54,015][HYDRA] Launching 4 jobs locally
[2023-09-06 19:13:54,015][HYDRA] 	#0 : trainer.devices=[0] model.jit_compile=False model.amp=False model.cudagraph_compile=False logger=null callbacks=null
[2023-09-06 19:13:54,157][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-06 19:13:54,161][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       runge_kutta:                                                            
│         _target_: pinnstorch.models.RungeKutta                                
│         root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                 
│         q: 50                                                                 
│         t1: 40                                                                
│         t2: 160                                                               
│         time_domain:                                                          
│           _target_: pinnstorch.data.TimeDomain                                
│           t_interval:                                                         
│           - 0                                                                 
│           - 1                                                                 
│           t_points: 201                                                       
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_
│       min_epochs: 1                                                           
│       max_epochs: 50000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 50001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/19
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── kdv                                                                     
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 1                                                                     
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       output_names:                                                           
│       - u                                                                     
│       discrete: true                                                          
│                                                                               
├── idx_t0
│   └── 40                                                                      
├── idx_t1
│   └── 160                                                                     
├── N0
│   └── 199                                                                     
├── N1
│   └── 201                                                                     
├── q
│   └── 50                                                                      
├── discrete
│   └── True                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 1                                                                     
│       t_points: 201                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 512                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── runge_kutta
│   └── _target_: pinnstorch.models.RungeKutta                                  
│       root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                   
│       q: 50                                                                   
│       t1: 40                                                                  
│       t2: 160                                                                 
│       time_domain:                                                            
│         _target_: pinnstorch.data.TimeDomain                                  
│         t_interval:                                                           
│         - 0                                                                   
│         - 1                                                                   
│         t_points: 201                                                         
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_kdv                                     
        _partial_: true                                                         
                                                                                
[2023-09-06 19:13:54,213][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-06 19:13:54,213][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-06 19:13:54,213][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-06 19:13:54,214][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-06 19:13:54,215][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-06 19:13:54,216][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-06 19:13:54,218][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-06 19:13:54,227][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 19:13:54,229][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 19:13:54,231][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 19:13:54,232][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-06 19:13:54,253][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-06 19:13:54,258][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-06 19:13:54,291][pinnstorch.utils.utils][INFO] - Weights are available.
[2023-09-06 19:13:54,296][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-06 19:13:54,296][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-06 19:13:54,296][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-06 19:13:54,296][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-06 19:13:54,296][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-06 19:13:54,340][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:378: UserWarning: You have overridden `transfer_batch_to_device` in `LightningModule` but have passed in a `LightningDataModule`. It will use the implementation from `LightningModule` instance.
  warning_cache.warn(
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/utilities/data.py:76: UserWarning: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 512. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
  warning_cache.warn(
=======
[2023-09-06 19:13:54,762][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-06 19:13:54,762][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.12337708473205566
[2023-09-06 19:13:55,126][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.4512364864349365, - MEAN = 0.04102149876681241
[2023-09-06 19:13:57,465][pinnstorch.models.pinn_module][INFO] - step 81: 0.023818492889404297
`Trainer.fit` stopped: `max_epochs=50000` reached.
[2023-09-06 19:41:56,485][pinnstorch.train][INFO] - Elapsed time: 1682.1442618370056
[2023-09-06 19:41:56,490][pinnstorch.train][INFO] - MEAN time: 0.03313589096069336  -   0.03150510787963867 -  0.031508684158325195
====================
[2023-09-06 19:41:56,490][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │    0.00931557547301054    │
│         val/loss          │      5647.5751953125      │
│       val/loss_best       │      5647.5751953125      │
└───────────────────────────┴───────────────────────────┘
[2023-09-06 19:41:56,508][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[2023-09-06 19:41:56,553][matplotlib.legend][WARNING] - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
[2023-09-06 19:41:56,575][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/19-13-53/0/fig
[2023-09-06 19:41:57,459][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/19-13-53/0
[2023-09-06 19:41:57,460][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.00931557547301054>
[2023-09-06 19:41:57,460][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=1.0011836290359497>
[2023-09-06 19:41:57,460][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=-5.985177040100098>
[2023-09-06 19:41:57,461][HYDRA] 	#1 : trainer.devices=[0] model.jit_compile=False model.amp=False model.cudagraph_compile=True logger=null callbacks=null
[2023-09-06 19:41:57,604][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-06 19:41:57,606][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       runge_kutta:                                                            
│         _target_: pinnstorch.models.RungeKutta                                
│         root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                 
│         q: 50                                                                 
│         t1: 40                                                                
│         t2: 160                                                               
│         time_domain:                                                          
│           _target_: pinnstorch.data.TimeDomain                                
│           t_interval:                                                         
│           - 0                                                                 
│           - 1                                                                 
│           t_points: 201                                                       
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_
│       min_epochs: 1                                                           
│       max_epochs: 50000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 50001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/19
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── kdv                                                                     
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 1                                                                     
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       output_names:                                                           
│       - u                                                                     
│       discrete: true                                                          
│                                                                               
├── idx_t0
│   └── 40                                                                      
├── idx_t1
│   └── 160                                                                     
├── N0
│   └── 199                                                                     
├── N1
│   └── 201                                                                     
├── q
│   └── 50                                                                      
├── discrete
│   └── True                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 1                                                                     
│       t_points: 201                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 512                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── runge_kutta
│   └── _target_: pinnstorch.models.RungeKutta                                  
│       root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                   
│       q: 50                                                                   
│       t1: 40                                                                  
│       t2: 160                                                                 
│       time_domain:                                                            
│         _target_: pinnstorch.data.TimeDomain                                  
│         t_interval:                                                           
│         - 0                                                                   
│         - 1                                                                   
│         t_points: 201                                                         
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_kdv                                     
        _partial_: true                                                         
                                                                                
[2023-09-06 19:41:57,651][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-06 19:41:57,651][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-06 19:41:57,651][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-06 19:41:57,652][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-06 19:41:57,653][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-06 19:41:57,654][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-06 19:41:57,655][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-06 19:41:57,664][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 19:41:57,666][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 19:41:57,668][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 19:41:57,669][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-06 19:41:57,671][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-06 19:41:57,673][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-06 19:41:57,677][pinnstorch.utils.utils][INFO] - Weights are available.
[2023-09-06 19:41:57,680][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-06 19:41:57,680][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-06 19:41:57,680][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-06 19:41:57,680][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-06 19:41:57,680][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-06 19:41:57,688][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Capture Time 0.44999074935913086
=======
[2023-09-06 19:41:58,148][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-06 19:41:58,148][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.4528379440307617
[2023-09-06 19:41:58,204][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.4939289093017578, - MEAN = 0.04490262811834162
`Trainer.fit` stopped: `max_epochs=50000` reached.
[2023-09-06 19:45:33,190][pinnstorch.train][INFO] - Elapsed time: 215.50247621536255
[2023-09-06 19:45:33,193][pinnstorch.train][INFO] - MEAN time: 0.0033254623413085938  -   0.003318309783935547 -  0.003316164016723633
====================
[2023-09-06 19:45:33,193][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │   0.009563312865793705    │
│         val/loss          │      5639.9345703125      │
│       val/loss_best       │      5639.9345703125      │
└───────────────────────────┴───────────────────────────┘
[2023-09-06 19:45:33,204][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[2023-09-06 19:45:33,243][matplotlib.legend][WARNING] - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
[2023-09-06 19:45:33,265][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/19-13-53/1/fig
[2023-09-06 19:45:33,877][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/19-13-53/1
[2023-09-06 19:45:33,877][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.009563312865793705>
[2023-09-06 19:45:33,877][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=1.0012761354446411>
[2023-09-06 19:45:33,877][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=-5.985246181488037>
[2023-09-06 19:45:33,878][HYDRA] 	#2 : trainer.devices=[0] model.jit_compile=False model.amp=True model.cudagraph_compile=False logger=null callbacks=null
[2023-09-06 19:45:34,021][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-06 19:45:34,022][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       runge_kutta:                                                            
│         _target_: pinnstorch.models.RungeKutta                                
│         root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                 
│         q: 50                                                                 
│         t1: 40                                                                
│         t2: 160                                                               
│         time_domain:                                                          
│           _target_: pinnstorch.data.TimeDomain                                
│           t_interval:                                                         
│           - 0                                                                 
│           - 1                                                                 
│           t_points: 201                                                       
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_
│       min_epochs: 1                                                           
│       max_epochs: 50000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 50001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/19
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── kdv                                                                     
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 1                                                                     
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       output_names:                                                           
│       - u                                                                     
│       discrete: true                                                          
│                                                                               
├── idx_t0
│   └── 40                                                                      
├── idx_t1
│   └── 160                                                                     
├── N0
│   └── 199                                                                     
├── N1
│   └── 201                                                                     
├── q
│   └── 50                                                                      
├── discrete
│   └── True                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 1                                                                     
│       t_points: 201                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 512                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── runge_kutta
│   └── _target_: pinnstorch.models.RungeKutta                                  
│       root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                   
│       q: 50                                                                   
│       t1: 40                                                                  
│       t2: 160                                                                 
│       time_domain:                                                            
│         _target_: pinnstorch.data.TimeDomain                                  
│         t_interval:                                                           
│         - 0                                                                   
│         - 1                                                                   
│         t_points: 201                                                         
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_kdv                                     
        _partial_: true                                                         
                                                                                
[2023-09-06 19:45:34,067][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-06 19:45:34,067][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-06 19:45:34,068][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-06 19:45:34,068][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-06 19:45:34,069][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-06 19:45:34,070][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-06 19:45:34,072][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-06 19:45:34,081][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 19:45:34,082][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 19:45:34,084][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 19:45:34,085][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-06 19:45:34,087][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-06 19:45:34,089][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-06 19:45:34,094][pinnstorch.utils.utils][INFO] - Weights are available.
[2023-09-06 19:45:34,096][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-06 19:45:34,097][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-06 19:45:34,097][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-06 19:45:34,097][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-06 19:45:34,097][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-06 19:45:34,104][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
=======
[2023-09-06 19:45:34,219][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-06 19:45:34,220][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-06 19:45:34,220][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.08353447914123535
[2023-09-06 19:45:34,586][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.4117913246154785, - MEAN = 0.0374355749650435
[2023-09-06 19:45:37,085][pinnstorch.models.pinn_module][INFO] - step 81: 0.030495405197143555
`Trainer.fit` stopped: `max_epochs=50000` reached.
[2023-09-06 20:15:41,817][pinnstorch.train][INFO] - Elapsed time: 1807.7129604816437
[2023-09-06 20:15:41,822][pinnstorch.train][INFO] - MEAN time: 0.028597593307495117  -   0.03526639938354492 -  0.03433120250701904
====================
[2023-09-06 20:15:41,823][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │   0.008678372018039227    │
│         val/loss          │      5657.396484375       │
│       val/loss_best       │      5657.396484375       │
└───────────────────────────┴───────────────────────────┘
[2023-09-06 20:15:41,838][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[2023-09-06 20:15:41,880][matplotlib.legend][WARNING] - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
[2023-09-06 20:15:41,902][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/19-13-53/2/fig
[2023-09-06 20:15:42,510][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/19-13-53/2
[2023-09-06 20:15:42,510][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.008678372018039227>
[2023-09-06 20:15:42,510][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=1.0006414651870728>
[2023-09-06 20:15:42,511][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=-5.986152172088623>
[2023-09-06 20:15:42,511][HYDRA] 	#3 : trainer.devices=[0] model.jit_compile=False model.amp=True model.cudagraph_compile=True logger=null callbacks=null
[2023-09-06 20:15:42,654][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-06 20:15:42,655][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       runge_kutta:                                                            
│         _target_: pinnstorch.models.RungeKutta                                
│         root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                 
│         q: 50                                                                 
│         t1: 40                                                                
│         t2: 160                                                               
│         time_domain:                                                          
│           _target_: pinnstorch.data.TimeDomain                                
│           t_interval:                                                         
│           - 0                                                                 
│           - 1                                                                 
│           t_points: 201                                                       
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_
│       min_epochs: 1                                                           
│       max_epochs: 50000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 50001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/19
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── kdv                                                                     
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 1                                                                     
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       output_names:                                                           
│       - u                                                                     
│       discrete: true                                                          
│                                                                               
├── idx_t0
│   └── 40                                                                      
├── idx_t1
│   └── 160                                                                     
├── N0
│   └── 199                                                                     
├── N1
│   └── 201                                                                     
├── q
│   └── 50                                                                      
├── discrete
│   └── True                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 1                                                                     
│       t_points: 201                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 512                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── runge_kutta
│   └── _target_: pinnstorch.models.RungeKutta                                  
│       root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                   
│       q: 50                                                                   
│       t1: 40                                                                  
│       t2: 160                                                                 
│       time_domain:                                                            
│         _target_: pinnstorch.data.TimeDomain                                  
│         t_interval:                                                           
│         - 0                                                                   
│         - 1                                                                   
│         t_points: 201                                                         
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_kdv                                     
        _partial_: true                                                         
                                                                                
[2023-09-06 20:15:42,701][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-06 20:15:42,701][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-06 20:15:42,701][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-06 20:15:42,701][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-06 20:15:42,702][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-06 20:15:42,703][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-06 20:15:42,705][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-06 20:15:42,714][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 20:15:42,715][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 20:15:42,717][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 20:15:42,718][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-06 20:15:42,720][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-06 20:15:42,722][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-06 20:15:42,727][pinnstorch.utils.utils][INFO] - Weights are available.
[2023-09-06 20:15:42,730][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-06 20:15:42,730][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-06 20:15:42,730][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-06 20:15:42,730][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-06 20:15:42,730][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-06 20:15:42,737][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Capture Time 0.5505256652832031
=======
[2023-09-06 20:15:43,299][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-06 20:15:43,299][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-06 20:15:43,300][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.5546162128448486
[2023-09-06 20:15:43,363][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.5991361141204834, - MEAN = 0.05446691946549849
[2023-09-06 20:15:43,642][pinnstorch.models.pinn_module][INFO] - step 81: 0.0032918453216552734
`Trainer.fit` stopped: `max_epochs=50000` reached.
[2023-09-06 20:19:18,487][pinnstorch.train][INFO] - Elapsed time: 215.74989533424377
[2023-09-06 20:19:18,490][pinnstorch.train][INFO] - MEAN time: 0.003310680389404297  -   0.0033109188079833984 -  0.0033156871795654297
====================
[2023-09-06 20:19:18,490][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │    0.0182937141507864     │
│         val/loss          │      5644.720703125       │
│       val/loss_best       │      5644.720703125       │
└───────────────────────────┴───────────────────────────┘
[2023-09-06 20:19:18,501][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[2023-09-06 20:19:18,541][matplotlib.legend][WARNING] - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
[2023-09-06 20:19:18,562][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/19-13-53/3/fig
[2023-09-06 20:19:19,174][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/kdv/outputs/multi_run/19-13-53/3
[2023-09-06 20:19:19,175][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.0182937141507864>
[2023-09-06 20:19:19,175][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=1.002550482749939>
[2023-09-06 20:19:19,175][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=-5.98397159576416>
`Trainer.fit` stopped: `max_epochs=250000` reached.
[2023-09-06 21:47:40,923][pinnstorch.train][INFO] - Elapsed time: 14665.670925617218
[2023-09-06 21:47:40,936][pinnstorch.train][INFO] - MEAN time: 0.06430888175964355  -   0.05957639217376709 -  0.05640208721160889
====================
[2023-09-06 21:47:40,936][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_p        │    15.408695220947266     │
│        val/error_u        │    0.00934128649532795    │
│        val/error_v        │    0.02353658340871334    │
│         val/loss          │        4109078.75         │
│       val/loss_best       │        4109078.75         │
└───────────────────────────┴───────────────────────────┘
[2023-09-06 21:47:41,045][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
[2023-09-06 21:47:41,237][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/multi_run/17-43-14/0/fig
[2023-09-06 21:47:41,948][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/multi_run/17-43-14/0
[2023-09-06 21:47:41,949][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.00934128649532795>
[2023-09-06 21:47:41,949][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_v=0.02353658340871334>
[2023-09-06 21:47:41,949][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_p=15.408695220947266>
[2023-09-06 21:47:41,949][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=0.9979715347290039>
[2023-09-06 21:47:41,949][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=0.010617976076900959>
[2023-09-06 21:47:41,950][HYDRA] 	#1 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=True
[2023-09-06 21:47:42,088][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-06 21:47:42,089][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: 0.0                                                               
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outp
│       min_epochs: 1                                                           
│       max_epochs: 250000                                                      
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 250001                                         
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/mu
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── navier_stokes                                                           
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 3                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 2                                                                     
│       output_names:                                                           
│       - psi                                                                   
│       - p                                                                     
│                                                                               
├── n_train
│   └── 5000                                                                    
├── mesh
│   └── _target_: pinnstorch.data.PointCloud                                    
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── pred_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       - v                                                                     
│       - p                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_navier_stokes                           
        _partial_: true                                                         
                                                                                
[2023-09-06 21:47:42,121][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-06 21:47:42,121][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-06 21:47:42,121][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-06 21:47:42,122][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.PointCloud>
[2023-09-06 21:47:42,123][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-06 21:47:42,187][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 21:47:42,285][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 21:47:42,321][pinnstorch.train][INFO] - Instantiating prediction dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 21:47:42,323][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-06 21:47:42,327][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-06 21:47:42,330][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-06 21:47:42,333][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-06 21:47:42,333][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-06 21:47:42,333][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-06 21:47:42,333][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-06 21:47:42,333][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-06 21:47:42,343][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
Capture Time 0.7726211547851562
=======
[2023-09-06 21:47:43,166][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-06 21:47:43,166][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.7758982181549072
[2023-09-06 21:47:43,351][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.9492042064666748, - MEAN = 0.08629129149697044
`Trainer.fit` stopped: `max_epochs=250000` reached.
[2023-09-06 23:00:08,356][pinnstorch.train][INFO] - Elapsed time: 4346.012174606323
[2023-09-06 23:00:08,366][pinnstorch.train][INFO] - MEAN time: 0.016523122787475586  -   0.016419291496276855 -  0.01641106605529785
====================
[2023-09-06 23:00:08,366][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_p        │    19.278411865234375     │
│        val/error_u        │   0.007501855026930571    │
│        val/error_v        │   0.025118501856923103    │
│         val/loss          │         6432051.5         │
│       val/loss_best       │         6432051.5         │
└───────────────────────────┴───────────────────────────┘
[2023-09-06 23:00:08,476][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
[2023-09-06 23:00:08,658][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/multi_run/17-43-14/1/fig
[2023-09-06 23:00:09,107][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/multi_run/17-43-14/1
[2023-09-06 23:00:09,107][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.007501855026930571>
[2023-09-06 23:00:09,107][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_v=0.025118501856923103>
[2023-09-06 23:00:09,107][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_p=19.278411865234375>
[2023-09-06 23:00:09,107][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=0.9985272884368896>
[2023-09-06 23:00:09,107][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=0.010507815517485142>
[2023-09-06 23:00:09,108][HYDRA] 	#2 : trainer.devices=[0] callbacks=null logger=null model.amp=True model.cudagraph_compile=False
[2023-09-06 23:00:09,245][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-06 23:00:09,246][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: 0.0                                                               
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outp
│       min_epochs: 1                                                           
│       max_epochs: 250000                                                      
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 250001                                         
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/mu
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── navier_stokes                                                           
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 3                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 2                                                                     
│       output_names:                                                           
│       - psi                                                                   
│       - p                                                                     
│                                                                               
├── n_train
│   └── 5000                                                                    
├── mesh
│   └── _target_: pinnstorch.data.PointCloud                                    
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── pred_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       - v                                                                     
│       - p                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_navier_stokes                           
        _partial_: true                                                         
                                                                                
[2023-09-06 23:00:09,278][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-06 23:00:09,278][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-06 23:00:09,278][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-06 23:00:09,279][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.PointCloud>
[2023-09-06 23:00:09,280][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-06 23:00:09,339][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 23:00:09,438][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 23:00:09,473][pinnstorch.train][INFO] - Instantiating prediction dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-06 23:00:09,475][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-06 23:00:09,479][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-06 23:00:09,482][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-06 23:00:09,485][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-06 23:00:09,485][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-06 23:00:09,485][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-06 23:00:09,485][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-06 23:00:09,485][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-06 23:00:09,494][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
=======
[2023-09-06 23:00:09,607][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-06 23:00:09,608][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-06 23:00:09,608][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.06970548629760742
[2023-09-06 23:00:10,211][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.6374893188476562, - MEAN = 0.05795357444069602
[2023-09-06 23:00:14,690][pinnstorch.models.pinn_module][INFO] - step 81: 0.059229135513305664
`Trainer.fit` stopped: `max_epochs=1000000` reached.
[2023-09-06 23:04:25,020][pinnstorch.train][INFO] - Elapsed time: 19238.890164375305
[2023-09-06 23:04:25,072][pinnstorch.train][INFO] - MEAN time: 0.014062166213989258  -   0.01799488067626953 -  0.018402099609375
====================
[2023-09-06 23:04:25,072][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │    0.4656814932823181     │
│         val/loss          │       14361.421875        │
│       val/loss_best       │       14361.421875        │
└───────────────────────────┴───────────────────────────┘
[2023-09-06 23:04:25,085][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
[2023-09-06 23:04:25,129][matplotlib.legend][WARNING] - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
[2023-09-06 23:04:25,155][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/ac/outputs/multi_run/17-43-45/0/fig
[2023-09-06 23:04:26,046][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/ac/outputs/multi_run/17-43-45/0
[2023-09-06 23:04:26,047][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.4656814932823181>
[2023-09-06 23:04:26,048][HYDRA] 	#1 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=True
[2023-09-06 23:04:26,187][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-06 23:04:26,188][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       runge_kutta:                                                            
│         _target_: pinnstorch.models.RungeKutta                                
│         root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                 
│         q: 100                                                                
│         t1: 20                                                                
│         t2: 180                                                               
│         time_domain:                                                          
│           _target_: pinnstorch.data.TimeDomain                                
│           t_interval:                                                         
│           - 0                                                                 
│           - 1                                                                 
│           t_points: 201                                                       
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/ac/outputs/multi_r
│       min_epochs: 1                                                           
│       max_epochs: 1000000                                                     
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 1000001                                        
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/ac/outputs/multi_run/17-
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── ac                                                                      
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 1                                                                     
│       - 200                                                                   
│       - 200                                                                   
│       - 200                                                                   
│       - 200                                                                   
│       - 101                                                                   
│       output_names:                                                           
│       - u                                                                     
│       discrete: true                                                          
│                                                                               
├── idx_t0
│   └── 20                                                                      
├── idx_t1
│   └── 180                                                                     
├── N
│   └── 200                                                                     
├── q
│   └── 100                                                                     
├── discrete
│   └── True                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 1                                                                     
│       t_points: 201                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 0.99609375                                                            
│       shape:                                                                  
│       - 512                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│       ub:                                                                     
│       - 1.0                                                                   
│       - 1.0                                                                   
│       lb:                                                                     
│       - -1.0                                                                  
│       - 0.0                                                                   
│                                                                               
├── runge_kutta
│   └── _target_: pinnstorch.models.RungeKutta                                  
│       root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                   
│       q: 100                                                                  
│       t1: 20                                                                  
│       t2: 180                                                                 
│       time_domain:                                                            
│         _target_: pinnstorch.data.TimeDomain                                  
│         t_interval:                                                           
│         - 0                                                                   
│         - 1                                                                   
│         t_points: 201                                                         
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_ac                                      
        _partial_: true                                                         
                                                                                
[2023-09-06 23:04:26,232][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-06 23:04:26,233][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-06 23:04:26,233][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-06 23:04:26,233][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-06 23:04:26,234][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-06 23:04:26,234][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-06 23:04:26,237][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-06 23:04:26,241][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 23:04:26,242][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.PeriodicBoundaryCondition>
[2023-09-06 23:04:26,244][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 23:04:26,245][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-06 23:04:26,247][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-06 23:04:26,250][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-06 23:04:26,254][pinnstorch.utils.utils][INFO] - Weights are available.
[2023-09-06 23:04:26,259][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-06 23:04:26,259][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-06 23:04:26,259][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-06 23:04:26,259][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-06 23:04:26,259][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-06 23:04:26,266][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
Capture Time 0.35087060928344727
=======
[2023-09-06 23:04:26,627][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-06 23:04:26,627][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.3527841567993164
[2023-09-06 23:04:26,657][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.37671375274658203, - MEAN = 0.03424670479514382
`Trainer.fit` stopped: `max_epochs=1000000` reached.
[2023-09-06 23:45:54,762][pinnstorch.train][INFO] - Elapsed time: 2488.4959235191345
[2023-09-06 23:45:54,801][pinnstorch.train][INFO] - MEAN time: 0.0020546913146972656  -   0.0020592212677001953 -  0.002042531967163086
====================
[2023-09-06 23:45:54,801][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │    0.4174738824367523     │
│         val/loss          │      13443.337890625      │
│       val/loss_best       │      13443.337890625      │
└───────────────────────────┴───────────────────────────┘
[2023-09-06 23:45:54,814][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
[2023-09-06 23:45:54,854][matplotlib.legend][WARNING] - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
[2023-09-06 23:45:54,880][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/ac/outputs/multi_run/17-43-45/1/fig
[2023-09-06 23:45:55,497][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/ac/outputs/multi_run/17-43-45/1
[2023-09-06 23:45:55,497][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.4174738824367523>
[2023-09-06 23:45:55,498][HYDRA] 	#2 : trainer.devices=[0] callbacks=null logger=null model.amp=True model.cudagraph_compile=False
[2023-09-06 23:45:55,638][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-06 23:45:55,639][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       runge_kutta:                                                            
│         _target_: pinnstorch.models.RungeKutta                                
│         root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                 
│         q: 100                                                                
│         t1: 20                                                                
│         t2: 180                                                               
│         time_domain:                                                          
│           _target_: pinnstorch.data.TimeDomain                                
│           t_interval:                                                         
│           - 0                                                                 
│           - 1                                                                 
│           t_points: 201                                                       
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/ac/outputs/multi_r
│       min_epochs: 1                                                           
│       max_epochs: 1000000                                                     
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 1000001                                        
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/ac/outputs/multi_run/17-
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── ac                                                                      
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 1                                                                     
│       - 200                                                                   
│       - 200                                                                   
│       - 200                                                                   
│       - 200                                                                   
│       - 101                                                                   
│       output_names:                                                           
│       - u                                                                     
│       discrete: true                                                          
│                                                                               
├── idx_t0
│   └── 20                                                                      
├── idx_t1
│   └── 180                                                                     
├── N
│   └── 200                                                                     
├── q
│   └── 100                                                                     
├── discrete
│   └── True                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 1                                                                     
│       t_points: 201                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 0.99609375                                                            
│       shape:                                                                  
│       - 512                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│       ub:                                                                     
│       - 1.0                                                                   
│       - 1.0                                                                   
│       lb:                                                                     
│       - -1.0                                                                  
│       - 0.0                                                                   
│                                                                               
├── runge_kutta
│   └── _target_: pinnstorch.models.RungeKutta                                  
│       root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                   
│       q: 100                                                                  
│       t1: 20                                                                  
│       t2: 180                                                                 
│       time_domain:                                                            
│         _target_: pinnstorch.data.TimeDomain                                  
│         t_interval:                                                           
│         - 0                                                                   
│         - 1                                                                   
│         t_points: 201                                                         
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_ac                                      
        _partial_: true                                                         
                                                                                
[2023-09-06 23:45:55,683][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-06 23:45:55,684][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-06 23:45:55,684][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-06 23:45:55,684][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-06 23:45:55,685][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-06 23:45:55,686][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-06 23:45:55,688][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-06 23:45:55,692][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 23:45:55,694][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.PeriodicBoundaryCondition>
[2023-09-06 23:45:55,695][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-06 23:45:55,696][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-06 23:45:55,698][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-06 23:45:55,702][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-06 23:45:55,706][pinnstorch.utils.utils][INFO] - Weights are available.
[2023-09-06 23:45:55,710][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-06 23:45:55,710][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-06 23:45:55,710][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-06 23:45:55,710][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-06 23:45:55,710][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-06 23:45:55,718][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
=======
[2023-09-06 23:45:55,810][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-06 23:45:55,810][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-06 23:45:55,811][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.06439518928527832
[2023-09-06 23:45:56,008][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.24460363388061523, - MEAN = 0.02223669398914684
[2023-09-06 23:45:57,419][pinnstorch.models.pinn_module][INFO] - step 81: 0.021010875701904297
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/torchmetrics/utilities/prints.py:42: UserWarning: Encounted `nan` values in tensor. Will be removed.
  warnings.warn(*args, **kwargs)  # noqa: B028
`Trainer.fit` stopped: `max_epochs=250000` reached.
[2023-09-07 03:11:12,372][pinnstorch.train][INFO] - Elapsed time: 15062.877860069275
[2023-09-07 03:11:12,384][pinnstorch.train][INFO] - MEAN time: 0.06835436820983887  -   0.05860638618469238 -  0.05759096145629883
====================
[2023-09-07 03:11:12,385][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_p        │     4.171596527099609     │
│        val/error_u        │   0.007499824743717909    │
│        val/error_v        │    0.02348567359149456    │
│         val/loss          │       301253.21875        │
│       val/loss_best       │       301253.21875        │
└───────────────────────────┴───────────────────────────┘
[2023-09-07 03:11:12,480][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
[2023-09-07 03:11:12,657][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/multi_run/17-43-14/2/fig
[2023-09-07 03:11:13,095][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/multi_run/17-43-14/2
[2023-09-07 03:11:13,095][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.007499824743717909>
[2023-09-07 03:11:13,095][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_v=0.02348567359149456>
[2023-09-07 03:11:13,095][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_p=4.171596527099609>
[2023-09-07 03:11:13,095][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=0.9988496899604797>
[2023-09-07 03:11:13,095][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=0.010330942459404469>
[2023-09-07 03:11:13,096][HYDRA] 	#3 : trainer.devices=[0] callbacks=null logger=null model.amp=True model.cudagraph_compile=True
[2023-09-07 03:11:13,231][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-07 03:11:13,232][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: 0.0                                                               
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outp
│       min_epochs: 1                                                           
│       max_epochs: 250000                                                      
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 250001                                         
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/mu
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── navier_stokes                                                           
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 3                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 2                                                                     
│       output_names:                                                           
│       - psi                                                                   
│       - p                                                                     
│                                                                               
├── n_train
│   └── 5000                                                                    
├── mesh
│   └── _target_: pinnstorch.data.PointCloud                                    
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── pred_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       - v                                                                     
│       - p                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_navier_stokes                           
        _partial_: true                                                         
                                                                                
[2023-09-07 03:11:13,264][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-07 03:11:13,264][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-07 03:11:13,264][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-07 03:11:13,265][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.PointCloud>
[2023-09-07 03:11:13,266][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-07 03:11:13,324][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-07 03:11:13,422][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-07 03:11:13,457][pinnstorch.train][INFO] - Instantiating prediction dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-07 03:11:13,459][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-07 03:11:13,463][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-07 03:11:13,466][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-07 03:11:13,469][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-07 03:11:13,469][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-07 03:11:13,469][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-07 03:11:13,469][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-07 03:11:13,469][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-07 03:11:13,478][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
Capture Time 0.9306886196136475
=======
[2023-09-07 03:11:14,461][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-07 03:11:14,461][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-07 03:11:14,461][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.9344909191131592
[2023-09-07 03:11:14,615][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 1.0757677555084229, - MEAN = 0.0977970686825839
[2023-09-07 03:11:15,461][pinnstorch.models.pinn_module][INFO] - step 81: 0.013135433197021484
`Trainer.fit` stopped: `max_epochs=250000` reached.
[2023-09-07 04:10:46,869][pinnstorch.train][INFO] - Elapsed time: 3573.391161441803
[2023-09-07 04:10:46,880][pinnstorch.train][INFO] - MEAN time: 0.013248682022094727  -   0.013261914253234863 -  0.013282537460327148
====================
[2023-09-07 04:10:46,880][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_p        │    3.5639305114746094     │
│        val/error_u        │    0.01833241619169712    │
│        val/error_v        │   0.051720812916755676    │
│         val/loss          │         220292.75         │
│       val/loss_best       │         220292.75         │
└───────────────────────────┴───────────────────────────┘
[2023-09-07 04:10:46,980][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
[2023-09-07 04:10:47,166][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/multi_run/17-43-14/3/fig
[2023-09-07 04:10:47,606][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/navier_stokes/outputs/multi_run/17-43-14/3
[2023-09-07 04:10:47,606][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.01833241619169712>
[2023-09-07 04:10:47,606][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_v=0.051720812916755676>
[2023-09-07 04:10:47,606][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_p=3.5639305114746094>
[2023-09-07 04:10:47,606][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=0.9912809729576111>
[2023-09-07 04:10:47,606][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=0.011058499105274677>
`Trainer.fit` stopped: `max_epochs=1000000` reached.
[2023-09-07 05:43:19,040][pinnstorch.train][INFO] - Elapsed time: 21443.32109761238
[2023-09-07 05:43:19,097][pinnstorch.train][INFO] - MEAN time: 0.02280282974243164  -   0.02268970012664795 -  0.020215749740600586
====================
[2023-09-07 05:43:19,097][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │     0.418902724981308     │
│         val/loss          │      11808.982421875      │
│       val/loss_best       │      11808.982421875      │
└───────────────────────────┴───────────────────────────┘
[2023-09-07 05:43:19,112][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
[2023-09-07 05:43:19,152][matplotlib.legend][WARNING] - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
[2023-09-07 05:43:19,177][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/ac/outputs/multi_run/17-43-45/2/fig
[2023-09-07 05:43:19,771][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/ac/outputs/multi_run/17-43-45/2
[2023-09-07 05:43:19,772][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.418902724981308>
[2023-09-07 05:43:19,772][HYDRA] 	#3 : trainer.devices=[0] callbacks=null logger=null model.amp=True model.cudagraph_compile=True
[2023-09-07 05:43:19,907][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-07 05:43:19,908][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       runge_kutta:                                                            
│         _target_: pinnstorch.models.RungeKutta                                
│         root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                 
│         q: 100                                                                
│         t1: 20                                                                
│         t2: 180                                                               
│         time_domain:                                                          
│           _target_: pinnstorch.data.TimeDomain                                
│           t_interval:                                                         
│           - 0                                                                 
│           - 1                                                                 
│           t_points: 201                                                       
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/ac/outputs/multi_r
│       min_epochs: 1                                                           
│       max_epochs: 1000000                                                     
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 1000001                                        
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/ac/outputs/multi_run/17-
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── ac                                                                      
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 1                                                                     
│       - 200                                                                   
│       - 200                                                                   
│       - 200                                                                   
│       - 200                                                                   
│       - 101                                                                   
│       output_names:                                                           
│       - u                                                                     
│       discrete: true                                                          
│                                                                               
├── idx_t0
│   └── 20                                                                      
├── idx_t1
│   └── 180                                                                     
├── N
│   └── 200                                                                     
├── q
│   └── 100                                                                     
├── discrete
│   └── True                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 1                                                                     
│       t_points: 201                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 0.99609375                                                            
│       shape:                                                                  
│       - 512                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│       ub:                                                                     
│       - 1.0                                                                   
│       - 1.0                                                                   
│       lb:                                                                     
│       - -1.0                                                                  
│       - 0.0                                                                   
│                                                                               
├── runge_kutta
│   └── _target_: pinnstorch.models.RungeKutta                                  
│       root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                   
│       q: 100                                                                  
│       t1: 20                                                                  
│       t2: 180                                                                 
│       time_domain:                                                            
│         _target_: pinnstorch.data.TimeDomain                                  
│         t_interval:                                                           
│         - 0                                                                   
│         - 1                                                                   
│         t_points: 201                                                         
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_ac                                      
        _partial_: true                                                         
                                                                                
[2023-09-07 05:43:19,952][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-07 05:43:19,952][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-07 05:43:19,952][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-07 05:43:19,952][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-07 05:43:19,953][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-07 05:43:19,954][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-07 05:43:19,956][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-07 05:43:19,960][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-07 05:43:19,961][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.PeriodicBoundaryCondition>
[2023-09-07 05:43:19,963][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-07 05:43:19,964][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-07 05:43:19,966][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-07 05:43:19,969][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-07 05:43:19,973][pinnstorch.utils.utils][INFO] - Weights are available.
[2023-09-07 05:43:19,977][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-07 05:43:19,977][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-07 05:43:19,977][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-07 05:43:19,978][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-07 05:43:19,978][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-07 05:43:19,984][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
Capture Time 0.4472973346710205
=======
[2023-09-07 05:43:20,441][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-07 05:43:20,441][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-07 05:43:20,441][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.44930243492126465
[2023-09-07 05:43:20,475][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.4779491424560547, - MEAN = 0.04344992204145952
[2023-09-07 05:43:20,670][pinnstorch.models.pinn_module][INFO] - step 81: 0.002790212631225586
`Trainer.fit` stopped: `max_epochs=1000000` reached.
[2023-09-07 06:31:55,062][pinnstorch.train][INFO] - Elapsed time: 2915.077526807785
[2023-09-07 06:31:55,103][pinnstorch.train][INFO] - MEAN time: 0.0024781227111816406  -   0.0024781227111816406 -  0.002481222152709961
====================
[2023-09-07 06:31:55,103][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │    0.2552667260169983     │
│         val/loss          │      11068.998046875      │
│       val/loss_best       │      11068.998046875      │
└───────────────────────────┴───────────────────────────┘
[2023-09-07 06:31:55,115][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
[2023-09-07 06:31:55,154][matplotlib.legend][WARNING] - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
[2023-09-07 06:31:55,179][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/ac/outputs/multi_run/17-43-45/3/fig
[2023-09-07 06:31:55,776][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/ac/outputs/multi_run/17-43-45/3
[2023-09-07 06:31:55,776][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.2552667260169983>
Traceback (most recent call last):
  File "/home/reza/tmp/pinns-torch/examples/ac/train.py", line 63, in <module>
    main()
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/utils.py", line 393, in _run_hydra
    run_mode = hydra.get_mode(config_name=config_name, overrides=overrides)
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/hydra.py", line 87, in get_mode
    cfg = self.compose_config(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/hydra.py", line 594, in compose_config
    cfg = self.config_loader.load_configuration(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/config_loader_impl.py", line 142, in load_configuration
    return self._load_configuration_impl(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/config_loader_impl.py", line 253, in _load_configuration_impl
    defaults_list = create_defaults_list(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/defaults_list.py", line 745, in create_defaults_list
    defaults, tree = _create_defaults_list(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/defaults_list.py", line 715, in _create_defaults_list
    defaults_tree = _create_defaults_tree(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/defaults_list.py", line 356, in _create_defaults_tree
    ret = _create_defaults_tree_impl(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/defaults_list.py", line 457, in _create_defaults_tree_impl
    return _expand_virtual_root(repo, root, overrides, skip_missing)
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/defaults_list.py", line 280, in _expand_virtual_root
    subtree = _create_defaults_tree_impl(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/defaults_list.py", line 573, in _create_defaults_tree_impl
    add_child(children, new_root)
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/defaults_list.py", line 520, in add_child
    subtree_ = _create_defaults_tree_impl(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/defaults_list.py", line 568, in _create_defaults_tree_impl
    if d.is_interpolation():
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/core/default_element.py", line 537, in is_interpolation
    node = AnyNode(name)
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/omegaconf/nodes.py", line 135, in __init__
    super().__init__(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/omegaconf/nodes.py", line 29, in __init__
    self._set_value(value)  # lgtm [py/init-calls-subclass]
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/omegaconf/nodes.py", line 46, in _set_value
    self._val = self.validate_and_convert(value)
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/omegaconf/nodes.py", line 72, in validate_and_convert
    if self._get_flag("convert") is False:
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/omegaconf/base.py", line 196, in _get_flag
    ret = self._get_flag_no_cache(flag)
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/omegaconf/base.py", line 201, in _get_flag_no_cache
    def _get_flag_no_cache(self, flag: str) -> Optional[bool]:
KeyboardInterrupt
Ambiguous value for argument 'model.amp=false,true'
1. To use it as a list, use key=[value1,value2]
2. To use it as string, quote the value: key=\'value1,value2\'
3. To sweep over it, add --multirun to your command line

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Ambiguous value for argument 'model.amp=false,true'
1. To use it as a list, use key=[value1,value2]
2. To use it as string, quote the value: key=\'value1,value2\'
3. To sweep over it, add --multirun to your command line

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Ambiguous value for argument 'model.amp=false,true'
1. To use it as a list, use key=[value1,value2]
2. To use it as string, quote the value: key=\'value1,value2\'
3. To sweep over it, add --multirun to your command line

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
[2023-09-11 05:22:58,525][HYDRA] Launching 4 jobs locally
[2023-09-11 05:22:58,525][HYDRA] 	#0 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=False model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 05:22:58,658][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 05:22:58,661][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous
│       min_epochs: 1                                                           
│       max_epochs: 10000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 10001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_forwa
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_continuous_forward                                              
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 1                                                                     
│       output_names:                                                           
│       - u                                                                     
│                                                                               
├── N0
│   └── 50                                                                      
├── N_b
│   └── 50                                                                      
├── N_f
│   └── 10000                                                                   
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_continuous_forward              
        _partial_: true                                                         
                                                                                
[2023-09-11 05:22:58,699][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-11 05:22:58,699][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-11 05:22:58,699][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-11 05:22:58,700][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 05:22:58,701][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 05:22:58,702][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 05:22:58,704][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 05:22:58,706][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:22:58,710][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.InitialCondition>
[2023-09-11 05:22:58,711][pinnstorch.train][INFO] - Instantiating training dataset number 3: <pinnstorch.data.DirichletBoundaryCondition>
[2023-09-11 05:22:58,712][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:22:58,713][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 05:22:58,718][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 05:22:58,841][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 05:22:58,870][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 05:22:58,871][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 05:22:58,871][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 05:22:58,871][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 05:22:58,871][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 05:22:58,929][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:378: UserWarning: You have overridden `transfer_batch_to_device` in `LightningModule` but have passed in a `LightningDataModule`. It will use the implementation from `LightningModule` instance.
  warning_cache.warn(
=======
[2023-09-11 05:22:59,201][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-11 05:22:59,201][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.0783390998840332
[2023-09-11 05:22:59,450][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.3079202175140381, - MEAN = 0.027992747046730736
[2023-09-11 05:23:01,417][pinnstorch.models.pinn_module][INFO] - step 81: 0.026189088821411133
[2023-09-11 05:23:11,343][HYDRA] Launching 4 jobs locally
[2023-09-11 05:23:11,343][HYDRA] 	#0 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=False model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 05:23:11,480][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 05:23:11,484][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous
│       min_epochs: 1                                                           
│       max_epochs: 20000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 20001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_inver
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_continuous_inverse                                              
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 1                                                                     
│       output_names:                                                           
│       - u                                                                     
│                                                                               
├── N_u
│   └── 2000                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_continuous_inverse              
        _partial_: true                                                         
                                                                                
[2023-09-11 05:23:11,522][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-11 05:23:11,522][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-11 05:23:11,522][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-11 05:23:11,523][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 05:23:11,524][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 05:23:11,525][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 05:23:11,527][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 05:23:11,529][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:23:11,533][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:23:11,534][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 05:23:11,559][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 05:23:11,702][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 05:23:11,732][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 05:23:11,733][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 05:23:11,733][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 05:23:11,733][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 05:23:11,733][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 05:23:11,779][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:378: UserWarning: You have overridden `transfer_batch_to_device` in `LightningModule` but have passed in a `LightningDataModule`. It will use the implementation from `LightningModule` instance.
  warning_cache.warn(
=======
[2023-09-11 05:23:12,085][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-11 05:23:12,085][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.07052445411682129
[2023-09-11 05:23:12,282][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.238037109375, - MEAN = 0.021639737215909092
[2023-09-11 05:23:13,856][pinnstorch.models.pinn_module][INFO] - step 81: 0.018998384475708008
LexerNoViableAltException: —multirun
                           ^
See https://hydra.cc/docs/1.2/advanced/override_grammar/basic for details

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
[2023-09-11 05:26:12,628][HYDRA] Launching 4 jobs locally
[2023-09-11 05:26:12,628][HYDRA] 	#0 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=False model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 05:26:12,770][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 05:26:12,774][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       runge_kutta:                                                            
│         _target_: pinnstorch.models.RungeKutta                                
│         root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                 
│         q: 500                                                                
│         t1: 10                                                                
│         t2: 90                                                                
│         time_domain:                                                          
│           _target_: pinnstorch.data.TimeDomain                                
│           t_interval:                                                         
│           - 0                                                                 
│           - 0.99                                                              
│           t_points: 100                                                       
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_f
│       min_epochs: 1                                                           
│       max_epochs: 10000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 10001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_forward
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_discrete_forward                                                
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 1                                                                     
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       - 501                                                                   
│       output_names:                                                           
│       - u                                                                     
│       discrete: true                                                          
│                                                                               
├── q
│   └── 500                                                                     
├── N
│   └── 250                                                                     
├── idx_t0
│   └── 10                                                                      
├── idx_t1
│   └── 90                                                                      
├── discrete
│   └── True                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── runge_kutta
│   └── _target_: pinnstorch.models.RungeKutta                                  
│       root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                   
│       q: 500                                                                  
│       t1: 10                                                                  
│       t2: 90                                                                  
│       time_domain:                                                            
│         _target_: pinnstorch.data.TimeDomain                                  
│         t_interval:                                                           
│         - 0                                                                   
│         - 0.99                                                                
│         t_points: 100                                                         
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_discrete_forward                
        _partial_: true                                                         
                                                                                
[2023-09-11 05:26:12,824][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-11 05:26:12,825][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-11 05:26:12,825][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-11 05:26:12,826][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 05:26:12,827][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 05:26:12,827][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 05:26:12,829][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 05:26:12,831][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-11 05:26:12,833][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.DirichletBoundaryCondition>
[2023-09-11 05:26:12,834][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-11 05:26:12,836][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 05:26:12,856][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 05:26:12,969][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 05:26:13,000][pinnstorch.utils.utils][INFO] - Weights are available.
[2023-09-11 05:26:13,073][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 05:26:13,073][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 05:26:13,073][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 05:26:13,073][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 05:26:13,073][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 05:26:13,116][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:378: UserWarning: You have overridden `transfer_batch_to_device` in `LightningModule` but have passed in a `LightningDataModule`. It will use the implementation from `LightningModule` instance.
  warning_cache.warn(
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/utilities/data.py:76: UserWarning: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 256. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
  warning_cache.warn(
torch.Size([256, 1]) torch.Size([256, 1])
=======
[2023-09-11 05:26:13,400][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-11 05:26:13,400][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.057151079177856445
[2023-09-11 05:26:13,564][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.20352935791015625, - MEAN = 0.018502668900923294
[2023-09-11 05:26:14,802][pinnstorch.models.pinn_module][INFO] - step 81: 0.0160367488861084
`Trainer.fit` stopped: `max_epochs=10000` reached.
[2023-09-11 05:27:24,339][pinnstorch.train][INFO] - Elapsed time: 265.40939474105835
[2023-09-11 05:27:24,340][pinnstorch.train][INFO] - MEAN time: 0.023272991180419922  -   0.024536490440368652 -  0.024927258491516113
[2023-09-11 05:27:24,340][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │   0.036807574331760406    │
│         val/loss          │   0.0005113149527460337   │
│       val/loss_best       │   0.0005113149527460337   │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 05:27:24,359][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[2023-09-11 05:27:24,449][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_continuous_forward/outputs/multi_run/05-22-58/0/fig
[2023-09-11 05:27:25,575][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_forward/outputs/multi_run/05-22-58/0
[2023-09-11 05:27:25,575][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.036807574331760406>
[2023-09-11 05:27:25,576][HYDRA] 	#1 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=True model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 05:27:25,719][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 05:27:25,720][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous
│       min_epochs: 1                                                           
│       max_epochs: 10000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 10001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_forwa
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_continuous_forward                                              
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 1                                                                     
│       output_names:                                                           
│       - u                                                                     
│                                                                               
├── N0
│   └── 50                                                                      
├── N_b
│   └── 50                                                                      
├── N_f
│   └── 10000                                                                   
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_continuous_forward              
        _partial_: true                                                         
                                                                                
[2023-09-11 05:27:25,755][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-11 05:27:25,755][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-11 05:27:25,755][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-11 05:27:25,756][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 05:27:25,756][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 05:27:25,757][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 05:27:25,759][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 05:27:25,761][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:27:25,765][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.InitialCondition>
[2023-09-11 05:27:25,766][pinnstorch.train][INFO] - Instantiating training dataset number 3: <pinnstorch.data.DirichletBoundaryCondition>
[2023-09-11 05:27:25,767][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:27:25,768][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 05:27:25,770][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 05:27:25,773][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 05:27:25,776][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 05:27:25,776][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 05:27:25,776][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 05:27:25,776][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 05:27:25,776][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 05:27:25,786][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Capture Time 0.3279094696044922
=======
[2023-09-11 05:27:26,126][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-11 05:27:26,126][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.3306303024291992
[2023-09-11 05:27:26,175][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.37304186820983887, - MEAN = 0.03391289710998535
[2023-09-11 05:27:57,282][HYDRA] Launching 4 jobs locally
[2023-09-11 05:27:57,282][HYDRA] 	#0 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=False model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 05:27:57,416][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 05:27:57,420][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous
│       min_epochs: 1                                                           
│       max_epochs: 10000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 10001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_forwa
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_continuous_forward                                              
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 1                                                                     
│       output_names:                                                           
│       - u                                                                     
│                                                                               
├── N0
│   └── 50                                                                      
├── N_b
│   └── 50                                                                      
├── N_f
│   └── 10000                                                                   
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_continuous_forward              
        _partial_: true                                                         
                                                                                
[2023-09-11 05:27:57,457][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-11 05:27:57,457][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-11 05:27:57,457][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-11 05:27:57,458][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 05:27:57,459][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 05:27:57,460][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 05:27:57,462][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 05:27:57,464][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:27:57,468][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.InitialCondition>
[2023-09-11 05:27:57,469][pinnstorch.train][INFO] - Instantiating training dataset number 3: <pinnstorch.data.DirichletBoundaryCondition>
[2023-09-11 05:27:57,470][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:27:57,471][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 05:27:57,476][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 05:27:57,598][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 05:27:57,628][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 05:27:57,628][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 05:27:57,628][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 05:27:57,628][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 05:27:57,628][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 05:27:57,680][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:378: UserWarning: You have overridden `transfer_batch_to_device` in `LightningModule` but have passed in a `LightningDataModule`. It will use the implementation from `LightningModule` instance.
  warning_cache.warn(
=======
[2023-09-11 05:27:57,931][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-11 05:27:57,931][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.06236433982849121
[2023-09-11 05:27:58,164][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.2765324115753174, - MEAN = 0.02513931014321067
[2023-09-11 05:28:00,071][pinnstorch.models.pinn_module][INFO] - step 81: 0.02549147605895996
[2023-09-11 05:28:09,762][HYDRA] Launching 4 jobs locally
[2023-09-11 05:28:09,762][HYDRA] 	#0 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=False model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 05:28:09,899][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 05:28:09,902][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous
│       min_epochs: 1                                                           
│       max_epochs: 20000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 20001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_inver
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_continuous_inverse                                              
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 1                                                                     
│       output_names:                                                           
│       - u                                                                     
│                                                                               
├── N_u
│   └── 2000                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_continuous_inverse              
        _partial_: true                                                         
                                                                                
[2023-09-11 05:28:09,940][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-11 05:28:09,940][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-11 05:28:09,941][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-11 05:28:09,942][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 05:28:09,942][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 05:28:09,943][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 05:28:09,945][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 05:28:09,947][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:28:09,951][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:28:09,952][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 05:28:09,975][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 05:28:10,109][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 05:28:10,143][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 05:28:10,144][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 05:28:10,144][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 05:28:10,144][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 05:28:10,144][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 05:28:10,198][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:378: UserWarning: You have overridden `transfer_batch_to_device` in `LightningModule` but have passed in a `LightningDataModule`. It will use the implementation from `LightningModule` instance.
  warning_cache.warn(
=======
[2023-09-11 05:28:10,486][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-11 05:28:10,486][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.06888842582702637
[2023-09-11 05:28:10,693][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.24425315856933594, - MEAN = 0.022204832597212357
[2023-09-11 05:28:12,299][pinnstorch.models.pinn_module][INFO] - step 81: 0.020674705505371094
[2023-09-11 05:28:18,943][HYDRA] Launching 4 jobs locally
[2023-09-11 05:28:18,943][HYDRA] 	#0 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=False model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 05:28:19,085][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 05:28:19,089][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       runge_kutta:                                                            
│         _target_: pinnstorch.models.RungeKutta                                
│         root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                 
│         q: 500                                                                
│         t1: 10                                                                
│         t2: 90                                                                
│         time_domain:                                                          
│           _target_: pinnstorch.data.TimeDomain                                
│           t_interval:                                                         
│           - 0                                                                 
│           - 0.99                                                              
│           t_points: 100                                                       
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_f
│       min_epochs: 1                                                           
│       max_epochs: 10000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 10001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_forward
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_discrete_forward                                                
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 1                                                                     
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       - 501                                                                   
│       output_names:                                                           
│       - u                                                                     
│       discrete: true                                                          
│                                                                               
├── q
│   └── 500                                                                     
├── N
│   └── 250                                                                     
├── idx_t0
│   └── 10                                                                      
├── idx_t1
│   └── 90                                                                      
├── discrete
│   └── True                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── runge_kutta
│   └── _target_: pinnstorch.models.RungeKutta                                  
│       root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                   
│       q: 500                                                                  
│       t1: 10                                                                  
│       t2: 90                                                                  
│       time_domain:                                                            
│         _target_: pinnstorch.data.TimeDomain                                  
│         t_interval:                                                           
│         - 0                                                                   
│         - 0.99                                                                
│         t_points: 100                                                         
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_discrete_forward                
        _partial_: true                                                         
                                                                                
[2023-09-11 05:28:19,139][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-11 05:28:19,139][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-11 05:28:19,139][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-11 05:28:19,140][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 05:28:19,141][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 05:28:19,142][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 05:28:19,144][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 05:28:19,146][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-11 05:28:19,148][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.DirichletBoundaryCondition>
[2023-09-11 05:28:19,149][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-11 05:28:19,151][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 05:28:19,173][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 05:28:19,284][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 05:28:19,317][pinnstorch.utils.utils][INFO] - Weights are available.
[2023-09-11 05:28:19,404][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 05:28:19,405][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 05:28:19,405][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 05:28:19,405][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 05:28:19,405][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 05:28:19,454][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:378: UserWarning: You have overridden `transfer_batch_to_device` in `LightningModule` but have passed in a `LightningDataModule`. It will use the implementation from `LightningModule` instance.
  warning_cache.warn(
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/utilities/data.py:76: UserWarning: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 256. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
  warning_cache.warn(
torch.Size([256, 1]) torch.Size([256, 1])
=======
[2023-09-11 05:28:19,758][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-11 05:28:19,758][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.056231021881103516
[2023-09-11 05:28:19,907][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.18762660026550293, - MEAN = 0.017056963660500267
[2023-09-11 05:28:21,172][pinnstorch.models.pinn_module][INFO] - step 81: 0.016236305236816406
`Trainer.fit` stopped: `max_epochs=10000` reached.
[2023-09-11 05:31:18,495][pinnstorch.train][INFO] - Elapsed time: 179.0406632423401
[2023-09-11 05:31:18,496][pinnstorch.train][INFO] - MEAN time: 0.013181209564208984  -   0.015292048454284668 -  0.01614093780517578
[2023-09-11 05:31:18,497][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
torch.Size([256, 1]) torch.Size([256, 1])
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │    0.01003124937415123    │
│         val/loss          │        6921.578125        │
│       val/loss_best       │        6921.578125        │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 05:31:18,515][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
torch.Size([256, 1]) torch.Size([256, 1])
[2023-09-11 05:31:18,570][matplotlib.legend][WARNING] - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
[2023-09-11 05:31:18,599][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_discrete_forward/outputs/multi_run/05-28-18/0/fig
[2023-09-11 05:31:19,520][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_forward/outputs/multi_run/05-28-18/0
[2023-09-11 05:31:19,520][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.01003124937415123>
[2023-09-11 05:31:19,521][HYDRA] 	#1 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=True model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 05:31:19,667][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 05:31:19,668][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       runge_kutta:                                                            
│         _target_: pinnstorch.models.RungeKutta                                
│         root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                 
│         q: 500                                                                
│         t1: 10                                                                
│         t2: 90                                                                
│         time_domain:                                                          
│           _target_: pinnstorch.data.TimeDomain                                
│           t_interval:                                                         
│           - 0                                                                 
│           - 0.99                                                              
│           t_points: 100                                                       
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_f
│       min_epochs: 1                                                           
│       max_epochs: 10000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 10001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_forward
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_discrete_forward                                                
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 1                                                                     
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       - 501                                                                   
│       output_names:                                                           
│       - u                                                                     
│       discrete: true                                                          
│                                                                               
├── q
│   └── 500                                                                     
├── N
│   └── 250                                                                     
├── idx_t0
│   └── 10                                                                      
├── idx_t1
│   └── 90                                                                      
├── discrete
│   └── True                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── runge_kutta
│   └── _target_: pinnstorch.models.RungeKutta                                  
│       root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                   
│       q: 500                                                                  
│       t1: 10                                                                  
│       t2: 90                                                                  
│       time_domain:                                                            
│         _target_: pinnstorch.data.TimeDomain                                  
│         t_interval:                                                           
│         - 0                                                                   
│         - 0.99                                                                
│         t_points: 100                                                         
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_discrete_forward                
        _partial_: true                                                         
                                                                                
[2023-09-11 05:31:19,713][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-11 05:31:19,713][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-11 05:31:19,713][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-11 05:31:19,713][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 05:31:19,714][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 05:31:19,715][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 05:31:19,717][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 05:31:19,718][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-11 05:31:19,720][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.DirichletBoundaryCondition>
[2023-09-11 05:31:19,721][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-11 05:31:19,722][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 05:31:19,725][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 05:31:19,727][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 05:31:19,731][pinnstorch.utils.utils][INFO] - Weights are available.
[2023-09-11 05:31:19,800][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 05:31:19,800][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 05:31:19,800][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 05:31:19,800][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 05:31:19,800][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 05:31:19,808][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
torch.Size([256, 1]) torch.Size([256, 1])
Capture Time 0.2977602481842041
=======
[2023-09-11 05:31:20,117][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-11 05:31:20,117][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.29973816871643066
[2023-09-11 05:31:20,142][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.318967342376709, - MEAN = 0.02899703112515536
`Trainer.fit` stopped: `max_epochs=10000` reached.
[2023-09-11 05:31:41,011][pinnstorch.train][INFO] - Elapsed time: 21.20221734046936
[2023-09-11 05:31:41,012][pinnstorch.train][INFO] - MEAN time: 0.0016086101531982422  -   0.0016100406646728516 -  0.001605987548828125
[2023-09-11 05:31:41,012][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
torch.Size([256, 1]) torch.Size([256, 1])
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │   0.009381608106195927    │
│         val/loss          │      6949.583984375       │
│       val/loss_best       │      6949.583984375       │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 05:31:41,025][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
torch.Size([256, 1]) torch.Size([256, 1])
[2023-09-11 05:31:41,067][matplotlib.legend][WARNING] - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
[2023-09-11 05:31:41,092][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_discrete_forward/outputs/multi_run/05-28-18/1/fig
[2023-09-11 05:31:41,756][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_forward/outputs/multi_run/05-28-18/1
[2023-09-11 05:31:41,757][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.009381608106195927>
[2023-09-11 05:31:41,758][HYDRA] 	#2 : trainer.devices=[0] callbacks=null logger=null model.amp=True model.cudagraph_compile=False model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 05:31:41,907][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 05:31:41,909][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       runge_kutta:                                                            
│         _target_: pinnstorch.models.RungeKutta                                
│         root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                 
│         q: 500                                                                
│         t1: 10                                                                
│         t2: 90                                                                
│         time_domain:                                                          
│           _target_: pinnstorch.data.TimeDomain                                
│           t_interval:                                                         
│           - 0                                                                 
│           - 0.99                                                              
│           t_points: 100                                                       
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_f
│       min_epochs: 1                                                           
│       max_epochs: 10000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 10001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_forward
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_discrete_forward                                                
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 1                                                                     
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       - 501                                                                   
│       output_names:                                                           
│       - u                                                                     
│       discrete: true                                                          
│                                                                               
├── q
│   └── 500                                                                     
├── N
│   └── 250                                                                     
├── idx_t0
│   └── 10                                                                      
├── idx_t1
│   └── 90                                                                      
├── discrete
│   └── True                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── runge_kutta
│   └── _target_: pinnstorch.models.RungeKutta                                  
│       root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                   
│       q: 500                                                                  
│       t1: 10                                                                  
│       t2: 90                                                                  
│       time_domain:                                                            
│         _target_: pinnstorch.data.TimeDomain                                  
│         t_interval:                                                           
│         - 0                                                                   
│         - 0.99                                                                
│         t_points: 100                                                         
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_discrete_forward                
        _partial_: true                                                         
                                                                                
[2023-09-11 05:31:41,955][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-11 05:31:41,955][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-11 05:31:41,955][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-11 05:31:41,956][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 05:31:41,957][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 05:31:41,958][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 05:31:41,960][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 05:31:41,962][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-11 05:31:41,963][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.DirichletBoundaryCondition>
[2023-09-11 05:31:41,964][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-11 05:31:41,966][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 05:31:41,968][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 05:31:41,971][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 05:31:41,975][pinnstorch.utils.utils][INFO] - Weights are available.
[2023-09-11 05:31:42,046][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 05:31:42,046][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 05:31:42,046][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 05:31:42,046][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 05:31:42,046][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 05:31:42,055][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
torch.Size([256, 1]) torch.Size([256, 1])
=======
[2023-09-11 05:31:42,142][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-11 05:31:42,143][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-11 05:31:42,143][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.05313396453857422
[2023-09-11 05:31:42,336][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.2257068157196045, - MEAN = 0.020518801429054954
[2023-09-11 05:31:43,736][pinnstorch.models.pinn_module][INFO] - step 81: 0.01821160316467285
`Trainer.fit` stopped: `max_epochs=10000` reached.
[2023-09-11 05:32:22,792][pinnstorch.train][INFO] - Elapsed time: 265.1123607158661
[2023-09-11 05:32:22,794][pinnstorch.train][INFO] - MEAN time: 0.024163007736206055  -   0.024906158447265625 -  0.024814486503601074
[2023-09-11 05:32:22,794][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │   0.036807574331760406    │
│         val/loss          │   0.0005113149527460337   │
│       val/loss_best       │   0.0005113149527460337   │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 05:32:22,814][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[2023-09-11 05:32:22,908][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_continuous_forward/outputs/multi_run/05-27-56/0/fig
[2023-09-11 05:32:24,095][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_forward/outputs/multi_run/05-27-56/0
[2023-09-11 05:32:24,096][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.036807574331760406>
[2023-09-11 05:32:24,097][HYDRA] 	#1 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=True model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 05:32:24,248][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 05:32:24,249][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous
│       min_epochs: 1                                                           
│       max_epochs: 10000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 10001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_forwa
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_continuous_forward                                              
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 1                                                                     
│       output_names:                                                           
│       - u                                                                     
│                                                                               
├── N0
│   └── 50                                                                      
├── N_b
│   └── 50                                                                      
├── N_f
│   └── 10000                                                                   
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_continuous_forward              
        _partial_: true                                                         
                                                                                
[2023-09-11 05:32:24,286][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-11 05:32:24,286][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-11 05:32:24,286][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-11 05:32:24,287][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 05:32:24,288][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 05:32:24,289][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 05:32:24,291][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 05:32:24,292][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:32:24,296][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.InitialCondition>
[2023-09-11 05:32:24,297][pinnstorch.train][INFO] - Instantiating training dataset number 3: <pinnstorch.data.DirichletBoundaryCondition>
[2023-09-11 05:32:24,298][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:32:24,299][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 05:32:24,302][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 05:32:24,305][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 05:32:24,308][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 05:32:24,308][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 05:32:24,308][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 05:32:24,308][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 05:32:24,308][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 05:32:24,316][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Capture Time 0.3389241695404053
=======
[2023-09-11 05:32:24,669][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-11 05:32:24,669][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.3419013023376465
[2023-09-11 05:32:24,719][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.3846282958984375, - MEAN = 0.03496620871803977
`Trainer.fit` stopped: `max_epochs=10000` reached.
[2023-09-11 05:33:05,364][pinnstorch.train][INFO] - Elapsed time: 41.04739809036255
[2023-09-11 05:33:05,365][pinnstorch.train][INFO] - MEAN time: 0.003565549850463867  -   0.0035734176635742188 -  0.003570556640625
[2023-09-11 05:33:05,365][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │    0.03774760290980339    │
│         val/loss          │   0.0005377654451876879   │
│       val/loss_best       │   0.0005377654451876879   │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 05:33:05,378][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[2023-09-11 05:33:05,462][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_continuous_forward/outputs/multi_run/05-27-56/1/fig
[2023-09-11 05:33:06,375][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_forward/outputs/multi_run/05-27-56/1
[2023-09-11 05:33:06,375][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.03774760290980339>
[2023-09-11 05:33:06,376][HYDRA] 	#2 : trainer.devices=[0] callbacks=null logger=null model.amp=True model.cudagraph_compile=False model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 05:33:06,528][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 05:33:06,529][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous
│       min_epochs: 1                                                           
│       max_epochs: 10000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 10001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_forwa
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_continuous_forward                                              
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 1                                                                     
│       output_names:                                                           
│       - u                                                                     
│                                                                               
├── N0
│   └── 50                                                                      
├── N_b
│   └── 50                                                                      
├── N_f
│   └── 10000                                                                   
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_continuous_forward              
        _partial_: true                                                         
                                                                                
[2023-09-11 05:33:06,567][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-11 05:33:06,567][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-11 05:33:06,567][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-11 05:33:06,567][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 05:33:06,568][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 05:33:06,569][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 05:33:06,571][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 05:33:06,573][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:33:06,577][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.InitialCondition>
[2023-09-11 05:33:06,578][pinnstorch.train][INFO] - Instantiating training dataset number 3: <pinnstorch.data.DirichletBoundaryCondition>
[2023-09-11 05:33:06,579][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:33:06,580][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 05:33:06,583][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 05:33:06,586][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 05:33:06,588][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 05:33:06,588][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 05:33:06,588][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 05:33:06,589][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 05:33:06,589][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 05:33:06,597][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
=======
[2023-09-11 05:33:06,671][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-11 05:33:06,672][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-11 05:33:06,672][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.03241252899169922
[2023-09-11 05:33:06,920][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.2599601745605469, - MEAN = 0.023632743141867897
[2023-09-11 05:33:08,970][pinnstorch.models.pinn_module][INFO] - step 81: 0.02634906768798828
`Trainer.fit` stopped: `max_epochs=10000` reached.
[2023-09-11 05:34:54,155][pinnstorch.train][INFO] - Elapsed time: 192.1004102230072
[2023-09-11 05:34:54,157][pinnstorch.train][INFO] - MEAN time: 0.01803445816040039  -   0.01811230182647705 -  0.017728805541992188
[2023-09-11 05:34:54,157][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
torch.Size([256, 1]) torch.Size([256, 1])
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │   0.008467249572277069    │
│         val/loss          │       7015.85546875       │
│       val/loss_best       │       7015.85546875       │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 05:34:54,181][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
torch.Size([256, 1]) torch.Size([256, 1])
[2023-09-11 05:34:54,232][matplotlib.legend][WARNING] - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
[2023-09-11 05:34:54,257][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_discrete_forward/outputs/multi_run/05-28-18/2/fig
[2023-09-11 05:34:54,888][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_forward/outputs/multi_run/05-28-18/2
[2023-09-11 05:34:54,888][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.008467249572277069>
[2023-09-11 05:34:54,889][HYDRA] 	#3 : trainer.devices=[0] callbacks=null logger=null model.amp=True model.cudagraph_compile=True model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 05:34:55,033][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 05:34:55,034][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       runge_kutta:                                                            
│         _target_: pinnstorch.models.RungeKutta                                
│         root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                 
│         q: 500                                                                
│         t1: 10                                                                
│         t2: 90                                                                
│         time_domain:                                                          
│           _target_: pinnstorch.data.TimeDomain                                
│           t_interval:                                                         
│           - 0                                                                 
│           - 0.99                                                              
│           t_points: 100                                                       
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_f
│       min_epochs: 1                                                           
│       max_epochs: 10000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 10001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_forward
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_discrete_forward                                                
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 1                                                                     
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       - 501                                                                   
│       output_names:                                                           
│       - u                                                                     
│       discrete: true                                                          
│                                                                               
├── q
│   └── 500                                                                     
├── N
│   └── 250                                                                     
├── idx_t0
│   └── 10                                                                      
├── idx_t1
│   └── 90                                                                      
├── discrete
│   └── True                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── runge_kutta
│   └── _target_: pinnstorch.models.RungeKutta                                  
│       root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                   
│       q: 500                                                                  
│       t1: 10                                                                  
│       t2: 90                                                                  
│       time_domain:                                                            
│         _target_: pinnstorch.data.TimeDomain                                  
│         t_interval:                                                           
│         - 0                                                                   
│         - 0.99                                                                
│         t_points: 100                                                         
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_discrete_forward                
        _partial_: true                                                         
                                                                                
[2023-09-11 05:34:55,079][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-11 05:34:55,079][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-11 05:34:55,079][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-11 05:34:55,079][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 05:34:55,080][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 05:34:55,081][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 05:34:55,083][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 05:34:55,085][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-11 05:34:55,086][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.DirichletBoundaryCondition>
[2023-09-11 05:34:55,087][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-11 05:34:55,089][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 05:34:55,091][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 05:34:55,093][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 05:34:55,097][pinnstorch.utils.utils][INFO] - Weights are available.
[2023-09-11 05:34:55,165][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 05:34:55,166][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 05:34:55,166][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 05:34:55,166][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 05:34:55,166][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 05:34:55,173][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
torch.Size([256, 1]) torch.Size([256, 1])
Capture Time 0.32935142517089844
=======
[2023-09-11 05:34:55,514][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-11 05:34:55,515][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-11 05:34:55,515][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.3331642150878906
[2023-09-11 05:34:55,548][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.3592391014099121, - MEAN = 0.03265810012817383
[2023-09-11 05:34:55,722][pinnstorch.models.pinn_module][INFO] - step 81: 0.002473115921020508
`Trainer.fit` stopped: `max_epochs=10000` reached.
[2023-09-11 05:35:21,672][pinnstorch.train][INFO] - Elapsed time: 26.498717546463013
[2023-09-11 05:35:21,673][pinnstorch.train][INFO] - MEAN time: 0.0021588802337646484  -   0.0021648406982421875 -  0.002151012420654297
[2023-09-11 05:35:21,673][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
torch.Size([256, 1]) torch.Size([256, 1])
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │   0.016357000917196274    │
│         val/loss          │     6992.93896484375      │
│       val/loss_best       │     6992.93896484375      │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 05:35:21,685][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
torch.Size([256, 1]) torch.Size([256, 1])
[2023-09-11 05:35:21,726][matplotlib.legend][WARNING] - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
[2023-09-11 05:35:21,751][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_discrete_forward/outputs/multi_run/05-28-18/3/fig
[2023-09-11 05:35:22,380][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_forward/outputs/multi_run/05-28-18/3
[2023-09-11 05:35:22,381][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.016357000917196274>
`Trainer.fit` stopped: `max_epochs=20000` reached.
[2023-09-11 05:35:36,390][pinnstorch.train][INFO] - Elapsed time: 446.1921486854553
[2023-09-11 05:35:36,392][pinnstorch.train][INFO] - MEAN time: 0.019730806350708008  -   0.01975393295288086 -  0.01921212673187256
[2023-09-11 05:35:36,393][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │   0.016971983015537262    │
│         val/loss          │  0.00010871244012378156   │
│       val/loss_best       │  0.00010871244012378156   │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 05:35:36,414][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
[2023-09-11 05:35:36,425][pinnstorch.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/reza/tmp/pinns-torch/pinnstorch/utils/utils.py", line 73, in wrap
    metric_dict, object_dict = task_func(
  File "/home/reza/tmp/pinns-torch/pinnstorch/train.py", line 179, in train
    hydra.utils.instantiate(
TypeError: plot_burgers_continuous_inverse() got an unexpected keyword argument 'val_dataset'
[2023-09-11 05:35:36,426][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_inverse/outputs/multi_run/05-28-09/0
[2023-09-11 05:35:36,427][HYDRA] 	#1 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=True model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 05:35:36,566][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 05:35:36,567][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous
│       min_epochs: 1                                                           
│       max_epochs: 20000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 20001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_inver
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_continuous_inverse                                              
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 1                                                                     
│       output_names:                                                           
│       - u                                                                     
│                                                                               
├── N_u
│   └── 2000                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_continuous_inverse              
        _partial_: true                                                         
                                                                                
[2023-09-11 05:35:36,601][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-11 05:35:36,601][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-11 05:35:36,601][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-11 05:35:36,601][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 05:35:36,602][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 05:35:36,603][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 05:35:36,604][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 05:35:36,606][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:35:36,609][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:35:36,610][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 05:35:36,613][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 05:35:36,615][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 05:35:36,618][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 05:35:36,618][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 05:35:36,618][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 05:35:36,619][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 05:35:36,619][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 05:35:36,627][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
Capture Time 0.31023073196411133
=======
[2023-09-11 05:35:36,948][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-11 05:35:36,948][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.31224775314331055
[2023-09-11 05:35:36,989][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.3407249450683594, - MEAN = 0.03097499500621449
`Trainer.fit` stopped: `max_epochs=20000` reached.
[2023-09-11 05:36:42,820][pinnstorch.train][INFO] - Elapsed time: 66.19316124916077
[2023-09-11 05:36:42,821][pinnstorch.train][INFO] - MEAN time: 0.002354860305786133  -   0.0023540258407592773 -  0.002353191375732422
[2023-09-11 05:36:42,821][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │   0.017588043585419655    │
│         val/loss          │   0.0001167479349533096   │
│       val/loss_best       │   0.0001167479349533096   │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 05:36:42,834][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
[2023-09-11 05:36:42,844][pinnstorch.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/reza/tmp/pinns-torch/pinnstorch/utils/utils.py", line 73, in wrap
    metric_dict, object_dict = task_func(
  File "/home/reza/tmp/pinns-torch/pinnstorch/train.py", line 179, in train
    hydra.utils.instantiate(
TypeError: plot_burgers_continuous_inverse() got an unexpected keyword argument 'val_dataset'
[2023-09-11 05:36:42,844][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_inverse/outputs/multi_run/05-28-09/1
[2023-09-11 05:36:42,845][HYDRA] 	#2 : trainer.devices=[0] callbacks=null logger=null model.amp=True model.cudagraph_compile=False model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 05:36:42,981][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 05:36:42,983][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous
│       min_epochs: 1                                                           
│       max_epochs: 20000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 20001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_inver
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_continuous_inverse                                              
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 1                                                                     
│       output_names:                                                           
│       - u                                                                     
│                                                                               
├── N_u
│   └── 2000                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_continuous_inverse              
        _partial_: true                                                         
                                                                                
[2023-09-11 05:36:43,016][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-11 05:36:43,016][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-11 05:36:43,016][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-11 05:36:43,016][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 05:36:43,017][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 05:36:43,018][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 05:36:43,020][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 05:36:43,022][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:36:43,025][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:36:43,026][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 05:36:43,032][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 05:36:43,034][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 05:36:43,038][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 05:36:43,038][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 05:36:43,038][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 05:36:43,038][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 05:36:43,038][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 05:36:43,046][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
=======
[2023-09-11 05:36:43,121][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-11 05:36:43,121][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-11 05:36:43,121][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.03351116180419922
[2023-09-11 05:36:43,355][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.2336747646331787, - MEAN = 0.021243160421198063
[2023-09-11 05:36:45,155][pinnstorch.models.pinn_module][INFO] - step 81: 0.02169632911682129
`Trainer.fit` stopped: `max_epochs=10000` reached.
[2023-09-11 05:37:52,095][pinnstorch.train][INFO] - Elapsed time: 285.4979827404022
[2023-09-11 05:37:52,097][pinnstorch.train][INFO] - MEAN time: 0.026360750198364258  -   0.027602314949035645 -  0.02665257453918457
[2023-09-11 05:37:52,097][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │    0.05385918915271759    │
│         val/loss          │   0.0010947973933070898   │
│       val/loss_best       │   0.0010947973933070898   │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 05:37:52,226][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[2023-09-11 05:37:52,371][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_continuous_forward/outputs/multi_run/05-27-56/2/fig
[2023-09-11 05:37:53,230][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_forward/outputs/multi_run/05-27-56/2
[2023-09-11 05:37:53,230][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.05385918915271759>
[2023-09-11 05:37:53,231][HYDRA] 	#3 : trainer.devices=[0] callbacks=null logger=null model.amp=True model.cudagraph_compile=True model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 05:37:53,374][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 05:37:53,375][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous
│       min_epochs: 1                                                           
│       max_epochs: 10000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 10001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_forwa
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_continuous_forward                                              
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 1                                                                     
│       output_names:                                                           
│       - u                                                                     
│                                                                               
├── N0
│   └── 50                                                                      
├── N_b
│   └── 50                                                                      
├── N_f
│   └── 10000                                                                   
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_continuous_forward              
        _partial_: true                                                         
                                                                                
[2023-09-11 05:37:53,410][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-11 05:37:53,410][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-11 05:37:53,410][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-11 05:37:53,410][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 05:37:53,411][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 05:37:53,412][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 05:37:53,414][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 05:37:53,415][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:37:53,419][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.InitialCondition>
[2023-09-11 05:37:53,420][pinnstorch.train][INFO] - Instantiating training dataset number 3: <pinnstorch.data.DirichletBoundaryCondition>
[2023-09-11 05:37:53,421][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:37:53,422][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 05:37:53,425][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 05:37:53,427][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 05:37:53,431][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 05:37:53,431][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 05:37:53,431][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 05:37:53,431][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 05:37:53,431][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 05:37:53,439][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Capture Time 0.46228981018066406
=======
[2023-09-11 05:37:53,913][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-11 05:37:53,913][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-11 05:37:53,913][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.4645552635192871
[2023-09-11 05:37:53,964][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.5093293190002441, - MEAN = 0.04630266536365856
[2023-09-11 05:37:54,264][pinnstorch.models.pinn_module][INFO] - step 81: 0.00391387939453125
`Trainer.fit` stopped: `max_epochs=10000` reached.
[2023-09-11 05:38:38,681][pinnstorch.train][INFO] - Elapsed time: 45.24131202697754
[2023-09-11 05:38:38,681][pinnstorch.train][INFO] - MEAN time: 0.004024505615234375  -   0.003957867622375488 -  0.003958463668823242
[2023-09-11 05:38:38,682][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │    0.3165586590766907     │
│         val/loss          │    0.03782008960843086    │
│       val/loss_best       │    0.03782008960843086    │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 05:38:38,695][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[2023-09-11 05:38:38,779][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_continuous_forward/outputs/multi_run/05-27-56/3/fig
[2023-09-11 05:38:39,696][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_forward/outputs/multi_run/05-27-56/3
[2023-09-11 05:38:39,696][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.3165586590766907>
[2023-09-11 05:45:08,848][HYDRA] Launching 4 jobs locally
[2023-09-11 05:45:08,848][HYDRA] 	#0 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=False model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 05:45:08,993][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 05:45:08,997][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous
│       min_epochs: 1                                                           
│       max_epochs: 30000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 30001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_inver
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_continuous_inverse                                              
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 1                                                                     
│       output_names:                                                           
│       - u                                                                     
│                                                                               
├── N_u
│   └── 2000                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_continuous_inverse              
        _partial_: true                                                         
                                                                                
[2023-09-11 05:45:09,038][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-11 05:45:09,038][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-11 05:45:09,038][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-11 05:45:09,039][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 05:45:09,040][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 05:45:09,041][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 05:45:09,043][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 05:45:09,045][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:45:09,049][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:45:09,050][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 05:45:09,074][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 05:45:09,211][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 05:45:09,243][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 05:45:09,243][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 05:45:09,243][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 05:45:09,243][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 05:45:09,243][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 05:45:09,294][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:378: UserWarning: You have overridden `transfer_batch_to_device` in `LightningModule` but have passed in a `LightningDataModule`. It will use the implementation from `LightningModule` instance.
  warning_cache.warn(
=======
[2023-09-11 05:45:09,626][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-11 05:45:09,626][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.08145928382873535
[2023-09-11 05:45:09,826][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.25129246711730957, - MEAN = 0.022844769737937233
[2023-09-11 05:45:11,416][pinnstorch.models.pinn_module][INFO] - step 81: 0.020209074020385742
`Trainer.fit` stopped: `max_epochs=30000` reached.
[2023-09-11 05:55:58,529][pinnstorch.train][INFO] - Elapsed time: 649.2347660064697
[2023-09-11 05:55:58,534][pinnstorch.train][INFO] - MEAN time: 0.019419193267822266  -   0.019086718559265137 -  0.019048094749450684
[2023-09-11 05:55:58,534][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │   0.012277419678866863    │
│         val/loss          │   5.688899909728207e-05   │
│       val/loss_best       │   5.688899909728207e-05   │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 05:55:58,561][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
[2023-09-11 05:55:58,671][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_continuous_inverse/outputs/multi_run/05-45-08/0/fig
[2023-09-11 05:55:59,776][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_inverse/outputs/multi_run/05-45-08/0
[2023-09-11 05:55:59,776][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.012277419678866863>
[2023-09-11 05:55:59,776][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=0.9946209788322449>
[2023-09-11 05:55:59,776][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=-5.531577110290527>
[2023-09-11 05:55:59,777][HYDRA] 	#1 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=True model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 05:55:59,923][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 05:55:59,924][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous
│       min_epochs: 1                                                           
│       max_epochs: 30000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 30001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_inver
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_continuous_inverse                                              
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 1                                                                     
│       output_names:                                                           
│       - u                                                                     
│                                                                               
├── N_u
│   └── 2000                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_continuous_inverse              
        _partial_: true                                                         
                                                                                
[2023-09-11 05:55:59,960][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-11 05:55:59,960][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-11 05:55:59,960][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-11 05:55:59,960][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 05:55:59,961][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 05:55:59,962][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 05:55:59,964][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 05:55:59,966][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:55:59,969][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:55:59,970][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 05:55:59,973][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 05:55:59,976][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 05:55:59,979][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 05:55:59,979][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 05:55:59,979][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 05:55:59,979][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 05:55:59,979][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 05:55:59,989][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
Capture Time 0.2922830581665039
=======
[2023-09-11 05:56:00,294][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-11 05:56:00,294][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.29447078704833984
[2023-09-11 05:56:00,335][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.32278919219970703, - MEAN = 0.029344472018155186
`Trainer.fit` stopped: `max_epochs=30000` reached.
[2023-09-11 05:57:40,944][pinnstorch.train][INFO] - Elapsed time: 100.95511531829834
[2023-09-11 05:57:40,946][pinnstorch.train][INFO] - MEAN time: 0.0023636817932128906  -   0.0023642778396606445 -  0.0023648738861083984
[2023-09-11 05:57:40,946][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │   0.012516461312770844    │
│         val/loss          │   5.912582855671644e-05   │
│       val/loss_best       │   5.912582855671644e-05   │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 05:57:40,960][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
[2023-09-11 05:57:41,041][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_continuous_inverse/outputs/multi_run/05-45-08/1/fig
[2023-09-11 05:57:41,881][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_inverse/outputs/multi_run/05-45-08/1
[2023-09-11 05:57:41,881][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.012516461312770844>
[2023-09-11 05:57:41,881][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=0.9954750537872314>
[2023-09-11 05:57:41,881][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=-5.535577774047852>
[2023-09-11 05:57:41,882][HYDRA] 	#2 : trainer.devices=[0] callbacks=null logger=null model.amp=True model.cudagraph_compile=False model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 05:57:42,029][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 05:57:42,030][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous
│       min_epochs: 1                                                           
│       max_epochs: 30000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 30001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_inver
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_continuous_inverse                                              
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 1                                                                     
│       output_names:                                                           
│       - u                                                                     
│                                                                               
├── N_u
│   └── 2000                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_continuous_inverse              
        _partial_: true                                                         
                                                                                
[2023-09-11 05:57:42,067][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-11 05:57:42,067][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-11 05:57:42,067][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-11 05:57:42,067][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 05:57:42,068][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 05:57:42,069][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 05:57:42,071][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 05:57:42,073][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:57:42,076][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:57:42,077][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 05:57:42,080][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 05:57:42,082][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 05:57:42,086][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 05:57:42,086][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 05:57:42,086][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 05:57:42,086][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 05:57:42,086][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 05:57:42,095][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
=======
[2023-09-11 05:57:42,175][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-11 05:57:42,176][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-11 05:57:42,176][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.02661895751953125
[2023-09-11 05:57:42,357][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.177077054977417, - MEAN = 0.01609791408885609
[2023-09-11 05:57:44,078][pinnstorch.models.pinn_module][INFO] - step 81: 0.018941879272460938
[2023-09-11 05:59:42,269][HYDRA] Launching 4 jobs locally
[2023-09-11 05:59:42,269][HYDRA] 	#0 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=False model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 05:59:42,431][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 05:59:42,435][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       runge_kutta:                                                            
│         _target_: pinnstorch.models.RungeKutta                                
│         root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                 
│         q: 81                                                                 
│         t1: 10                                                                
│         t2: 90                                                                
│         time_domain:                                                          
│           _target_: pinnstorch.data.TimeDomain                                
│           t_interval:                                                         
│           - 0                                                                 
│           - 0.99                                                              
│           t_points: 100                                                       
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_i
│       min_epochs: 1                                                           
│       max_epochs: 50000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 50001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_inverse
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_discrete_inverse                                                
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 1                                                                     
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       - 81                                                                    
│       output_names:                                                           
│       - u                                                                     
│       discrete: true                                                          
│                                                                               
├── q
│   └── 81                                                                      
├── N0
│   └── 199                                                                     
├── N1
│   └── 201                                                                     
├── idx_t0
│   └── 10                                                                      
├── idx_t1
│   └── 90                                                                      
├── discrete
│   └── True                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── runge_kutta
│   └── _target_: pinnstorch.models.RungeKutta                                  
│       root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                   
│       q: 81                                                                   
│       t1: 10                                                                  
│       t2: 90                                                                  
│       time_domain:                                                            
│         _target_: pinnstorch.data.TimeDomain                                  
│         t_interval:                                                           
│         - 0                                                                   
│         - 0.99                                                                
│         t_points: 100                                                         
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_discrete_inverse                
        _partial_: true                                                         
                                                                                
[2023-09-11 05:59:42,494][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-11 05:59:42,494][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-11 05:59:42,494][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-11 05:59:42,495][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 05:59:42,496][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 05:59:42,497][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 05:59:42,500][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 05:59:42,502][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-11 05:59:42,504][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-11 05:59:42,506][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-11 05:59:42,507][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 05:59:42,529][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 05:59:42,652][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 05:59:42,685][pinnstorch.utils.utils][INFO] - Weights are available.
[2023-09-11 05:59:42,699][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 05:59:42,699][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 05:59:42,699][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 05:59:42,699][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 05:59:42,699][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 05:59:42,764][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:378: UserWarning: You have overridden `transfer_batch_to_device` in `LightningModule` but have passed in a `LightningDataModule`. It will use the implementation from `LightningModule` instance.
  warning_cache.warn(
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/utilities/data.py:76: UserWarning: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 256. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
  warning_cache.warn(
torch.Size([256, 1]) torch.Size([256, 1])
=======
[2023-09-11 05:59:43,081][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-11 05:59:43,081][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.08899855613708496
[2023-09-11 05:59:43,359][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.3305647373199463, - MEAN = 0.030051339756358753
[2023-09-11 05:59:45,382][pinnstorch.models.pinn_module][INFO] - step 81: 0.025133371353149414
[2023-09-11 06:10:01,306][HYDRA] Launching 4 jobs locally
[2023-09-11 06:10:01,306][HYDRA] 	#0 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=False model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 06:10:01,457][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 06:10:01,462][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous
│       min_epochs: 1                                                           
│       max_epochs: 40000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 40001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_inver
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_continuous_inverse                                              
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 1                                                                     
│       output_names:                                                           
│       - u                                                                     
│                                                                               
├── N_u
│   └── 2000                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_continuous_inverse              
        _partial_: true                                                         
                                                                                
[2023-09-11 06:10:01,504][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-11 06:10:01,504][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-11 06:10:01,504][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-11 06:10:01,505][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 06:10:01,506][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 06:10:01,507][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 06:10:01,509][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 06:10:01,511][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 06:10:01,515][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 06:10:01,516][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 06:10:01,538][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 06:10:01,693][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 06:10:01,725][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 06:10:01,725][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 06:10:01,725][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 06:10:01,725][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 06:10:01,725][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 06:10:01,782][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:378: UserWarning: You have overridden `transfer_batch_to_device` in `LightningModule` but have passed in a `LightningDataModule`. It will use the implementation from `LightningModule` instance.
  warning_cache.warn(
=======
[2023-09-11 06:10:02,256][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-11 06:10:02,256][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.07567095756530762
[2023-09-11 06:10:02,470][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.2563965320587158, - MEAN = 0.02330877564170144
[2023-09-11 06:10:04,060][pinnstorch.models.pinn_module][INFO] - step 81: 0.020113229751586914
`Trainer.fit` stopped: `max_epochs=30000` reached.
[2023-09-11 06:10:04,846][pinnstorch.train][INFO] - Elapsed time: 742.7516992092133
[2023-09-11 06:10:04,850][pinnstorch.train][INFO] - MEAN time: 0.021748781204223633  -   0.021519184112548828 -  0.021523237228393555
[2023-09-11 06:10:04,851][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │   0.014061551541090012    │
│         val/loss          │   7.462436042260379e-05   │
│       val/loss_best       │   7.462436042260379e-05   │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 06:10:04,878][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
[2023-09-11 06:10:04,971][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_continuous_inverse/outputs/multi_run/05-45-08/2/fig
[2023-09-11 06:10:05,839][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_inverse/outputs/multi_run/05-45-08/2
[2023-09-11 06:10:05,840][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.014061551541090012>
[2023-09-11 06:10:05,840][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=0.9916200637817383>
[2023-09-11 06:10:05,840][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=-5.510884761810303>
[2023-09-11 06:10:05,841][HYDRA] 	#3 : trainer.devices=[0] callbacks=null logger=null model.amp=True model.cudagraph_compile=True model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 06:10:05,993][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 06:10:05,995][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous
│       min_epochs: 1                                                           
│       max_epochs: 40000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 40001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_inver
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_continuous_inverse                                              
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 1                                                                     
│       output_names:                                                           
│       - u                                                                     
│                                                                               
├── N_u
│   └── 2000                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_continuous_inverse              
        _partial_: true                                                         
                                                                                
[2023-09-11 06:10:06,032][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-11 06:10:06,032][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-11 06:10:06,032][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-11 06:10:06,032][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 06:10:06,033][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 06:10:06,034][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 06:10:06,036][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 06:10:06,038][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 06:10:06,042][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 06:10:06,043][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 06:10:06,046][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 06:10:06,048][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 06:10:06,052][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 06:10:06,052][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 06:10:06,052][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 06:10:06,052][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 06:10:06,052][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 06:10:06,060][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
Capture Time 0.36096668243408203
=======
[2023-09-11 06:10:06,434][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-11 06:10:06,434][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-11 06:10:06,434][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.3647031784057617
[2023-09-11 06:10:06,492][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.40585756301879883, - MEAN = 0.03689614209261807
[2023-09-11 06:10:06,777][pinnstorch.models.pinn_module][INFO] - step 81: 0.0036613941192626953
`Trainer.fit` stopped: `max_epochs=40000` reached.
[2023-09-11 06:13:00,229][pinnstorch.train][INFO] - Elapsed time: 174.1690354347229
[2023-09-11 06:13:00,232][pinnstorch.train][INFO] - MEAN time: 0.0033130645751953125  -   0.00331878662109375 -  0.0033342838287353516
[2023-09-11 06:13:00,232][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │    0.0275723934173584     │
│         val/loss          │   0.0002869214804377407   │
│       val/loss_best       │   0.0002869214804377407   │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 06:13:00,246][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
[2023-09-11 06:13:00,326][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_continuous_inverse/outputs/multi_run/05-45-08/3/fig
[2023-09-11 06:13:01,142][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_inverse/outputs/multi_run/05-45-08/3
[2023-09-11 06:13:01,143][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.0275723934173584>
[2023-09-11 06:13:01,143][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=0.9874061942100525>
[2023-09-11 06:13:01,143][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=-5.297755718231201>
`Trainer.fit` stopped: `max_epochs=50000` reached.
[2023-09-11 06:23:40,363][pinnstorch.train][INFO] - Elapsed time: 1437.5980551242828
[2023-09-11 06:23:40,368][pinnstorch.train][INFO] - MEAN time: 0.02597332000732422  -   0.02675783634185791 -  0.025692462921142578
[2023-09-11 06:23:40,368][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
torch.Size([256, 1]) torch.Size([256, 1])
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │   0.005996885243803263    │
│         val/loss          │     1129.50634765625      │
│       val/loss_best       │     1129.50634765625      │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 06:23:40,386][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
torch.Size([256, 1]) torch.Size([256, 1])
[2023-09-11 06:23:40,475][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_discrete_inverse/outputs/multi_run/05-59-41/0/fig
[2023-09-11 06:23:41,341][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_inverse/outputs/multi_run/05-59-41/0
[2023-09-11 06:23:41,342][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.005996885243803263>
[2023-09-11 06:23:41,342][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=0.9968639016151428>
[2023-09-11 06:23:41,342][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=-5.508537769317627>
[2023-09-11 06:23:41,343][HYDRA] 	#1 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=True model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 06:23:41,484][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 06:23:41,485][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       runge_kutta:                                                            
│         _target_: pinnstorch.models.RungeKutta                                
│         root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                 
│         q: 81                                                                 
│         t1: 10                                                                
│         t2: 90                                                                
│         time_domain:                                                          
│           _target_: pinnstorch.data.TimeDomain                                
│           t_interval:                                                         
│           - 0                                                                 
│           - 0.99                                                              
│           t_points: 100                                                       
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_i
│       min_epochs: 1                                                           
│       max_epochs: 50000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 50001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_inverse
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_discrete_inverse                                                
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 1                                                                     
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       - 81                                                                    
│       output_names:                                                           
│       - u                                                                     
│       discrete: true                                                          
│                                                                               
├── q
│   └── 81                                                                      
├── N0
│   └── 199                                                                     
├── N1
│   └── 201                                                                     
├── idx_t0
│   └── 10                                                                      
├── idx_t1
│   └── 90                                                                      
├── discrete
│   └── True                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── runge_kutta
│   └── _target_: pinnstorch.models.RungeKutta                                  
│       root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                   
│       q: 81                                                                   
│       t1: 10                                                                  
│       t2: 90                                                                  
│       time_domain:                                                            
│         _target_: pinnstorch.data.TimeDomain                                  
│         t_interval:                                                           
│         - 0                                                                   
│         - 0.99                                                                
│         t_points: 100                                                         
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_discrete_inverse                
        _partial_: true                                                         
                                                                                
[2023-09-11 06:23:41,530][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-11 06:23:41,530][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-11 06:23:41,530][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-11 06:23:41,530][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 06:23:41,531][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 06:23:41,532][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 06:23:41,534][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 06:23:41,535][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-11 06:23:41,537][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-11 06:23:41,538][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-11 06:23:41,539][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 06:23:41,542][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 06:23:41,544][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 06:23:41,548][pinnstorch.utils.utils][INFO] - Weights are available.
[2023-09-11 06:23:41,552][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 06:23:41,552][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 06:23:41,552][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 06:23:41,552][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 06:23:41,552][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 06:23:41,559][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
torch.Size([256, 1]) torch.Size([256, 1])
Capture Time 0.4248976707458496
=======
[2023-09-11 06:23:41,995][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-11 06:23:41,996][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.42839622497558594
[2023-09-11 06:23:42,039][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.45441389083862305, - MEAN = 0.041310353712602096
`Trainer.fit` stopped: `max_epochs=40000` reached.
[2023-09-11 06:24:47,983][pinnstorch.train][INFO] - Elapsed time: 886.2007598876953
[2023-09-11 06:24:47,987][pinnstorch.train][INFO] - MEAN time: 0.017333984375  -   0.017490744590759277 -  0.019169092178344727
[2023-09-11 06:24:47,987][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │    0.01163414679467678    │
│         val/loss          │   5.108379991725087e-05   │
│       val/loss_best       │   5.108379991725087e-05   │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 06:24:48,004][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
[2023-09-11 06:24:48,086][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_continuous_inverse/outputs/multi_run/06-10-00/0/fig
[2023-09-11 06:24:49,119][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_inverse/outputs/multi_run/06-10-00/0
[2023-09-11 06:24:49,120][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.01163414679467678>
[2023-09-11 06:24:49,120][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=0.9964118003845215>
[2023-09-11 06:24:49,120][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=-5.589064598083496>
[2023-09-11 06:24:49,121][HYDRA] 	#1 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=True model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 06:24:49,256][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 06:24:49,257][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous
│       min_epochs: 1                                                           
│       max_epochs: 40000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 40001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_inver
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_continuous_inverse                                              
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 1                                                                     
│       output_names:                                                           
│       - u                                                                     
│                                                                               
├── N_u
│   └── 2000                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_continuous_inverse              
        _partial_: true                                                         
                                                                                
[2023-09-11 06:24:49,290][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-11 06:24:49,290][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-11 06:24:49,290][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-11 06:24:49,291][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 06:24:49,291][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 06:24:49,292][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 06:24:49,294][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 06:24:49,296][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 06:24:49,299][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 06:24:49,300][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 06:24:49,303][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 06:24:49,307][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 06:24:49,311][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 06:24:49,311][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 06:24:49,311][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 06:24:49,311][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 06:24:49,311][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 06:24:49,322][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Capture Time 0.3687257766723633
=======
[2023-09-11 06:24:49,704][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-11 06:24:49,705][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.3707542419433594
[2023-09-11 06:24:49,745][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.398792028427124, - MEAN = 0.03625382076610218
`Trainer.fit` stopped: `max_epochs=50000` reached.
[2023-09-11 06:26:10,238][pinnstorch.train][INFO] - Elapsed time: 148.67878699302673
[2023-09-11 06:26:10,241][pinnstorch.train][INFO] - MEAN time: 0.002013683319091797  -   0.0020079612731933594 -  0.0020055770874023438
[2023-09-11 06:26:10,241][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
torch.Size([256, 1]) torch.Size([256, 1])
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │   0.007402980700135231    │
│         val/loss          │    1118.7381591796875     │
│       val/loss_best       │    1118.7381591796875     │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 06:26:10,252][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
torch.Size([256, 1]) torch.Size([256, 1])
[2023-09-11 06:26:10,319][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_discrete_inverse/outputs/multi_run/05-59-41/1/fig
[2023-09-11 06:26:10,905][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_inverse/outputs/multi_run/05-59-41/1
[2023-09-11 06:26:10,905][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.007402980700135231>
[2023-09-11 06:26:10,905][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=0.9968864321708679>
[2023-09-11 06:26:10,905][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=-5.506203651428223>
[2023-09-11 06:26:10,906][HYDRA] 	#2 : trainer.devices=[0] callbacks=null logger=null model.amp=True model.cudagraph_compile=False model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 06:26:11,045][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 06:26:11,046][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       runge_kutta:                                                            
│         _target_: pinnstorch.models.RungeKutta                                
│         root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                 
│         q: 81                                                                 
│         t1: 10                                                                
│         t2: 90                                                                
│         time_domain:                                                          
│           _target_: pinnstorch.data.TimeDomain                                
│           t_interval:                                                         
│           - 0                                                                 
│           - 0.99                                                              
│           t_points: 100                                                       
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_i
│       min_epochs: 1                                                           
│       max_epochs: 50000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 50001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_inverse
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_discrete_inverse                                                
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 1                                                                     
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       - 81                                                                    
│       output_names:                                                           
│       - u                                                                     
│       discrete: true                                                          
│                                                                               
├── q
│   └── 81                                                                      
├── N0
│   └── 199                                                                     
├── N1
│   └── 201                                                                     
├── idx_t0
│   └── 10                                                                      
├── idx_t1
│   └── 90                                                                      
├── discrete
│   └── True                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── runge_kutta
│   └── _target_: pinnstorch.models.RungeKutta                                  
│       root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                   
│       q: 81                                                                   
│       t1: 10                                                                  
│       t2: 90                                                                  
│       time_domain:                                                            
│         _target_: pinnstorch.data.TimeDomain                                  
│         t_interval:                                                           
│         - 0                                                                   
│         - 0.99                                                                
│         t_points: 100                                                         
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_discrete_inverse                
        _partial_: true                                                         
                                                                                
[2023-09-11 06:26:11,090][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-11 06:26:11,090][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-11 06:26:11,090][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-11 06:26:11,091][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 06:26:11,092][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 06:26:11,093][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 06:26:11,094][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 06:26:11,096][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-11 06:26:11,098][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-11 06:26:11,099][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-11 06:26:11,100][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 06:26:11,102][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 06:26:11,104][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 06:26:11,109][pinnstorch.utils.utils][INFO] - Weights are available.
[2023-09-11 06:26:11,113][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 06:26:11,113][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 06:26:11,113][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 06:26:11,113][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 06:26:11,113][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 06:26:11,120][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
torch.Size([256, 1]) torch.Size([256, 1])
=======
[2023-09-11 06:26:11,192][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-11 06:26:11,192][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-11 06:26:11,192][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.04021883010864258
[2023-09-11 06:26:11,451][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.26396751403808594, - MEAN = 0.023997046730735085
[2023-09-11 06:26:13,410][pinnstorch.models.pinn_module][INFO] - step 81: 0.024498939514160156
`Trainer.fit` stopped: `max_epochs=40000` reached.
[2023-09-11 06:27:02,793][pinnstorch.train][INFO] - Elapsed time: 133.4702546596527
[2023-09-11 06:27:02,795][pinnstorch.train][INFO] - MEAN time: 0.002412080764770508  -   0.002411484718322754 -  0.0024089813232421875
[2023-09-11 06:27:02,795][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │   0.009168886579573154    │
│         val/loss          │    3.1728337489767e-05    │
│       val/loss_best       │    3.1728337489767e-05    │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 06:27:02,808][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
[2023-09-11 06:27:02,886][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_continuous_inverse/outputs/multi_run/06-10-00/1/fig
[2023-09-11 06:27:03,673][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_inverse/outputs/multi_run/06-10-00/1
[2023-09-11 06:27:03,674][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.009168886579573154>
[2023-09-11 06:27:03,674][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=0.996229350566864>
[2023-09-11 06:27:03,674][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=-5.590958595275879>
[2023-09-11 06:27:03,675][HYDRA] 	#2 : trainer.devices=[0] callbacks=null logger=null model.amp=True model.cudagraph_compile=False model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 06:27:03,812][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 06:27:03,813][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous
│       min_epochs: 1                                                           
│       max_epochs: 40000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 40001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_inver
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_continuous_inverse                                              
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 1                                                                     
│       output_names:                                                           
│       - u                                                                     
│                                                                               
├── N_u
│   └── 2000                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_continuous_inverse              
        _partial_: true                                                         
                                                                                
[2023-09-11 06:27:03,847][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-11 06:27:03,847][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-11 06:27:03,847][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-11 06:27:03,847][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 06:27:03,848][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 06:27:03,849][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 06:27:03,851][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 06:27:03,853][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 06:27:03,856][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 06:27:03,857][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 06:27:03,859][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 06:27:03,862][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 06:27:03,865][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 06:27:03,865][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 06:27:03,865][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 06:27:03,865][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 06:27:03,865][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 06:27:03,874][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
=======
[2023-09-11 06:27:03,943][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-11 06:27:03,944][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-11 06:27:03,944][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.02822566032409668
[2023-09-11 06:27:04,125][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.18592381477355957, - MEAN = 0.016902164979414505
[2023-09-11 06:27:05,891][pinnstorch.models.pinn_module][INFO] - step 81: 0.02263021469116211
`Trainer.fit` stopped: `max_epochs=40000` reached.
[2023-09-11 06:43:52,614][pinnstorch.train][INFO] - Elapsed time: 1008.740133523941
[2023-09-11 06:43:52,618][pinnstorch.train][INFO] - MEAN time: 0.021646499633789062  -   0.022118330001831055 -  0.022045373916625977
[2023-09-11 06:43:52,618][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │   0.012226331979036331    │
│         val/loss          │  5.6416549341520295e-05   │
│       val/loss_best       │  5.6416549341520295e-05   │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 06:43:52,639][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
[2023-09-11 06:43:52,724][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_continuous_inverse/outputs/multi_run/06-10-00/2/fig
[2023-09-11 06:43:53,512][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_inverse/outputs/multi_run/06-10-00/2
[2023-09-11 06:43:53,512][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.012226331979036331>
[2023-09-11 06:43:53,512][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=0.9944867491722107>
[2023-09-11 06:43:53,512][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=-5.565613746643066>
[2023-09-11 06:43:53,513][HYDRA] 	#3 : trainer.devices=[0] callbacks=null logger=null model.amp=True model.cudagraph_compile=True model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 06:43:53,650][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 06:43:53,651][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous
│       min_epochs: 1                                                           
│       max_epochs: 40000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 40001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_inver
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_continuous_inverse                                              
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 1                                                                     
│       output_names:                                                           
│       - u                                                                     
│                                                                               
├── N_u
│   └── 2000                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_continuous_inverse              
        _partial_: true                                                         
                                                                                
[2023-09-11 06:43:53,684][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-11 06:43:53,684][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-11 06:43:53,684][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-11 06:43:53,685][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 06:43:53,685][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 06:43:53,686][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 06:43:53,688][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 06:43:53,690][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 06:43:53,693][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 06:43:53,694][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 06:43:53,696][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 06:43:53,699][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 06:43:53,702][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 06:43:53,702][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 06:43:53,702][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 06:43:53,703][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 06:43:53,703][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 06:43:53,711][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Capture Time 0.3154149055480957
=======
[2023-09-11 06:43:54,038][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-11 06:43:54,038][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-11 06:43:54,038][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.3178675174713135
[2023-09-11 06:43:54,089][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.3560047149658203, - MEAN = 0.032364064996892754
[2023-09-11 06:43:54,363][pinnstorch.models.pinn_module][INFO] - step 81: 0.0032143592834472656
`Trainer.fit` stopped: `max_epochs=40000` reached.
[2023-09-11 06:46:43,814][pinnstorch.train][INFO] - Elapsed time: 170.1033000946045
[2023-09-11 06:46:43,817][pinnstorch.train][INFO] - MEAN time: 0.003277301788330078  -   0.0032935142517089844 -  0.0032968521118164062
[2023-09-11 06:46:43,817][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │    0.0275723934173584     │
│         val/loss          │   0.0002869214804377407   │
│       val/loss_best       │   0.0002869214804377407   │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 06:46:43,830][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
[2023-09-11 06:46:43,907][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_continuous_inverse/outputs/multi_run/06-10-00/3/fig
[2023-09-11 06:46:44,702][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_inverse/outputs/multi_run/06-10-00/3
[2023-09-11 06:46:44,703][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.0275723934173584>
[2023-09-11 06:46:44,703][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=0.9874061942100525>
[2023-09-11 06:46:44,703][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=-5.297755718231201>
`Trainer.fit` stopped: `max_epochs=50000` reached.
[2023-09-11 06:52:29,190][pinnstorch.train][INFO] - Elapsed time: 1578.0700097084045
[2023-09-11 06:52:29,196][pinnstorch.train][INFO] - MEAN time: 0.028817176818847656  -   0.028714537620544434 -  0.028444647789001465
[2023-09-11 06:52:29,196][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
torch.Size([256, 1]) torch.Size([256, 1])
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │   0.007236761040985584    │
│         val/loss          │     1121.371826171875     │
│       val/loss_best       │     1121.371826171875     │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 06:52:29,214][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
torch.Size([256, 1]) torch.Size([256, 1])
[2023-09-11 06:52:29,285][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_discrete_inverse/outputs/multi_run/05-59-41/2/fig
[2023-09-11 06:52:29,858][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_inverse/outputs/multi_run/05-59-41/2
[2023-09-11 06:52:29,858][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.007236761040985584>
[2023-09-11 06:52:29,858][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=0.9970900416374207>
[2023-09-11 06:52:29,858][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=-5.508902549743652>
[2023-09-11 06:52:29,859][HYDRA] 	#3 : trainer.devices=[0] callbacks=null logger=null model.amp=True model.cudagraph_compile=True model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 06:52:29,995][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 06:52:29,996][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: sse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│       runge_kutta:                                                            
│         _target_: pinnstorch.models.RungeKutta                                
│         root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                 
│         q: 81                                                                 
│         t1: 10                                                                
│         t2: 90                                                                
│         time_domain:                                                          
│           _target_: pinnstorch.data.TimeDomain                                
│           t_interval:                                                         
│           - 0                                                                 
│           - 0.99                                                              
│           t_points: 100                                                       
│       extra_variables:                                                        
│         l1: 0.0                                                               
│         l2: -6.0                                                              
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_i
│       min_epochs: 1                                                           
│       max_epochs: 50000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 50001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_inverse
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_discrete_inverse                                                
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 1                                                                     
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       - 50                                                                    
│       - 81                                                                    
│       output_names:                                                           
│       - u                                                                     
│       discrete: true                                                          
│                                                                               
├── q
│   └── 81                                                                      
├── N0
│   └── 199                                                                     
├── N1
│   └── 201                                                                     
├── idx_t0
│   └── 10                                                                      
├── idx_t1
│   └── 90                                                                      
├── discrete
│   └── True                                                                    
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── runge_kutta
│   └── _target_: pinnstorch.models.RungeKutta                                  
│       root_dir: /home/reza/tmp/pinns-torch/data/irk_weights                   
│       q: 81                                                                   
│       t1: 10                                                                  
│       t2: 90                                                                  
│       time_domain:                                                            
│         _target_: pinnstorch.data.TimeDomain                                  
│         t_interval:                                                           
│         - 0                                                                   
│         - 0.99                                                                
│         t_points: 100                                                         
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.DiscreteMeshSampler', '_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│       extra_variables:                                                        
│       - l1                                                                    
│       - l2                                                                    
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_discrete_inverse                
        _partial_: true                                                         
                                                                                
[2023-09-11 06:52:30,039][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-11 06:52:30,039][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-11 06:52:30,039][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-11 06:52:30,039][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 06:52:30,040][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 06:52:30,041][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 06:52:30,043][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 06:52:30,044][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-11 06:52:30,046][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-11 06:52:30,047][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.DiscreteMeshSampler>
[2023-09-11 06:52:30,048][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 06:52:30,050][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 06:52:30,052][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 06:52:30,056][pinnstorch.utils.utils][INFO] - Weights are available.
[2023-09-11 06:52:30,060][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 06:52:30,060][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 06:52:30,060][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 06:52:30,060][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 06:52:30,060][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 06:52:30,067][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
torch.Size([256, 1]) torch.Size([256, 1])
Capture Time 0.4507477283477783
=======
[2023-09-11 06:52:30,528][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-11 06:52:30,528][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-11 06:52:30,528][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.45281386375427246
[2023-09-11 06:52:30,571][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.48388671875, - MEAN = 0.043989701704545456
[2023-09-11 06:52:30,811][pinnstorch.models.pinn_module][INFO] - step 81: 0.0030570030212402344
`Trainer.fit` stopped: `max_epochs=50000` reached.
[2023-09-11 06:55:27,661][pinnstorch.train][INFO] - Elapsed time: 177.59400415420532
[2023-09-11 06:55:27,664][pinnstorch.train][INFO] - MEAN time: 0.0025968551635742188  -   0.002595663070678711 -  0.002594470977783203
[2023-09-11 06:55:27,664][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
torch.Size([256, 1]) torch.Size([256, 1])
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │   0.008271071128547192    │
│         val/loss          │     1123.710693359375     │
│       val/loss_best       │     1123.710693359375     │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 06:55:27,675][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
torch.Size([256, 1]) torch.Size([256, 1])
[2023-09-11 06:55:27,740][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_discrete_inverse/outputs/multi_run/05-59-41/3/fig
[2023-09-11 06:55:28,313][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_discrete_inverse/outputs/multi_run/05-59-41/3
[2023-09-11 06:55:28,313][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.008271071128547192>
[2023-09-11 06:55:28,314][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l1=0.995014488697052>
[2023-09-11 06:55:28,314][pinnstorch.utils.utils][INFO] - Retrieved metric value! <l2=-5.410478115081787>
[2023-09-11 07:35:25,587][HYDRA] Launching 4 jobs locally
[2023-09-11 07:35:25,587][HYDRA] 	#0 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=False model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 07:35:25,719][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 07:35:25,723][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous
│       min_epochs: 1                                                           
│       max_epochs: 30000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 30001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_forwa
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_continuous_forward                                              
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 1                                                                     
│       output_names:                                                           
│       - u                                                                     
│                                                                               
├── N0
│   └── 50                                                                      
├── N_b
│   └── 50                                                                      
├── N_f
│   └── 10000                                                                   
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_continuous_forward              
        _partial_: true                                                         
                                                                                
[2023-09-11 07:35:25,760][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-11 07:35:25,760][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-11 07:35:25,760][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-11 07:35:25,761][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 07:35:25,762][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 07:35:25,763][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 07:35:25,765][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 07:35:25,767][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 07:35:25,771][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.InitialCondition>
[2023-09-11 07:35:25,772][pinnstorch.train][INFO] - Instantiating training dataset number 3: <pinnstorch.data.DirichletBoundaryCondition>
[2023-09-11 07:35:25,773][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 07:35:25,774][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 07:35:25,800][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 07:35:25,936][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 07:35:25,967][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 07:35:25,967][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 07:35:25,967][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 07:35:25,967][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 07:35:25,967][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 07:35:26,017][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:378: UserWarning: You have overridden `transfer_batch_to_device` in `LightningModule` but have passed in a `LightningDataModule`. It will use the implementation from `LightningModule` instance.
  warning_cache.warn(
=======
[2023-09-11 07:35:26,412][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-11 07:35:26,412][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.06305694580078125
[2023-09-11 07:35:26,665][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.29658937454223633, - MEAN = 0.026962670412930576
[2023-09-11 07:35:28,621][pinnstorch.models.pinn_module][INFO] - step 81: 0.025162935256958008
`Trainer.fit` stopped: `max_epochs=30000` reached.
[2023-09-11 07:48:54,930][pinnstorch.train][INFO] - Elapsed time: 808.9137012958527
[2023-09-11 07:48:54,934][pinnstorch.train][INFO] - MEAN time: 0.025070667266845703  -   0.02522408962249756 -  0.02520918846130371
[2023-09-11 07:48:54,934][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │   0.028825173154473305    │
│         val/loss          │   0.0003135869628749788   │
│       val/loss_best       │   0.0003135869628749788   │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 07:48:54,952][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
[2023-09-11 07:48:55,039][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_continuous_forward/outputs/multi_run/07-35-25/0/fig
[2023-09-11 07:48:56,095][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_forward/outputs/multi_run/07-35-25/0
[2023-09-11 07:48:56,095][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.028825173154473305>
[2023-09-11 07:48:56,096][HYDRA] 	#1 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=True model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 07:48:56,230][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 07:48:56,231][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous
│       min_epochs: 1                                                           
│       max_epochs: 30000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 30001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_forwa
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_continuous_forward                                              
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 1                                                                     
│       output_names:                                                           
│       - u                                                                     
│                                                                               
├── N0
│   └── 50                                                                      
├── N_b
│   └── 50                                                                      
├── N_f
│   └── 10000                                                                   
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_continuous_forward              
        _partial_: true                                                         
                                                                                
[2023-09-11 07:48:56,265][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-11 07:48:56,265][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-11 07:48:56,265][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-11 07:48:56,265][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 07:48:56,266][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 07:48:56,267][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 07:48:56,269][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 07:48:56,270][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 07:48:56,273][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.InitialCondition>
[2023-09-11 07:48:56,274][pinnstorch.train][INFO] - Instantiating training dataset number 3: <pinnstorch.data.DirichletBoundaryCondition>
[2023-09-11 07:48:56,275][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 07:48:56,276][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 07:48:56,279][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 07:48:56,282][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 07:48:56,284][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 07:48:56,284][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 07:48:56,284][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 07:48:56,284][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 07:48:56,284][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 07:48:56,293][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Capture Time 0.30922460556030273
=======
[2023-09-11 07:48:56,615][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-11 07:48:56,615][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.31268763542175293
[2023-09-11 07:48:56,665][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.35547351837158203, - MEAN = 0.03231577439741655
`Trainer.fit` stopped: `max_epochs=30000` reached.
[2023-09-11 07:51:00,306][pinnstorch.train][INFO] - Elapsed time: 124.01269268989563
[2023-09-11 07:51:00,307][pinnstorch.train][INFO] - MEAN time: 0.0036993026733398438  -   0.0036842823028564453 -  0.0036783218383789062
[2023-09-11 07:51:00,307][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │    0.06626643985509872    │
│         val/loss          │   0.0016573010943830013   │
│       val/loss_best       │   0.0016573010943830013   │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 07:51:00,320][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
[2023-09-11 07:51:00,397][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_continuous_forward/outputs/multi_run/07-35-25/1/fig
[2023-09-11 07:51:01,197][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_forward/outputs/multi_run/07-35-25/1
[2023-09-11 07:51:01,198][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.06626643985509872>
[2023-09-11 07:51:01,198][HYDRA] 	#2 : trainer.devices=[0] callbacks=null logger=null model.amp=True model.cudagraph_compile=False model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 07:51:01,333][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 07:51:01,335][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous
│       min_epochs: 1                                                           
│       max_epochs: 30000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 30001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_forwa
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_continuous_forward                                              
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 1                                                                     
│       output_names:                                                           
│       - u                                                                     
│                                                                               
├── N0
│   └── 50                                                                      
├── N_b
│   └── 50                                                                      
├── N_f
│   └── 10000                                                                   
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_continuous_forward              
        _partial_: true                                                         
                                                                                
[2023-09-11 07:51:01,368][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-11 07:51:01,368][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-11 07:51:01,368][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-11 07:51:01,369][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 07:51:01,370][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 07:51:01,370][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 07:51:01,372][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 07:51:01,374][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 07:51:01,377][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.InitialCondition>
[2023-09-11 07:51:01,378][pinnstorch.train][INFO] - Instantiating training dataset number 3: <pinnstorch.data.DirichletBoundaryCondition>
[2023-09-11 07:51:01,379][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 07:51:01,380][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 07:51:01,383][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 07:51:01,385][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 07:51:01,388][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 07:51:01,388][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 07:51:01,388][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 07:51:01,388][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 07:51:01,388][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 07:51:01,397][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
=======
[2023-09-11 07:51:01,462][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-11 07:51:01,462][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-11 07:51:01,462][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.023674964904785156
[2023-09-11 07:51:01,644][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.19211220741271973, - MEAN = 0.017464746128429066
[2023-09-11 07:51:03,775][pinnstorch.models.pinn_module][INFO] - step 81: 0.02834010124206543
`Trainer.fit` stopped: `max_epochs=30000` reached.
[2023-09-11 08:06:13,489][pinnstorch.train][INFO] - Elapsed time: 912.0925600528717
[2023-09-11 08:06:13,493][pinnstorch.train][INFO] - MEAN time: 0.02828359603881836  -   0.02831852436065674 -  0.028291702270507812
[2023-09-11 08:06:13,493][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │    0.0250527523458004     │
│         val/loss          │  0.00023687814245931804   │
│       val/loss_best       │  0.00023687814245931804   │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 08:06:13,513][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
[2023-09-11 08:06:13,596][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_continuous_forward/outputs/multi_run/07-35-25/2/fig
[2023-09-11 08:06:14,405][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_forward/outputs/multi_run/07-35-25/2
[2023-09-11 08:06:14,406][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.0250527523458004>
[2023-09-11 08:06:14,407][HYDRA] 	#3 : trainer.devices=[0] callbacks=null logger=null model.amp=True model.cudagraph_compile=True model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 08:06:14,541][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 08:06:14,542][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: true                                                               
│       cudagraph_compile: true                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous
│       min_epochs: 1                                                           
│       max_epochs: 30000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 30001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_forwa
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_continuous_forward                                              
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 1                                                                     
│       output_names:                                                           
│       - u                                                                     
│                                                                               
├── N0
│   └── 50                                                                      
├── N_b
│   └── 50                                                                      
├── N_f
│   └── 10000                                                                   
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_continuous_forward              
        _partial_: true                                                         
                                                                                
[2023-09-11 08:06:14,575][pinnstorch.utils.utils][INFO] - Model will be compiled.
[2023-09-11 08:06:14,575][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to True.
[2023-09-11 08:06:14,575][pinnstorch.utils.utils][INFO] - Disabling automatic optimization.
Global seed set to 1234
[2023-09-11 08:06:14,575][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 08:06:14,576][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 08:06:14,577][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 08:06:14,578][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 08:06:14,580][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 08:06:14,583][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.InitialCondition>
[2023-09-11 08:06:14,584][pinnstorch.train][INFO] - Instantiating training dataset number 3: <pinnstorch.data.DirichletBoundaryCondition>
[2023-09-11 08:06:14,585][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 08:06:14,586][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 08:06:14,589][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 08:06:14,591][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 08:06:14,594][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 08:06:14,594][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 08:06:14,594][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 08:06:14,594][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 08:06:14,594][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 08:06:14,603][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Capture Time 0.3667314052581787
=======
[2023-09-11 08:06:14,982][pinnstorch.models.pinn_module][INFO] - CUDAGraph
[2023-09-11 08:06:14,982][pinnstorch.models.pinn_module][INFO] - AMP
[2023-09-11 08:06:14,982][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.3689243793487549
[2023-09-11 08:06:15,033][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.4142913818359375, - MEAN = 0.03766285289417614
[2023-09-11 08:06:15,313][pinnstorch.models.pinn_module][INFO] - step 81: 0.003853321075439453
`Trainer.fit` stopped: `max_epochs=30000` reached.
[2023-09-11 08:08:25,841][pinnstorch.train][INFO] - Elapsed time: 131.23774337768555
[2023-09-11 08:08:25,843][pinnstorch.train][INFO] - MEAN time: 0.003894805908203125  -   0.003873467445373535 -  0.003895282745361328
[2023-09-11 08:08:25,843][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │    0.2520139813423157     │
│         val/loss          │    0.02396974340081215    │
│       val/loss_best       │    0.02396974340081215    │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 08:08:25,855][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
[2023-09-11 08:08:25,931][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_continuous_forward/outputs/multi_run/07-35-25/3/fig
[2023-09-11 08:08:26,731][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_forward/outputs/multi_run/07-35-25/3
[2023-09-11 08:08:26,731][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.2520139813423157>
