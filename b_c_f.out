nohup: ignoring input
[2023-09-11 05:21:58,870][HYDRA] Launching 4 jobs locally
[2023-09-11 05:21:58,871][HYDRA] 	#0 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=False model.jit_compile=False trainer.enable_progress_bar=False
[2023-09-11 05:21:59,003][pinnstorch.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-09-11 05:21:59,007][pinnstorch.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: pinnstorch.data.PINNDataModule                                
│                                                                               
├── model
│   └── _target_: pinnstorch.models.PINNModule                                  
│       _partial_: true                                                         
│       loss_fn: mse                                                            
│       jit_compile: false                                                      
│       amp: false                                                              
│       cudagraph_compile: false                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│         capturable: true                                                      
│       scaler:                                                                 
│         _target_: torch.cuda.amp.GradScaler                                   
│                                                                               
├── callbacks
│   └── None                                                                    
├── logger
│   └── None                                                                    
├── trainer
│   └── _target_: lightning.pytorch.trainer.Trainer                             
│       default_root_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous
│       min_epochs: 1                                                           
│       max_epochs: 10000                                                       
│       accelerator: gpu                                                        
│       devices:                                                                
│       - 0                                                                     
│       enable_model_summary: false                                             
│       enable_progress_bar: false                                              
│       check_val_every_n_epoch: 10001                                          
│       inference_mode: false                                                   
│       log_every_n_steps: 1                                                    
│       deterministic: false                                                    
│                                                                               
├── paths
│   └── root_dir: /home/reza/tmp/pinns-torch                                    
│       data_dir: /home/reza/tmp/pinns-torch/data/                              
│       rk_dir: /home/reza/tmp/pinns-torch/data/irk_weights                     
│       log_dir: /home/reza/tmp/pinns-torch/logs/                               
│       output_dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_forwa
│       work_dir: /home/reza/tmp/pinns-torch                                    
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── burgers_continuous_forward                                              
├── tags
│   └── ['dev']                                                                 
├── train
│   └── True                                                                    
├── test
│   └── False                                                                   
├── ckpt_path
│   └── None                                                                    
├── seed
│   └── 1234                                                                    
├── net
│   └── _target_: pinnstorch.models.FCN                                         
│       _partial_: true                                                         
│       layers:                                                                 
│       - 2                                                                     
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 20                                                                    
│       - 1                                                                     
│       output_names:                                                           
│       - u                                                                     
│                                                                               
├── N0
│   └── 50                                                                      
├── N_b
│   └── 50                                                                      
├── N_f
│   └── 10000                                                                   
├── time_domain
│   └── _target_: pinnstorch.data.TimeDomain                                    
│       t_interval:                                                             
│       - 0                                                                     
│       - 0.99                                                                  
│       t_points: 100                                                           
│                                                                               
├── spatial_domain
│   └── _target_: pinnstorch.data.Interval                                      
│       x_interval:                                                             
│       - -1                                                                    
│       - 1                                                                     
│       shape:                                                                  
│       - 256                                                                   
│       - 1                                                                     
│                                                                               
├── mesh
│   └── _target_: pinnstorch.data.Mesh                                          
│       root_dir: /home/reza/tmp/pinns-torch/data/                              
│       read_data_fn: ???                                                       
│                                                                               
├── train_datasets
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val_dataset
│   └── [{'mesh_sampler': {'_target_': 'pinnstorch.data.MeshSampler', '_partial_
├── val
│   └── True                                                                    
├── optimized_metric
│   └── error:                                                                  
│       - u                                                                     
│                                                                               
└── plotting
    └── _target_: pinnstorch.utils.plot_burgers_continuous_forward              
        _partial_: true                                                         
                                                                                
[2023-09-11 05:21:59,045][pinnstorch.utils.utils][INFO] - Model will not be compiled.
[2023-09-11 05:21:59,045][pinnstorch.utils.utils][INFO] - Setting optimizer capturable attribute to False.
[2023-09-11 05:21:59,045][pinnstorch.utils.utils][INFO] - Enabling automatic optimization.
Global seed set to 1234
[2023-09-11 05:21:59,046][pinnstorch.train][INFO] - Instantiating time domain <pinnstorch.data.TimeDomain>
[2023-09-11 05:21:59,046][pinnstorch.train][INFO] - Instantiating spatial domain <pinnstorch.data.Interval>
[2023-09-11 05:21:59,047][pinnstorch.train][INFO] - Instantiating mesh <pinnstorch.data.Mesh>
[2023-09-11 05:21:59,049][pinnstorch.utils.utils][INFO] - Data is available.
[2023-09-11 05:21:59,051][pinnstorch.train][INFO] - Instantiating training dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:21:59,055][pinnstorch.train][INFO] - Instantiating training dataset number 2: <pinnstorch.data.InitialCondition>
[2023-09-11 05:21:59,056][pinnstorch.train][INFO] - Instantiating training dataset number 3: <pinnstorch.data.DirichletBoundaryCondition>
[2023-09-11 05:21:59,057][pinnstorch.train][INFO] - Instantiating validation dataset number 1: <pinnstorch.data.MeshSampler>
[2023-09-11 05:21:59,059][pinnstorch.train][INFO] - Instantiating datamodule <pinnstorch.data.PINNDataModule>
[2023-09-11 05:21:59,063][pinnstorch.train][INFO] - Instantiating neural net <pinnstorch.models.FCN>
[2023-09-11 05:21:59,186][pinnstorch.train][INFO] - Instantiating model <pinnstorch.models.PINNModule>
[2023-09-11 05:21:59,216][pinnstorch.train][INFO] - Instantiating callbacks...
[2023-09-11 05:21:59,216][pinnstorch.utils.instantiators][WARNING] - No callback configs found! Skipping..
[2023-09-11 05:21:59,216][pinnstorch.train][INFO] - Instantiating loggers...
[2023-09-11 05:21:59,216][pinnstorch.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2023-09-11 05:21:59,216][pinnstorch.train][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2023-09-11 05:21:59,268][pinnstorch.train][INFO] - Starting training!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:378: UserWarning: You have overridden `transfer_batch_to_device` in `LightningModule` but have passed in a `LightningDataModule`. It will use the implementation from `LightningModule` instance.
  warning_cache.warn(
=======
[2023-09-11 05:21:59,522][pinnstorch.models.pinn_module][INFO] - Auto
[2023-09-11 05:21:59,522][pinnstorch.models.pinn_module][INFO] - epoch 0: 0.06296563148498535
[2023-09-11 05:21:59,743][pinnstorch.models.pinn_module][INFO] - Compile Time - SUM = 0.2653183937072754, - MEAN = 0.024119853973388672
[2023-09-11 05:22:01,704][pinnstorch.models.pinn_module][INFO] - step 81: 0.026373624801635742
/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py:53: UserWarning: Detected KeyboardInterrupt, attempting graceful shutdown...
  rank_zero_warn("Detected KeyboardInterrupt, attempting graceful shutdown...")
[2023-09-11 05:22:46,028][pinnstorch.train][INFO] - Elapsed time: 46.75961112976074
[2023-09-11 05:22:46,029][pinnstorch.train][INFO] - MEAN time: 0.024953126907348633  -   0.024973034858703613 -  0.025098800659179688
[2023-09-11 05:22:46,029][pinnstorch.train][INFO] - Starting validation!
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃      Validate metric      ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│        val/error_u        │    0.15823976695537567    │
│         val/loss          │   0.009450295008718967    │
│       val/loss_best       │   0.009450295008718967    │
└───────────────────────────┴───────────────────────────┘
[2023-09-11 05:22:46,059][pinnstorch.train][INFO] - Plotting the results
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[2023-09-11 05:22:46,147][pinnstorch.utils.plotting][INFO] - Image saved at /home/reza/tmp/pinns-torch/examples/burgers_continuous_forward/outputs/multi_run/05-21-58/0/fig
[2023-09-11 05:22:47,210][pinnstorch.utils.utils][INFO] - Output dir: /home/reza/tmp/pinns-torch/examples/burgers_continuous_forward/outputs/multi_run/05-21-58/0
[2023-09-11 05:22:47,210][pinnstorch.utils.utils][INFO] - Retrieved metric value! <val/error_u=0.15823976695537567>
[2023-09-11 05:22:47,211][HYDRA] 	#1 : trainer.devices=[0] callbacks=null logger=null model.amp=False model.cudagraph_compile=True model.jit_compile=False trainer.enable_progress_bar=False
Traceback (most recent call last):
  File "/home/reza/tmp/pinns-torch/examples/burgers_continuous_forward/train.py", line 62, in <module>
    main()
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/utils.py", line 465, in _run_app
    run_and_report(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/utils.py", line 466, in <lambda>
    lambda: hydra.multirun(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/hydra.py", line 162, in multirun
    ret = sweeper.sweep(arguments=task_overrides)
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/core_plugins/basic_sweeper.py", line 177, in sweep
    results = self.launcher.launch(batch, initial_job_idx=initial_job_idx)
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/core_plugins/basic_launcher.py", line 68, in launch
    sweep_config = self.hydra_context.config_loader.load_sweep_config(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/config_loader_impl.py", line 319, in load_sweep_config
    sweep_config = self.load_configuration(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/config_loader_impl.py", line 142, in load_configuration
    return self._load_configuration_impl(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/config_loader_impl.py", line 253, in _load_configuration_impl
    defaults_list = create_defaults_list(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/defaults_list.py", line 745, in create_defaults_list
    defaults, tree = _create_defaults_list(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/defaults_list.py", line 715, in _create_defaults_list
    defaults_tree = _create_defaults_tree(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/defaults_list.py", line 356, in _create_defaults_tree
    ret = _create_defaults_tree_impl(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/defaults_list.py", line 457, in _create_defaults_tree_impl
    return _expand_virtual_root(repo, root, overrides, skip_missing)
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/defaults_list.py", line 280, in _expand_virtual_root
    subtree = _create_defaults_tree_impl(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/defaults_list.py", line 573, in _create_defaults_tree_impl
    add_child(children, new_root)
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/defaults_list.py", line 520, in add_child
    subtree_ = _create_defaults_tree_impl(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/defaults_list.py", line 573, in _create_defaults_tree_impl
    add_child(children, new_root)
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/defaults_list.py", line 520, in add_child
    subtree_ = _create_defaults_tree_impl(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/defaults_list.py", line 466, in _create_defaults_tree_impl
    update_package_header(repo=repo, node=parent)
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/defaults_list.py", line 262, in update_package_header
    loaded = repo.load_config(config_path=node.get_config_path())
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/config_repository.py", line 348, in load_config
    ret = self.delegate.load_config(config_path=config_path)
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/config_repository.py", line 91, in load_config
    ret = source.load_config(config_path=config_path)
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/hydra/_internal/core_plugins/file_config_source.py", line 31, in load_config
    cfg = OmegaConf.load(f)
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/omegaconf/omegaconf.py", line 192, in load
    obj = yaml.load(file_, Loader=get_yaml_loader())
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/site-packages/omegaconf/_utils.py", line 156, in get_yaml_loader
    re.compile(
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/re.py", line 252, in compile
    return _compile(pattern, flags)
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/re.py", line 292, in _compile
    flags = flags.value
  File "/home/reza/miniconda3/envs/torch2stable/lib/python3.9/types.py", line 171, in __get__
    def __get__(self, instance, ownerclass=None):
KeyboardInterrupt
